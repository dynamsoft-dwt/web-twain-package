/*! Date: 01/06/2021 10:21:18 */!function(i){var n={};function s(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,s),e.l=!0,e.exports}s.m=i,s.c=n,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=50)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.pointToPointDistance=e.parsePadding=e.throttle1=e.promiseWidthAbort=e.makePromiseCancelable=e.formatLog=e.formatTime=e.devicePixelRatio=e.requestAnimationFrame=e.checkFocus=e.deepClone=e.deepCopy=e.createCanvas=e.uid=e.error=e.throwError=e.insertBefore=e.insertAfter=e.getByClass=e.getIndexByCallback=e.getIndex=e.exitFullscreen=e.launchFullscreen=e.isFullscreen=e.toggleDisplayByQuery=e.toggleDisplayByDom=e.toggleHidden=e.animation=e.showByDom=e.hiddenByDom=e.hiddenByQuery=e.id=e.preventDefault=e.stopBubble=e.arrayFrom=e.queryAll=e.query=e.throttleStable=e.stable=e.throttle=e.mergeJSON=e.addEvent=e.isElement=e.isIE=e.isMobile=e.isBorder=e.isColor=e.isBoolean=e.isNumber=e.isSize=e.isString=e.isFunction=e.isObject=e.uniqueArray=e.isArray=void 0;var n="WebViewer_Error: ";function a(t){return"function"==typeof t}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},e.uniqueArray=function(t){if(Array.isArray(t)){for(var e=0;e<t.length;e++)for(var i=e+1;i<t.length;i++)t[e]===t[i]&&(t.splice(i,1),i--);return t}},e.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},e.isFunction=a,e.isString=function(t){return"string"==typeof t},e.isSize=function(t){var e=String(t);return!!/^\d+(px|em)$|^\d+$|^(100|[1-9]?\d(\.\d\d?\d?)?)%$/.test(e)},e.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},e.isBoolean=function(t){return"[object Boolean]"===Object.prototype.toString.call(t)},e.isColor=function(t){var e=document.createElement("span");return e.style.background=t,!!e.style.background},e.isBorder=function(t){var e=document.createElement("span");return e.style.border=t,!(!e.style.border&&""!==t)},e.isMobile=function(){return"ontouchstart"in document.documentElement},e.isIE=function(){return void 0!==document.documentMode},e.isElement=function(t){return t instanceof HTMLElement||"[object ShadowRoot]"===Object.prototype.toString.call(t)},e.addEvent=function(t,e,i,n){if(t)return t.addEventListener(e,i,n),function(){t.removeEventListener(e,i)}},e.mergeJSON=function(t,e){for(var i in t)void 0!==e[i]&&this.isObject(t[i])?this.mergeJSON(t[i],e[i]):e[i]=t[i]},e.throttle=function(e,i,n){var s=!0;return function(){var t=this;s&&(s=!1,setTimeout(function(){e.apply(t,n),s=!0},i))}},e.stable=function(t,e,i){var n,s=this;return void 0===i&&(i=!1),function(){i?t.apply(s):(n&&clearTimeout(n),n=setTimeout(function(){t.apply(s)},e))}},e.throttleStable=function(e,i){var n=this,s=0,o=null;return function(){var t=+new Date;t-s<i?(clearTimeout(o),o=setTimeout(function(){s=t,e.apply(n)},i)):(s=t,e.apply(n))}},e.query=function(t){return document.querySelector(t)},e.queryAll=function(t){return Array.from?Array.from(document.querySelectorAll(t)):this.arrayFrom(document.querySelectorAll(t))},e.arrayFrom=function(t){var e=[];if(this.isObject(t))for(var i=Object.keys(t),n=0;n<i.length;n++)e.push(t[i[n]]);else for(var s=0;s<t.length;s++)e.push(t[s]);return e},e.stopBubble=function(t){t&&t.stopPropagation?t.stopPropagation():t&&(t.cancelBubble=!0)},e.preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},e.id=function(t){return""===t||void 0===t?null:document.getElementById(t)},e.hiddenByQuery=function(t){var e=this.query(t);this.hiddenByDom(e)},e.hiddenByDom=function(t){null!=t&&t.classList.add("dvs-nodisplay")},e.showByDom=function(t){null!=t&&t.classList.remove("dvs-nodisplay")},e.animation=function(t,e,i,n,s){if(void 0===n&&(n=200),void 0===s&&(s=13),!this.isString(e)||!this.isNumber(i))return!1;var o=!1;this.isString(t[e])&&-1!==t[e].indexOf("px")&&(o=!0);var r,a,l=parseInt(t[e]);this.isNumber(l)&&(r=(i-l)/s,a=setInterval(function(){0<r&&l<i||r<0&&i<l?l+=r:(clearInterval(a),l=i),t[e]=o?l+"px":l},n/s))},e.toggleHidden=function(t){t.classList.toggle("dvs-hidden")},e.toggleDisplayByDom=function(t){t.classList.toggle("dvs-nodisplay")},e.toggleDisplayByQuery=function(t,e){void 0===e&&(e=!0);var i=this.query(t);return this.toggleDisplayByDom(i,e)},e.isFullscreen=function(){var t=window.document;return t.fullscreenElement||t.msFullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||!1},e.launchFullscreen=function(t){return t.requestFullscreen?(t.requestFullscreen(),!0):t.mozRequestFullScreen?(t.mozRequestFullScreen(),!0):t.msRequestFullscreen?(t.msRequestFullscreen(),!0):t.oRequestFullscreen?(t.oRequestFullscreen(),!0):t.webkitRequestFullscreen?(t.webkitRequestFullScreen(),!0):(alert("Your browser does not support full screen!"),!1)},e.exitFullscreen=function(){var t=window.document;return t.exitFullScreen?(t.exitFullScreen(),!0):t.mozCancelFullScreen?(t.mozCancelFullScreen(),!0):t.webkitExitFullscreen?(t.webkitExitFullscreen(),!0):t.msExitFullscreen?(t.msExitFullscreen(),!0):void 0},e.getIndex=function(t){for(var e=t.parentNode.children,i=0;i<e.length;i++)if(e[i]===t)return i},e.getIndexByCallback=function(t,e){for(var i=t.parentNode,n=i.children,s=0,o=0;o<n.length;o++){var r=n[o];if(a(e)){if(!e(r,i))continue;if(r===t)return s;s++}else if(r===t)return o}return-1},e.getByClass=function(t){return document.getElementsByClassName(t)},e.insertAfter=function(t,e){var i=e.parentNode;i.lastChild==e?i.appendChild(t):this.insertBefore(t,e.nextSibling,i)},e.insertBefore=function(t,e,i){void 0===e?i.appendChild(t):i.insertBefore(t,e)},e.throwError=function(t){throw new Error(n+"ErrorCode: "+t.errorCode+" ErrorString: "+t.message)},e.error=function(t){},e.uid=function(t){var e=Math.random().toString(35).substr(2);return e.length<11&&(e+=Math.random().toString(35).substr(2)),t=Math.max(Math.min(Math.round(t),11),8),e=e.substr(0,t)},e.createCanvas=function(){var t=document.createElement("canvas"),e=t.getContext("2d");return{canvas:t,context:e}},e.deepCopy=function(t){var e=Array.isArray(t)?[]:{};for(var i in t)"object"==typeof t[i]?e[i]=this.deepCopy(t[i]):e[i]=t[i];return e},e.deepClone=function(t){var e;if(this.isArray(t))e=[];else{if(!this.isObject(t))return t;e={}}for(var i in t){var n=t[i];this.isArray(t)||this.isObject(t)?e[i]=this.deepClone(n):e[i]=n}return e},e.checkFocus=function(){var t=document.activeElement;return"INPUT"===t.tagName&&"text"===t.type},e.requestAnimationFrame=function(t){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame,i=!!e;if(e&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(e.toString())&&(i=!1),i)return e(t);var n={},s=null,o=+new Date;return n[1]=t,null===s&&(s=setInterval(function(){var t=+new Date,e=n;for(var i in n={},e)Object.prototype.hasOwnProperty.call(e,i)&&(e[i](t),o=t);2500<t-o&&(clearInterval(s),s=null)},1e3/60)),1},e.devicePixelRatio=function(){var t=window;return t?t.devicePixelRatio?t.devicePixelRatio:t.screen.deviceXDPI&&t.screen.logicalXDPI?t.screen.deviceXDPI/t.screen.logicalXDPI:1:1},e.formatTime=function(t){var e=new Date,i={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length)));return t},e.formatLog=function(t,e,i){var n="";return 1===arguments.length&&(n+=t),2!==arguments.length&&3!==arguments.length||(n+="execute "+t,n+=e?" successful":" failed",3===arguments.length&&(n+=": "+i)),n},e.makePromiseCancelable=function(t){var n=!1;return{promise:new Promise(function(e,i){t.then(function(t){n?i({isCanceled:!0}):e(t)}),t.catch(function(t){i(n?{isCanceled:!0}:t)})}),cancel:function(){n=!0}}},e.promiseWidthAbort=function(t){var i=null,e=new Promise(function(t,e){i=function(t){void 0===t&&(t="abort"),e(t)}}),n=Promise.race([t,e]);return n.abort=i,n},e.throttle1=function(i,n){var s,o,r,a=0;return function(){var t=+new Date,e=n-(t-a);o=this,r=arguments,e<=0||n<e?(s&&(clearTimeout(s),s=null),a=t,i.apply(o,r)):s=s||setTimeout(function(){i.apply(o,r),s=null,a=+new Date},e)}},e.parsePadding=function(t){var e=(t=t.replace(/^\s*|\s*$/g,"")).split(/\s*/).map(function(t){return Number(t)}),i=0,n=0,s=0,o=0;switch(e.length){case 1:i=e[0],n=e[0],s=e[0],o=e[0];break;case 2:i=e[0],n=e[1],s=e[0],o=e[1];break;case 3:i=e[0],n=e[1],s=e[2],o=e[1];break;case 4:i=e[0],n=e[1],s=e[2],o=e[3];break;default:o=s=n=i=0}return{top:i,right:n,bottom:s,left:o}},e.pointToPointDistance=function(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.operationMode=e.shapeType=e.dashType=e.lineType=e.errorMessages=e.modelEvent=e.uiEvent=e.privateEvent=e.viewerEvent=e.originEvent=e.keyCodes=void 0;var n="undefined"!=typeof window,s=n?window:{};n&&0 in window.document.documentElement,n&&0 in s;e.keyCodes={SHIFT:16,CTRL:17,BACKSPACE:8,DEL:46,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,Y:89,Z:90},e.originEvent={CLICK:"click",KEYDOWN:"keydown",TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_UP:"mouseup",MOUSE_OVER:"mouseover",MOUSE_OUT:"mouseout",CHANGE:"change",SCROLL:"scroll",CONTEXTMENU:"contextmenu",RESIZE:"resize"},e.viewerEvent={IMAGE_SELECTED:"imageSelected",PAGE_CLICK:"click",PAGE_MOUSE_DOWN:"mousedown",PAGE_MOUSE_MOVE:"mousemove",PAGE_MOUSE_UP:"mouseup",PAGE_MOUSE_OVER:"mouseover",PAGE_MOUSE_OUT:"mouseout",PAGE_DOUBLE_CLICK:"dblclick",PAGE_RIGHT_CLICK:"rightclick",PAGE_CONTEXTMENU:"contextmenu",DRAG_START:"dragstart",DRAG_MOVE:"dragmove",DRAG_DONE:"dragdone",KEY_DOWN:"keydown",KEY_UP:"keyup",RESIZE:"resize",TOP_PAGE_CHANGED:"topPageChanged",BUFFER_CHANGED:"bufferChanged",THUMBNAIL_STRETCH:"resize",REMOVE_PAGE:"removePage",FILE_KEY_UP:"fileKeyUp",FILE_LIST_CLICK:"fileListClick",FILE_LIST_RIGHT_CLICK:"fileListRightClick",TAG_KEY_UP:"tagKeyUp",TAG_LIST_CLICK:"tagListClick",TAG_LIST_RIGHT_CLICK:"tagListRightClick",PAGE_AREA_SELECTED:"pageAreaSelected",PAGE_AREA_UNSELECTED:"pageAreaUnselected",VIEWER_PAGE_RENDERED:"pageRendered",DOCUMENT_KEY_UP:"onDocumentKeyUp",DOCUMENT_POINTER_UP:"onDocumentPointerUp",DOCUMENT_POINTER_MOVE:"onDocumentPointerMove",DOCUMENT_CLICK:"onDocumentClick",SIDEBAR_CLICK:"onSidebarClick",FILE_DROP:"onDrop"},e.privateEvent={APPEND_SYNC_DROP:"_appendSyncDrop",UPDATE_UI_SETTING:"_updateUISetting",UPDATE_FOCUS:"_updateFocus",CANVAS_VISIBILITY_CHANGED:"_canvasVisibilityChanged",SET_SELECTED_INDEXES:"_SetSelectedIndexes",DOCUMENT_UP:"_documentUp",DOCUMENT_MOVE:"_documentMove",DISPLAYED_IMAGE_CHANGED:"_displayedImageChanged",REORDER_THUMBNAIL:"_onReOrderThumbnail",CHANGE_THUMBNAIL_VIEW_PROP:"_changeThumbnailViewProp",UPDATE_INNER_THUMBNAIL_PAGE:"_updateInnerThumbnailPage",UPDATE_ERROR_MESSAGE:"_updateErrorMessage",UPDATE_LOG_MESSAGE:"_updateLogMessage",DIRECTORY_CHANGED:"_DirectoryChanged",BIND_SLIDE_COMPONENT:"_bindSlideComponent",UNBIND_SLIDE_COMPONENT:"_unbindSlideComponent",BIND_CANVAS:"_bindCanvas",UNBIND_CANVAS:"_unbindCanvas",SET_CANVAS_SIZE:"_setCanvasSize",CANVAS_TOUCH_START:"_canvasTouchstart",CANVAS_TOUCH_MOVE:"_canvasTouchmove",CANVAS_TOUCH_END:"_canvasTouchend",CANVAS_MOUSE_DOWN:"_canvasMousedown",CANVAS_MOUSE_UP:"_canvasMouseup",CANVAS_MOUSE_MOVE:"_canvasMousemove",CANVAS_MOUSE_OVER:"_canvasMouseOver",CANVAS_MOUSE_OUT:"_canvasMouseOut",CANVAS_WHEEL:"_canvasWheel",CANVAS_SCROLL:"_canvasScroll",CANVAS_CLICK:"_canvasClick",CANVAS_DOUBLE_CLICK:"_canvasDoubleClick",CANVAS_RIGHT_CLICK:"_canvasRightClick",CANVAS_KEY_DOWN:"_canvasKeyDown",CANVAS_KEY_UP:"_canvasKeyUp",CANVAS_RESIZE:"_canvasResize",CANVAS_DRAG_START:"_canvasDragStart",CANVAS_DRAG_MOVE:"_canvasDragMove",CANVAS_DRAG_DONE:"_canvasDragDone",CANVAS_DEFAULT_CURSOR:"_canvasDefaultCursor",SHOW_CANVAS_LOADING:"_showCanvasLoading",ADD_DATA_TO_DB_SUCCESS:"_addDataToDBSuccess",ADD_DATA_TO_DB_FAILED:"_addDataToDBFailed"},e.uiEvent={VIEWER_RESIZE:"_viewerResizeUI",VIEWER_CLICK:"_mouseClickUI",VIEWER_RIGHT_CLICK:"_viewerRightClickUI",VIEWER_MOVE:"_mouseMoveUI",FILE_DROP:"_fileDropUI",SHOW_LATEST_PAGE:"_showLatestPage",UPDATE_PAGES_LAYOUT:"_updatePagesLayout",DOCUMENT_POINTER_MOVE:"_documentPointerMoveUI",DOCUMENT_POINTER_UP:"_documentPointerUpUI",DOCUMENT_KEY_DOWN:"_documentKeyDownUI",DOCUMENT_KEY_UP:"_documentKeyUpUI",DOCUMENT_CLICK:"_documentClickUI",SIDEBAR_CLICK:"_sideBarClickUI",SIDEBAR_STRETCH_START:"_sidebarStretchStartUI",FILE_LIST_CLICK:"_fileListClickUI",FILE_LIST_RIGHT_CLICK:"_fileListRightClickUI",FILE_KEY_UP:"_fileListKeyUpUI",ADD_NEW_FOLDER:"_addNewFolderUI",FILE_REFRESH:"_directoryRefreshUI",FILE_SELECTED:"_fileSelectedUI",TAG_LIST_CLICK:"_tagListClickUI",TAG_LIST_RIGHT_CLICK:"tagListRightClickUI",TAG_KEY_UP:"_tagKeyUpUI",ADD_NEW_TAG:"_addNewTagUI",TAG_REFRESH:"_tagRefreshUI",TAG_SELECTED:"_tagSelectedUI",OPEN_DEFAULT_TAG:"_openDefaultTagUI",IMAGE_SELECTED:"_imageSelectedUI",THUMBNAIL_CHANGED:"_thumbnailChangedUI",UPDATE_THUMBNAIL_PROP:"_updateThumbnailPropUI",SCROLL_TO:"_scrollToUI",SET_VIEW_MODE:"_setViewModeUI",PAGER_BLUR:"_pagerBlurUI",PAGER_CHANGED:"_pagerChangedUI",SET_SCROLLER_SIZE:"_setScrollerSizeUI",CHANGE_CANVAS_CURSOR:"_changeCanvasCursorUI",TAB_CHANGED:"_tabChangedUI",TAB_LIST_CLICK:"_tabListClickUI",CLOSE_SAVE_SETTING_BOX:"_closeSaveSettingBoxUI",CUSTOM_BUTTON_CLICK:"_customButtonClickUI"},e.modelEvent={APPEND_FOR_VIEWER:"_appendForViewer",INSERT_FOR_VIEWER:"_insertForViewer",UPDATE_FOR_VIEWER:"_updateForViewer",REMOVE_SYNC:"_removeSync",REMOVE_ALL_SYNC:"_removeAllSync",SET_CURRENT_INDEX:"_setCurrentIndex",MOVE_PAGE:"_movePage",SWITCH_PAGE:"_switchPage",FIRST_PAGE:"_firstPage",LAST_PAGE:"_lastPage",NEXT_PAGE:"_nextPage",PREV_PAGE:"_prevPage",GOTO_PAGE:"_gotoPage",OVERLAY_RECTANGLE:"_overlayRectangle",UPDATE_THUMBNAIL_PAGE:"_updateThumbnailPage",UPDATE_SLIDE_PAGE:"_updateSlidePage",REMOVE_FROM_TAG:"_removeFromTag",APPEND_FOR_TAG:"_appendForTag",INSERT_FOR_TAG:"_insertForTag",SWITCH_FOR_TAG:"_switchForTag",MOVE_FOR_TAG:"_moveForTag",REORDER_FOR_TAG:"_reorderForTag",OPEN_TAG:"_openTag",REMOVE_PAGE_TAG:"_removePageTag",ADD_PAGE_TAG:"_addPageTag",EMPTY_TAG:"_emptyTag",RENAME_TAG:"_renameTag",TAG_CHANGED:"_tagChanged",APPEND_SYNC:"_appendSync",UPDATE_SYNC:"_updateSync",REMOVE_FROM_FILE:"_removeFromFile",APPEND_FOR_FILE:"_appendForFile",INSERT_FOR_FILE:"_insertForFile",SWITCH_FOR_FILE:"_switchForFile",MOVE_FOR_FILE:"_moveForFile",REORDER_FOR_FILE:"_orderForFile",APPEND_TO_OPEN_TAG:"_appendToOpenTag",APPEND_TO_OPEN_ALL:"_appendToOpenAll",OPEN_ALL:"_openAll",APPEND_FOR_ALL:"_appendForAll",INSERT_FOR_ALL:"_insertForAll",REMOVE_FROM_ALL:"_removeFromAll",SWITCH_FOR_ALL:"_switchForAll",MOVE_FOR_ALL:"_moveForAll",REORDER_FOR_ALL:"_reorderForAll"},e.errorMessages={OK:{code:0,message:"ok."},PARAMETER_TYPE:{code:80001,message:"The parameter type is wrong."},PARAMETER_RANGE:{code:80002,message:"The parameter is out of range."},IMG_NOT_EXIST:{code:80003,message:"The image does not exist."},IMG_LOAD_FAILED:{code:80004,message:"The image load failed."},BACK_TO_TOP:{code:80005,message:"The current folder is root folder."},FILE_NOT_EXIST:{code:80006,message:"The file does not exist."},IMG_HAVE_EXIST:{code:80007,message:"The image has existed."},EMPTY_IN_ARRAY:{code:80008,message:"There is some empty element in array."},TAG_NOT_EXIST:{code:80009,message:"Tag does not exist."},TAG_HAVE_EXIST:{code:80010,message:"The tag already exists."},ELEMENT_NOT_EXIST:{code:80011,message:"Element does not exist."},PAGE_NOT_EXIST:{code:80012,message:"Page does not exist."},PARAMETER_INVALID:{code:80013,message:"The parameter is invalid."},URL_INVALID:{code:80014,message:"The url is invalid."},FOLDER_NOT_EXIST:{code:80015,message:"The folder does not exist."},COLOR_INVALID:{code:80016,message:"The color is invalid."},IMG_STORAGE_FAILED:{code:80017,message:"Failed to save image to database."},IMG_REMOVE_FAILED:{code:80018,message:"Failed to remove image from database by uid."},PATH_ERROR:{code:80019,message:"The path of file or folder does not exist."},BROWSER_NOT_SUPPORT:{code:80020,message:"Your browser does not support full screen."},SIZE_INVALID:{code:80021,message:"The size is invalid."},OPERATION_MODE_ERROR:{code:80022,message:"The operation mode is error."},BORDER_INVALID:{code:80023,message:"The border is invalid."},CAMERA_CLASS_REQUIRE:{code:80025,message:"The camera class is required."},VIEW_UI_REQUIRE:{code:80026,message:"The constructor of view ui is required."},WEBCAM_LICENSE_INVALID:{code:80027,message:"The license of webcam is invalid."},CAMERA_EXIST:{code:80028,message:"The video is shown."},CAMERA_CLASS_INVALID:{code:80029,message:"The camera class is invalid."},META_DATA_NOT_EXIST:{code:80030,message:"The metadata is not exist."},CAMERA_NOT_EXIST:{code:80031,message:"The video is not shown."}},e.lineType={FREE_LINE:0,STRAIGHT_LINE:1,BROKEN_LINE:2},e.dashType={a:null,b:null},e.shapeType={RECTANGLE:0,CIRCLE:1,TRIANGLE:2},e.operationMode={HAND:0,CROP:1,CLICK_TO_ZOOM:2}},function(t,e,i){"use strict";var a=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<i;e++)for(var o=arguments[e],r=0,a=o.length;r<a;r++,s++)n[s]=o[r];return n};Object.defineProperty(e,"__esModule",{value:!0}),e.PublishSubscribe=void 0;var n=(s.prototype.on=function(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)},s.prototype.emit=function(t){for(var e,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var s=this._events[t];if(!s||0===s.length)return!1;for(var o=s.length,r=0;r<o;r++)null!==(e=s[r])&&void 0!==e&&e.call.apply(e,a([null],i))},s.prototype.off=function(t,e){var i=this._events[t];if(!i)return!1;if(e)for(var n=i.length,s=0;s<n;s++)i[s]===e&&i.splice(s,1);else i&&(i.length=0)},s);function s(){this._events={}}e.PublishSubscribe=n},,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CropManager=void 0;var n=i(7),s=(o.prototype.setKeepAspectRatio=function(e){this.keepAspectRatio=e,this.drawingFlag||this.cropBoxes.forEach(function(t){t.keepAspectRatio=e})},o.prototype.setAspectRatio=function(t){this.aspectRatio=t},o.prototype.setZoom=function(e){this.zoom=e,this.cropBoxes.forEach(function(t){t.zoom=e})},o.prototype.setPageSize=function(t,e){this.width=t,this.height=e},o.prototype.getRectArr=function(){var n=[];return this.cropBoxes.forEach(function(t,e){var i=Object.assign({index:e},t.getRect());n.push(i)}),n},o.prototype.clear=function(){var t;0<this.cropBoxes.length&&null!==(t=this.unselectedCallback)&&void 0!==t&&t.call(this),this.cropBoxes=[]},o.prototype.addFreeBox=function(t){var e=new n.CropBox({vertexes:t.slice(),width:this.width,height:this.height,mode:"free"});return this.cropBoxes.push(e),e},o.prototype.addBox=function(t,e){var i=new n.CropBox({vertexes:t.slice(),width:this.width,height:this.height,type:e,mode:"normal",aspectRatio:this.aspectRatio,keepAspectRatio:this.keepAspectRatio,zoom:this.zoom});return this.cropBoxes.push(i),i},o.prototype.removeBox=function(t){return void 0===t&&this.clear(),!(t<0||t>=this.cropBoxes.length||(this.cropBoxes.splice(t,1),0))},o.prototype.getBoxByUid=function(t){for(var e=this.cropBoxes.length,i=0;i<e;i++)if(this.cropBoxes[i].uid===t)return this.cropBoxes[i];return null},o.prototype.onStartHandler=function(t,e,i){this.startX=t,this.startY=e,this.mouseDown=!0;var n=this.checkSelect(t,e);if(null===n)return i||this.clear(),void(this.activeBoxId=null);this.activeBoxId=this.cropBoxes[n].uid,this.getBoxByUid(this.activeBoxId).onStartHandler(t,e)},o.prototype.onMoveHandler=function(t,e,i){if(this.mouseDown){var n=null,s=t-this.startX,o=e-this.startY,r=null,a=2/this.zoom;!this.activeBoxId&&t-this.startX<-a&&e-this.startY<-a?(r=0)<this.aspectRatio&&(o=s/this.aspectRatio):!this.activeBoxId&&t-this.startX>a&&e-this.startY<-a?(r=1,0<this.aspectRatio&&(o=-s/this.aspectRatio)):!this.activeBoxId&&t-this.startX>a&&e-this.startY>a?(r=2,0<this.aspectRatio&&(o=s/this.aspectRatio)):!this.activeBoxId&&t-this.startX<-a&&e-this.startY>a&&(r=3,0<this.aspectRatio&&(o=-s/this.aspectRatio));var l=[t,this.startY+o,this.startX,this.startY+o,this.startX,this.startY,t,this.startY],h=[this.startX,this.startY,this.startX,this.startY+o,t,this.startY+o,t,this.startY];if(null!==r){for(var u=[],d=0;d<4;d++)r%2?(u.push(h[2*(r+d)%8]),u.push(h[(2*(r+d)+1)%8])):(u.push(l[2*(r+d)%8]),u.push(l[(2*(r+d)+1)%8]));return n=this.addBox(u,["topLeft","topRight","bottomRight","bottomLeft"][r]),0<this.aspectRatio?n.keepAspectRatio=!0:n.keepAspectRatio=!1,this.drawingFlag=!0,this.addNewFlag=this.keepAspectRatio,this.activeBoxId=n.uid,n.onStartHandler(this.startX,this.startY,r),n.onMoveHandler(t,e,r),void(r=null)}this.activeBoxId&&(n=this.getBoxByUid(this.activeBoxId)),n&&n.onMoveHandler(t,e)}},o.prototype.onEndHandler=function(t,e){var i,n;this.mouseDown&&(this.mouseDown=!1,this.drawingFlag=!1,!this.activeBoxId||(n=this.getBoxByUid(this.activeBoxId))&&(null!==this.addNewFlag&&(n.keepAspectRatio=this.addNewFlag,this.addNewFlag=null),n.onEndHandler(t,e),0<this.cropBoxes.length&&null!==(i=this.selectedCallback)&&void 0!==i&&i.call(this,this.getRectArr()),this.activeBoxId=null))},o.prototype.checkSelect=function(t,e){var i=this.cropBoxes.length;if(0===i)return null;for(var n=i-1;0<=n;n--)if(null!==this.cropBoxes[n].isBoxSelected(t,e))return n;return null},o.prototype.checkSelectForCursor=function(t,e){var i=this.cropBoxes.length;if(0===i)return null;for(var n=i-1;0<=n;n--){var s=this.cropBoxes[n],o=s.isBoxSelected(t,e);if(null!==o){var r="move";return-1!==o&&(r=s.checkPointPosition(o)),{part:o,type:s.type,position:r}}}return null},o);function o(t,e){this.cropBoxes=[],this.width=0,this.height=0,this.activeBoxId=null,this.mouseDown=!1,this.startX=null,this.startY=null,this.selectedCallback=null,this.unselectedCallback=null,this.aspectRatio=0,this.keepAspectRatio=!1,this.addNewFlag=null,this.drawingFlag=!1,this.zoom=1,this.width=t,this.height=e}e.CropManager=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BaseComponent=void 0;var n=i(0),s=(o.prototype.bindElement=function(t,e){var i=this._createElement(e);return this.containerEl=t,!!i&&(t.appendChild(i),!0)},o.prototype.setAttributes=function(t){return!!n.isObject(t)&&(this._initConfig(t),this._updateAttributes(),!0)},o.prototype._createElement=function(t){var e,i;this.element&&(null!==(i=null===(e=this.containerEl)||void 0===e?void 0:e.removeChild)&&void 0!==i&&i.call(e,this.element),this.element=null),this._initConfig(t);var n=document.createElement(this.tagName);return this._updateAttributes(n),n},o.prototype._initConfig=function(t){if(!n.isObject(t))return!1;for(var e in t)void 0!==t[e]&&(this[e]=t[e]);return!0},o.prototype._updateAttributes=function(t){return n.isElement(t)||(t=this.element),!!t&&(t.className=(this.name?"dvs-"+this.name:"")+this.cssStyle+(this.visibility?"":" dvs-disabled"),this.name&&(t.id=""+(this.name+this._postfix)),void 0!==this.sequence&&("string"==typeof(e=null==t?void 0:t.style).msFlexOrder?e.msFlexOrder=this.sequence:e.order=this.sequence),!0);var e},o);function o(t,e,i){this._pubsub=null,this.element=null,this.containerEl=null,this.location="",this.visibility=!0,this.cssStyle="",this.tagName="div",this.name="",this._postfix=t,this._pubsub=i,this.element=this._createElement(e)}e.BaseComponent=s},,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CropBox=void 0;var n=i(0),s=(o.prototype.getRect=function(){if("free"===this.mode)return null;var t=this._getMaxPoint(),e=t.minX,i=t.maxX,n=t.minY,s=t.maxY;return{x:Math.floor(e),y:Math.floor(n),width:Math.floor(i-e),height:Math.floor(s-n)}},o.prototype._initBox=function(){this.midpoints=this.calcMidpoint(this.vertexes),this.probePoints=this.vertexes.slice().concat(this.midpoints.slice()),this.slopeRatio=this.calcSlopeRatio(this.vertexes)},o.prototype._getMaxPoint=function(){return{minX:Math.min(this.probePoints[0],this.probePoints[2],this.probePoints[4],this.probePoints[6]),maxX:Math.max(this.probePoints[0],this.probePoints[2],this.probePoints[4],this.probePoints[6]),minY:Math.min(this.probePoints[1],this.probePoints[3],this.probePoints[5],this.probePoints[7]),maxY:Math.max(this.probePoints[1],this.probePoints[3],this.probePoints[5],this.probePoints[7])}},o.prototype.checkPointPosition=function(t){var e=this._getMaxPoint(),i=e.minX,n=e.maxX,s=e.minY,o=e.maxY,r=this.probePoints[2*t],a=this.probePoints[2*t+1];return t<4?r===n&&a===o?"se":r===n&&a===s?"ne":r===i&&a===s?"nw":r===i&&a===o?"sw":null:r===n?"e":a===o?"s":r===i?"w":a===s?"n":null},o.prototype.onStartHandler=function(t,e,i){var n=this.isBoxSelected(t,e);void 0!==i&&(n=i),null!==n&&(this._startX=t,this._startY=e,this._lastX=t,this._lastY=e,-1===n?(this.isPointSelected=!1,this.activeProbePoint=null,"normal"===this.mode&&(this.isMoveBox=!0)):(this.isPointSelected=!0,this.activeProbePoint=n,this.isMoveBox=!1))},o.prototype.onMoveHandler=function(t,e,i){if(this.isPointSelected||this.isMoveBox){var n=this.probePoints.slice();if(this.isPointSelected){var s=this.activeProbePoint;void 0!==i&&(s=i),n="normal"===this.mode?this._movePointNormal(n,s,t,e):this._movePointFree(n,s,t,e),this.probePoints=n.slice(),this.checkRectConvexity(this.probePoints)?(this.lineColor=this.defaultLineColor,this.firstPointColor=this.defaultFirstPointColor):(this.lineColor=this.invalidLineColor,this.firstPointColor=this.invalidFirstPointColor)}else if(this.isMoveBox){var o=t-this._lastX,r=e-this._lastY;if(0==o&&0==r)return;n=this._moveBox(n,o,r),this.probePoints=n.slice()}var a=this.calcMidpoint(this.probePoints);this.probePoints=this.probePoints.slice(0,8).concat(a),this.midpoints=a,this._lastX=t,this._lastY=e}},o.prototype.onEndHandler=function(t,e){this.lineColor=this.defaultLineColor,this.firstPointColor=this.defaultFirstPointColor;var i=this._startX,n=this._startY;if(this._startX=0,this._startY=0,this._lastX=t,this._lastY=e,this.isPointSelected||this.isMoveBox){this.isPointSelected=!1,this.isMoveBox=!1,this.activeProbePoint=null;var s=this.checkRectConvexity(this.probePoints);if(i===t&&n===e||!s)return this.probePoints=this.vertexes.slice().concat(this.midpoints),void(this.slopeRatio=this.calcSlopeRatio(this.probePoints).slice(0,4));this.vertexes=this.probePoints.slice(0,8),this.midpoints=this.probePoints.slice(8,16)}},o.prototype._checkEdge=function(t,e){return 0<=t&&t<=this.width&&0<=e&&e<this.height},o.prototype._movePointNormal=function(t,e,i,n){i=Math.max(0,Math.min(this.width,i)),n=Math.max(0,Math.min(this.height,n));var s=0,o=0;if(this.keepAspectRatio){var r=this._getMaxPoint(),a=r.minX,l=r.maxX,h=r.minY,u=r.maxY,d=this.checkPointPosition(e),c=(l-a)/(u-h);0===c||c===1/0||c===-1/0||isNaN(c)?c=this._lastWhr:this._lastWhr=c,o=s=0;var p="width";if(e<4){if(s=i-t[2*e],o=n-t[2*e+1],0===s||0===o)return t;p="width"}else{var v=e-4;if("e"===d?(e=(1+v)%4,p="width"):"s"===d?(e=v,p="height"):"w"===d?(e=v,p="width"):"n"===d&&(e=(1+v)%4,p="height"),s=i-t[2*v],o=n-t[2*v+1],0===s||0===o)return t}"height"===p?(s=o*c,"ne"!==d&&"sw"!==d&&"n"!==d&&"w"!==d||(s=-s)):(o=s/c,"ne"!==d&&"sw"!==d&&"n"!==d&&"w"!==d||(o=-o));var _=t[2*e]+s,f=t[2*e+1]+o;_<0?(s=0-t[2*e],o=0):_>this.width?(s=this.width-t[2*e],o=0):f<0?(o=0-t[2*e+1],s=0):f>this.height&&(o=this.height-t[2*e+1],s=0),t[2*e]+=s,t[2*e+1]+=o,m=(e+1)%4,g=(e+3)%4,e%2?(t[2*m]+=s,t[2*g+1]+=o):(t[2*m+1]+=o,t[2*g]+=s)}else if(e<4){if(s=i-t[2*e],o=n-t[2*e+1],0===s&&0===o)return t;t[2*e]=i,t[2*e+1]=n;var m=(e+1)%4,g=(e+3)%4;e%2?(t[2*m]=i,t[2*g+1]=n):(t[2*m+1]=n,t[2*g]=i)}else{var y=e-4,b=this.slopeRatio[y%4];0===b?(t[(2*y+3)%8]=n,t[(2*y+1)%8]=n):b!==1/0&&b!==-1/0||(t[(2*y+2)%8]=i,t[(2*y+0)%8]=i)}return t},o.prototype._movePointFree=function(t,e,i,n){if(i=Math.max(0,Math.min(this.width,i)),n=Math.max(0,Math.min(this.height,n)),e<4){var s=i-t[2*e],o=n-t[2*e+1];if(0==s&&0==o)return t;t[2*e]=i,t[2*e+1]=n}return t},o.prototype._moveBox=function(t,e,i){if("normal"===this.mode){var n=Math.min(t[0],t[2],t[4],t[6]),s=Math.max(t[0],t[2],t[4],t[6]),o=Math.min(t[1],t[3],t[5],t[7]),r=Math.max(t[1],t[3],t[5],t[7]);n+e<0&&(e=-n),s+e>this.width&&(e=this.width-s),o+i<0&&(i=-o),r+i>this.height&&(i=this.height-r);for(var a=0;a<4;a++)t[2*a]+=e,t[2*a+1]+=i}return t},o.prototype._isPointOnBox=function(t,e){if("normal"!==this.mode)return!1;var i=this._getMaxPoint(),n=i.minX,s=i.maxX,o=i.minY,r=i.maxY;return n<=t&&t<=s&&o<=e&&e<=r},o.prototype.isBoxSelected=function(t,e){var i=this._isPointOnBox(t,e),n=this.isCtrlPointSelected(t,e);return null!==n?n:i?-1:null},o.prototype.isCtrlPointSelected=function(t,e){var i=this.sensorRadius/this.zoom,n=8;"free"===this.mode&&(n=4);for(var s=0;s<n;s++){var o=this.probePoints[2*s],r=this.probePoints[2*s+1];if(t<=o+i&&o-i<=t&&e<=r+i&&r-i<=e)return s}return null},o.prototype.checkRectConvexity=function(t){var e=(t[6]-t[0])*(t[3]-t[1])-(t[7]-t[1])*(t[2]-t[0]),i=(t[0]-t[2])*(t[5]-t[3])-(t[1]-t[3])*(t[4]-t[2]),n=(t[2]-t[4])*(t[7]-t[5])-(t[3]-t[5])*(t[6]-t[4]),s=(t[4]-t[6])*(t[1]-t[7])-(t[5]-t[7])*(t[0]-t[6]);if(e*i*n*s<0)return!1;var o=t.slice().concat(t.slice(0,2));if(this.slopeRatio.length)for(var r=0;r<2;r++)if(this.slopeRatio[r]!==this.slopeRatio[r+2]&&this.calcIntersection(o.slice(2*r,2*r+2),o.slice(2*r+2,2*r+4),o.slice(2*r+4,2*r+6),o.slice(2*r+6,2*r+8)))return!1;return 0<e*i*n*s},o.prototype.calcMidpoint=function(t){for(var e=t.slice(0,8).concat(t[0],t[1]),i=[],n=0;n<4;n++){var s=(e[2*n]+e[2*n+2])/2,o=(e[2*n+1]+e[2*n+3])/2;i.push(s,o)}return i},o.prototype.calcSlopeRatio=function(t){for(var e=[],i=null,n=t.slice(0,8).concat(t[0],t[1]),s=0;s<4;s++)i=n[2*s+3]-n[2*s+1]==0&&n[2*s+2]-n[2*s]==0?0:(n[2*s+3]-n[2*s+1])/(n[2*s+2]-n[2*s]),e.push(i);return e},o.prototype.calcIntersection=function(t,e,i,n){if(this._isRectCross(t,e,i,n)&&this._isLineSegmentCross(t,e,i,n)){var s,o=void 0,r=(n[0]-i[0])*(t[1]-e[1])-(e[0]-t[0])*(i[1]-n[1]),o=(t[1]-i[1])*(e[0]-t[0])*(n[0]-i[0])+i[0]*(n[1]-i[1])*(e[0]-t[0])-t[0]*(e[1]-t[1])*(n[0]-i[0]);if(0==r||0===o){var a=this._getLine(t,e),l=this._getLine(i,n),h=a[0],u=a[1],d=l[0],c=l[1];if(u[0]===d[0]&&u[1]===d[1])return u;if(h[0]===c[0]&&h[1]===c[1])return h;if(this._isOnLine(u,l)&&this._isOnLine(d,a))return[d,u];if(this._isOnLine(h,l)&&this._isOnLine(c,a))return[h,c];if(this._isOnLine(h,l)&&this._isOnLine(u,l))return[h,u];if(this._isOnLine(d,l)&&this._isOnLine(c,l))return[d,c]}return s=o/r,r=(t[0]-e[0])*(n[1]-i[1])-(e[1]-t[1])*(i[0]-n[0]),[s,(o=e[1]*(t[0]-e[0])*(n[1]-i[1])+(n[0]-e[0])*(n[1]-i[1])*(t[1]-e[1])-n[1]*(i[0]-n[0])*(e[1]-t[1]))/r]}return!1},o.prototype._getLine=function(t,e){return t[0]===e[0]?t[1]<e[1]?[t,e]:[e,t]:t[0]<e[0]?[t,e]:[e,t]},o.prototype._isOnLine=function(t,e){return e[0][0]===e[1][0]?t[1]>=e[0][1]&&t[1]<=e[1][1]:t[0]>=e[0][0]&&t[0]<=e[1][0]},o.prototype._isRectCross=function(t,e,i,n){var s=Math.min,o=Math.max;return s(t[0],e[0])<=o(i[0],n[0])&&s(i[0],n[0])<=o(t[0],e[0])&&s(t[1],e[1])<=o(i[1],n[1])&&s(i[1],n[1])<=o(t[1],e[1])},o.prototype._isLineSegmentCross=function(t,e,i,n){var s=t[0]*(i[1]-e[1])+e[0]*(t[1]-i[1])+i[0]*(e[1]-t[1]),o=t[0]*(n[1]-e[1])+e[0]*(t[1]-n[1])+n[0]*(e[1]-t[1]);return!(0<=(s^o)&&0!==s&&0!==o||0<=((s=i[0]*(t[1]-n[1])+n[0]*(i[1]-t[1])+t[0]*(n[1]-i[1]))^(o=i[0]*(e[1]-n[1])+n[0]*(i[1]-e[1])+e[0]*(n[1]-i[1])))&&0!==s&&0!==o)},o);function o(t){this.uid=null,this.mode="normal",this.vertexes=[],this.midpoints=[],this.probePoints=[],this.slopeRatio=[],this.isCrop=!1,this.ctrlRadius=4,this.sensorRadius=4,this.defaultLineColor="rgba(0,0,0,1)",this.defaultFirstPointColor="rgba(255,0,0,1)",this.invalidLineColor="rgba(255,0,0,1)",this.invalidFirstPointColor="rgba(0,0,0,1)",this.lineColor="rgba(0,0,0,1)",this.firstPointColor="rgba(0,0,0,1)",this.pointFillColor="rgba(255,255,255,0)",this.lineWidth=1,this.dashLine=[4,2],this.isPointSelected=!1,this.activeProbePoint=null,this.moveLeft=0,this.moveTop=0,this.isMoveBox=!1,this.width=0,this.height=0,this.type="bottomRight",this.keepAspectRatio=!1,this.aspectRatio=0,this._startX=null,this._startY=null,this._lastX=null,this._lastY=null,this._lastWhr=1,this.zoom=1,this.uid=n.uid(11),this.vertexes=t.vertexes,this.width=t.width,this.height=t.height,this.type=t.type,this.mode=t.mode,this.keepAspectRatio=t.keepAspectRatio,this.aspectRatio=t.aspectRatio,this.zoom=t.zoom,this._initBox()}e.CropBox=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var _=i(0),o=i(60);e.default={createVnode:function(t,e,i,n,s){if(void 0===e&&(e={}),void 0===i&&(i=[]),_.isObject(e)&&_.isArray(i))return new o.VNode(t,e,i,n,s)},sameVnode:function(t,e){return e.data.key===t.data.key&&void 0!==e.data.key||(e.tagName===t.tagName||e.text===t.text&&void 0!==t.text)},createKeyHashList:function(t,e,i){for(var n,s,o={},r=e;r<=i;++r)(s=t[r])&&s.data&&(n=s.data.key)&&(o[n]=r);return o},removeVnodes:function(t,e,i){for(;e<=i;){var n,s=t[e];null==s||!s.el||(n=s.el.parentElement)&&n.removeChild(s.el),++e}},addVnodes:function(i,n,s,o,t){for(var r=this;o<=t;)!function(){var t,e=s[o];e&&(e.el||(e.el=document.createElement(e.tagName),Object.keys(e.data).forEach(function(t){"class"===t?e.el.className=e.data[t]:"style"===t?e.el.setAttribute(t,e.data[t]):e.el[t]=e.data[t]})),e.text&&(e.el.textContent=e.text),_.insertBefore(e.el,n,i),(t=e.children)&&t.length&&r.addVnodes(e.el,null,t,0,t.length)),++o}()},addOneVnode:function(t,e,i){if(!t||!t.children)return!1;var n=t.children[e]&&t.children[e].el;return t.children.splice(e,0,i),this.addVnodes(t.el,n,[i],0,0)},patchVnode:function(e,i){var t=i.el=e.el;Object.keys(i.data).forEach(function(t){e.el[t]!==i.data[t]&&("class"===t||"style"===t?e.el.setAttribute(t,i.data[t]):e.el[t]=i.data[t],e.data[t]=i.data[t])});var n=e.children,s=i.children;e!==i&&(""!==i.text&&e.text!==i.text?t.textContent=i.text:n.length&&s.length&&n!==s?this.updateChildren(t,n,s):s&&s.length?this.addVnodes(t,null,s,0,s.length):n&&n.length&&this.removeVnodes(n,0,n.length))},updateChildren:function(t,e,i){for(var n,s,o,r,a=0,l=0,h=e.length-1,u=i.length-1,d=e[0],c=e[h],p=i[0],v=i[u];a<=h&&l<=u;)null==d?d=e[++a]:null==c?c=e[--h]:null==p?p=i[++l]:null==v?v=i[--u]:this.sameVnode(d,p)?(this.patchVnode(d,p),d=e[++a],p=i[++l]):this.sameVnode(c,v)?(this.patchVnode(c,v),c=e[--h],v=i[--u]):this.sameVnode(d,v)?(this.patchVnode(d,v),_.insertBefore(d.el,c.el.nextSibling,t),d=e[++a],v=i[--u]):p=(this.sameVnode(c,p)?(this.patchVnode(c,p),_.insertBefore(c.el,d.el,t),c=e[--h]):(void 0===n&&(n=this.createKeyHashList(e,a,h)),void 0===(s=n[p.data.key])?this.addVnodes(t,d.el,i,l,l):(o=e[s]).sel!==p.sel?this.addVnodes(t,d.el,e,s,s):(this.patchVnode(o,p),_.insertBefore(p.el,d.el,t),e[s]=null)),i[++l]);h<a?(r=i[u+1]?i[u+1].el:null,this.addVnodes(t,r,i,l,u)):u<l&&this.removeVnodes(e,a,h)},patch:function(t,e){var i,n;return this.sameVnode(t,e)?this.patchVnode(t,e):null!==(n=(i=t.el).parentNode)&&(_.insertBefore(e.el,i.nextSibling,n),n.removeChild(t.el),t=null),e}}},,,,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),n=(s.prototype._registerEvents=function(){var s=this,t=this._element,i=r.isMobile(),e="mousedown",n="mousemove",o="mouseup";i&&(e="touchstart",n="touchmove",o="touchend",i=!0),t.addEventListener(e,function(e){var t;s._packageEvent(e),s._mouseDownItem=s.getTarget(e),s._startX=e.clientX,s._startY=e.clientY,null!==(t=s.onPointDown)&&void 0!==t&&t.call(s,e),i?s._rightClickTimer=setTimeout(function(){var t;null!==(t=s.onRightClick)&&void 0!==t&&t.call(s,e),s._mouseDownItem=null},500):2===e.button&&(s._rightClickItem=s.getTarget(e))}),t.addEventListener(n,function(t){var e;s._packageEvent(t),null!==(e=s.onPointMove)&&void 0!==e&&e.call(s,t);var i=Math.abs(t.clientX-s._startX),n=Math.abs(t.clientY-s._startY);(5<i||5<n)&&(clearTimeout(s._rightClickTimer),r.isMobile()&&(s._mouseDownItem=null))}),t.addEventListener(o,function(t){var e,i;s._packageEvent(t),s._mouseUpItem=s.getTarget(t),null!==(e=s.onPointUp)&&void 0!==e&&e.call(s,t),clearTimeout(s._rightClickTimer),s.getTarget(t)===s._rightClickItem&&2===t.button?null!==(i=s.onRightClick)&&void 0!==i&&i.call(s,t):s._mouseDownItem===s._mouseUpItem&&s._clickHandler(t),s._rightClickItem=null}),t.addEventListener("mouseover",function(t){var e,i,n;r.isMobile()||(void 0===(i=t.fromElement)&&(i=t.relatedTarget),void 0===(n=t.toElement)&&(n=t.target),s.getTarget(t,i)!==s.getTarget(t,n)&&null!==(e=s.onPointOver)&&void 0!==e&&e.call(s,t))}),t.addEventListener("mouseout",function(t){var e,i,n;r.isMobile()||(void 0===(i=t.fromElement)&&(i=t.target),void 0===(n=t.toElement)&&(n=t.relatedTarget),s.getTarget(t,i)!==s.getTarget(t,n)&&null!==(e=s.onPointOut)&&void 0!==e&&e.call(s,t))})},s.prototype._clickHandler=function(e){var i=this;this._packageEvent(e),clearTimeout(this._clickTimer),this.getTarget(e)===this._clickItem?(this._clickItem=null,setTimeout(function(){var t;null!==(t=i.onDoubleClick)&&void 0!==t&&t.call(i,e)})):this._mouseDownItem===this._mouseUpItem&&(this._clickItem=this.getTarget(e),setTimeout(function(){var t;null!==(t=i.onClick)&&void 0!==t&&t.call(i,e)})),this._mouseDownItem=null,this._mouseUpItem=null,this._clickTimer=setTimeout(function(){i._clickItem=null},500)},s.prototype._packageEvent=function(t){var e,i=null===(e=t.changedTouches)||void 0===e?void 0:e[0];if(!i)return!1;for(var n in i)void 0===t[n]&&(t[n]=i[n])},s.prototype.getTarget=function(t,e){return void 0!==e?e:t.target},s);function s(t){this._clickItem=null,this._clickTimer=null,this._rightClickItem=null,this._rightClickTimer=null,this._mouseDownItem=null,this._startX=0,this._startY=0,this._mouseUpItem=null,this.onClick=null,this.onRightClick=null,this.onDoubleClick=null,this.onPointDown=null,this.onPointMove=null,this.onPointUp=null,this.onPointOver=null,this.onPointOut=null,this._element=t,this._registerEvents()}e.default=n},function(t,e,i){"use strict";var s=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<i;e++)for(var o=arguments[e],r=0,a=o.length;r<a;r++,s++)n[s]=o[r];return n},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.ThumbnailItem=void 0;var o=i(57),L=i(1),M=i(0),r=n(i(12)),a=i(14),l=(h.prototype._thumbnailInit=function(t){this._initThumbnailUi(t.uid),this._initThumbnailConfig(t),this._bindSelfEvents(),this._bindUiEvent()},h.prototype._initThumbnailConfig=function(t){var e=Object.keys(t);this._pubSub=t.pubsub;for(var i=0;i<e.length;i++){var n=e[i].replace("_",""),s=t[n];"pubsub"!==n&&void 0!==s&&(this[n]=s)}},h.prototype._initThumbnailUi=function(t){var e=new a.ContainerItem(t,{name:"Thumbnail"}),i="horizontal"===this.location?"":"dvs-nodisplay",n="vertical"===this.location?"":"dvs-nodisplay";e.element.innerHTML="\n        <div id='stretchBarLeft"+t+"' class='dvs-stretchBar dvs-stretchLeft "+i+"'></div>\n        <div id='stretchBarTop"+t+"' class='dvs-stretchBar dvs-stretchTop "+n+"'></div>\n        <div id='stretchBarRight"+t+"' class='dvs-stretchBar dvs-stretchRight "+i+"'></div>\n        <div id='stretchBarBottom"+t+"' class='dvs-stretchBar dvs-stretchBottom "+n+"'></div>\n        <ul id=\"thumbLists"+t+'" class="dvs-thumbLists"></ul>\n        ',this._thumbnailElement=e.element,this.uid=t,this._myQuery=function(t){var e;return null===(e=this._thumbnailElement)||void 0===e?void 0:e.querySelector("#"+t)},this._myQueryAll=function(t){var e;return null===(e=this._thumbnailElement)||void 0===e?void 0:e.querySelectorAll("#"+t)}},Object.defineProperty(h.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t,t=String(t),this._fullThumbnail?t="100%":/\d+$/.test(t)&&(t+="px");var e=this._thumbnailElement;e&&(e.style.flex="0 0 "+t,e.style.msFlex="0 0 "+t,"vertical"===this.location?(e.style.width="100%",e.style.height=t):(e.style.width=t,e.style.height="100%"),this._resizeViewer())},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"mouseShape",{get:function(){return this._mouseShape},set:function(t){this._mouseShape=t;var e=this._thumbnailElement;e&&(e.style.cursor=t)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"scrollDirection",{get:function(){return this._scrollDirection},set:function(t){this._scrollDirection=t;var e,i=this._thumbnailElement;i&&(e=i.querySelector("#thumbLists"+this.uid),"vertical"===t?(e.style.flexDirection="row",e.style.overflowX="hidden",e.style.overflowY="auto"):(e.style.flexDirection="column",e.style.overflowX="auto",e.style.overflowY="hidden"),this.showLatestPage())},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"sequence",{get:function(){return this._sequence},set:function(t){var e=this;this._sequence=t;var i=this._thumbnailElement;i&&(i.style.order=String(t),i.style.msFlexOrder=t,this._updateStretchBars(),this.isInner||setTimeout(function(){e._viewerEmit("onSetSplitBar")},0))},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"location",{get:function(){return this._location},set:function(t){var e,i=this;this._location=t;var n,s=null,o=null===(e=this._viewerContainer)||void 0===e?void 0:e.el;o&&this._thumbnailElement&&(n={vertical:"#content"+this._postfix,horizontal:"#middle"+this._postfix,canvas:"#innerThumbnail"+this._postfix},(s=null==o?void 0:o.querySelector(n[t]))&&s.appendChild(this._thumbnailElement),this._updateStretchBars(),this.size=this._size,this.isInner||setTimeout(function(){i._viewerEmit("onSetSplitBar")},20),this.showLatestPage())},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"showThumbnail",{get:function(){return this._showThumbnail},set:function(t){var e=this;this._showThumbnail=t;var i=this._thumbnailElement;i&&(t?i.classList.remove("dvs-disabled"):i.classList.add("dvs-disabled"),this.updatePageLayout(),this._resizeViewer(),this._viewerEmit(L.uiEvent.SHOW_LATEST_PAGE),this.isInner||setTimeout(function(){e._viewerEmit("onSetSplitBar")},0))},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"showPageNumber",{get:function(){return this._showPageNumber},set:function(t){this._showPageNumber=t,this.renderCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"showSelectBox",{get:function(){return this._showSelectBox},set:function(t){this._showSelectBox=t,this.renderCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"fullThumbnail",{get:function(){return this._fullThumbnail},set:function(t){this._fullThumbnail=t,this.size=this._size;var e=this._myQuery("thumbnailStretchBarRight"+this.uid);e&&(t?e.classList.add("dvs-nodisplay"):e.classList.remove("dvs-nodisplay"))},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"background",{get:function(){return this._background},set:function(t){this._background=t;var e=this._myQuery("thumbLists"+this.uid);e&&(e.style.background=t)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"border",{get:function(){return this._border},set:function(t){this._border=t;var e=this._thumbnailElement;e&&(e.style.border=t)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"selectedPageBorder",{get:function(){return this._selectedPageBorder},set:function(t){this._selectedPageBorder=t;for(var e=this._myQueryAll("thumbLists"+this.uid+">li.dvs-activeThumb"),i=0;i<e.length;i++)e[i].style.border=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"selectedPageBackground",{get:function(){return this._selectedPageBackground},set:function(t){this._selectedPageBackground=t;for(var e=this._myQueryAll("thumbLists"+this.uid+">li.dvs-activeThumb"),i=0;i<e.length;i++)e[i].style.background=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"pageBackground",{get:function(){return this._pageBackground},set:function(t){this._pageBackground=t;var e=this._myQuery("thumbLists"+this.uid);if(e&&e.children)for(var i=e.children,n=0;n<i.length;n++){var s=i[n];s.classList.contains("dvs-activeThumb")||(s.style.background=t)}},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"pageBorder",{get:function(){return this._pageBorder},set:function(t){this._pageBorder=t;var e=this._myQuery("thumbLists"+this.uid);if(e&&e.children)for(var i=e.children,n=0;n<i.length;n++){var s=i[n];s.classList.contains("dvs-activeThumb")||(s.style.border=t)}},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"pageMargin",{get:function(){return this._pageMargin},set:function(t){this._pageMargin=t,this._currentPageMargin=-1,this.showLatestPage()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"allowResizing",{get:function(){return this._allowResizing},set:function(t){this._allowResizing=t,this._updateStretchBars()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"showRemoveBtn",{get:function(){return this._showRemoveBtn},set:function(t){var e,i;(this._showRemoveBtn=t)?null!==(e=this._thumbnailElement)&&void 0!==e&&e.classList.remove("dvs-hide-remove-btn"):null!==(i=this._thumbnailElement)&&void 0!==i&&i.classList.add("dvs-hide-remove-btn")},enumerable:!1,configurable:!0}),h.prototype._bindSelfEvents=function(){var t,e=((t={})[L.uiEvent.UPDATE_THUMBNAIL_PROP]=this._updateProps,t[L.uiEvent.SCROLL_TO]=this.scrollTo,t[L.uiEvent.SET_VIEW_MODE]=this.setViewMode,t);for(var i in e)this._pubSub.on(i,e[i].bind(this));this._viewerPub.on(L.uiEvent.DOCUMENT_POINTER_MOVE,this._documentMouseMove.bind(this)),this._viewerPub.on(L.uiEvent.DOCUMENT_POINTER_UP,this._documentMouseUp.bind(this))},h.prototype._bindUiEvent=function(){var t,i=this,e=this._thumbnailElement;e&&((t=new r.default(e)).onPointDown=function(t){i._thumbnailDragStart(t),i._thumbnailPointerDown(t)},t.onPointMove=function(t){i._thumbnailDragMove(t),i._thumbnailPointerMove(t)},t.onPointUp=function(t){i._thumbnailPointerUp(t)},t.onClick=function(t){i._thumbnailClick(t)},t.onRightClick=function(t){i._thumbnailRightClick(t)},t.onDoubleClick=function(t){i._thumbnailDoubleClick(t)},t.onPointOver=function(t){i._thumbnailMouseOver(t)},t.onPointOut=function(t){i._thumbnailMouseOut(t)},t.getTarget=function(t,e){return void 0!==e?i.getImageItem(e):i.getImageItem(t)},M.addEvent(e.querySelector(".dvs-thumbLists"),"scroll",function(){i._thumbnailScroll()}),M.addEvent(e,M.isMobile()?"touchstart":"mousedown",function(t){i._thumbnailStretchStart(t)}),M.addEvent(e,"click",function(t){i._viewerPub.emit(L.privateEvent.UPDATE_FOCUS,{viewerId:i._postfix.replace("-",""),thumbnailId:i.uid}),M.stopBubble(t)}))},h.prototype.unbindEvents=function(){for(var t in this._eventList)this._pubSub.off(t)},h.prototype.unbindUi=function(){var t,e;this._thumbnailCanvas.forEach(function(t){t.dispose()}),(this._thumbnailCanvas=null)!==(e=null===(t=this._thumbnailElement)||void 0===t?void 0:t.parentElement)&&void 0!==e&&e.removeChild(this._thumbnailElement),this._thumbnailElement=null,this._viewerContainer=null},h.prototype.updateContent=function(t){void 0===t&&(t=[]),this._patch(t),this._updateElements(),this.renderCanvas(),t.length||this.triggerTopImageChange()},h.prototype.renderCanvas=function(){for(var t=this.selectedIndexes,e=0;e<this._thumbnailCanvas.length;e++){var i=this._thumbnailCanvas[e];i.setTempData({showPage:this.showPageNumber,showSelectBox:this.showSelectBox,currentPage:e+1,isSelected:-1!==t.indexOf(e)}),null!=i&&i.resizeCanvasSize()}},h.prototype.updateDisplayedIndexes=function(){if(!this.showThumbnail||this.isDrag)return!1;var t=this._getDisplayedImages(),e=!1,i=t.length;if(i!==this._displayedUrls.length)e=!0;else for(var n=0;n<i;n++)if((o=this._thumbnailCanvas[t[n]].imgSrc)!==this._displayedUrls[n]||!this._displayedUrls[n]){e=!0;break}if(e){for(var s=[],n=0;n<i;n++){var o=this._thumbnailCanvas[t[n]].imgSrc;s.push(o)}this._displayedUrls=s,this._viewerEmit("_mergeDisplayedIndexes",t.slice(0))}return e},h.prototype.keydownCallBack=function(t){this._emit(L.viewerEvent.KEY_DOWN,t),this.selectImageByKey(t)},h.prototype.keyupCallBack=function(t){this._emit(L.viewerEvent.KEY_UP,t)},h.prototype.selectImageByKey=function(t){if(this.allowKeyboardControl&&this._thumbnailCanvas.length){var e=this.selectedIndexes.slice().pop(),i=this.rows,n=this.columns,s="vertical"===this.scrollDirection,o=e;switch(t.key){case"ArrowUp":case"Up":if(s)o-=n;else{if(Math.floor((o-1)/i)!==Math.floor(o/i))return;--o}break;case"ArrowDown":case"Down":if(s)o+=n;else{if(Math.floor((o+1)/i)!==Math.floor(o/i))return;o+=1}break;case"ArrowLeft":case"Left":if(s){if(Math.floor((o-1)/n)!==Math.floor(o/n))return;--o}else o-=i;break;case"ArrowRight":case"Right":if(s){if(Math.floor((o+1)/n)!==Math.floor(o/n))return;o+=1}else o+=i;break;default:return}this._viewerEmit(L.modelEvent.GOTO_PAGE,o)}},h.prototype._updateElements=function(){var t=this._myQuery("thumbLists"+this.uid);if(!t)return!1;for(var e=0;e<t.children.length;e++){var i=t.children[e],n=this._thumbnailCanvas[e];n&&i&&(i["dvs-defaultIndex"]=e,i["dvs-tags"]=n.tags,i["dvs-uid"]=n.uid)}},h.prototype.setHoverColor=function(t){var e;!this.allowHover||(e=this.getImageItem(t))&&(e.classList.contains("dvs-activeThumb")||(e.style.background=this.hoverPageBackground,e.style.border=this.hoverPageBorder))},h.prototype.setImageColor=function(t){var e;!this.allowHover||(e=this.getImageItem(t))&&(e.classList.contains("dvs-activeThumb")?(e.style.background=this.selectedPageBackground,e.style.border=this.selectedPageBorder):(e.style.background=this._pageBackground,e.style.border=this.pageBorder))},h.prototype._addNodes=function(r,t,e){var i,a=this,l=[],h=this._myQuery("thumbLists"+this.uid);if(h){for(var u=h.children[t],d=this,n=t;n<=e;n++)!function(t){var e=r[t],i=d._initNode(e);l.push(i);var n,s=document.createElement("li");s.innerHTML="<canvas class='dvs-thumbnailCanvas'></canvas></div>",s.style.background=d.pageBackground,s.style.border=d.pageBorder,d.isInner||((n=document.createElement("span")).className="dvs-thumbnail-remove",n.onclick=function(){var t=M.getIndex(s);a._emit(L.viewerEvent.REMOVE_PAGE,t)},s.appendChild(n));var o=s.children[0];i._canvasItem=o,M.insertBefore(s,u,h)}(n);(i=this._thumbnailCanvas).splice.apply(i,s([t,0],l))}},h.prototype._removeNodes=function(t,e,i){t.splice(e,i-e+1);var n=this._myQuery("thumbLists"+this.uid);if(n&&n.children&&n.children.length)for(var s=e;s<=i;s++)n.removeChild(n.children[e])},h.prototype._patch=function(t){for(var e,i=this._thumbnailCanvas,n=0,s=i.length-1,o=0,r=t.length-1;n<=s&&o<=r;){var a,l=i[n],h=i[s],u=t[o],d=t[r];this._sameNode(l,u)?(++n,++o,l.updateData(u)):this._sameNode(h,d)?(--s,--r,h.updateData(d)):this._sameNode(l,d)?(l.updateData(d),this._moveNode(i,n,s)):this._sameNode(h,u)?(h.updateData(u),this._moveNode(i,s,n)):(void 0===e&&(e=this._createKeyHashList(i,n,s)),void 0!==(a=e[null==u?void 0:u.uid])?(i[a].updateData(u),this._moveNode(i,a,n)):(this._addNodes(t,o,o),s++),++o,++n)}s<n?this._addNodes(t,o,r):r<o&&this._removeNodes(i,n,s)},h.prototype._sameNode=function(t,e){return(null==t?void 0:t.uid)===(null==e?void 0:e.uid)},h.prototype._moveNode=function(t,e,i){var n=t.splice(e,1)[0];t.splice(i,0,n);var s=this._myQuery("thumbLists"+this.uid),o=s.removeChild(s.children[e]);o&&M.insertBefore(o,s.children[i],s)},h.prototype._initNode=function(t,e){var i={uid:t.uid,imgSrc:t.data,tags:t.tags};if(!e)return new o.ThumbnailPage(i,this._pubSub,this._dataStore);e.init(i)},h.prototype._createKeyHashList=function(t,e,i){for(var n,s,o={},r=e;r<=i;++r)(n=null==(s=t[r])?void 0:s.uid)&&(o[n]=r);return o},h.prototype.selectThumbnailByIndexes=function(t){M.isArray(t)?this.selectedIndexes=t:t=this.selectedIndexes,this.clearAbsolute(),this._updateSelectedPageStyle(),(this.showPageNumber||this.showSelectBox)&&this.renderCanvas(),this.showLatestPage()},h.prototype._updateSelectedPageStyle=function(){var t=this._myQuery("thumbLists"+this.uid);if(!t)return!1;var e=this.selectedIndexes,i=t.children;if(i&&i.length)for(var n=i.length,s=0;s<n;s++){var o=i[s],r=-1!==e.indexOf(s);this._selectThumbnailByNode(o,r)}},h.prototype._selectThumbnailByNode=function(t,e){t&&(e?(t.classList.add("dvs-activeThumb"),t.style.border=this.selectedPageBorder,t.style.background=this.selectedPageBackground):(t.classList.remove("dvs-activeThumb"),t.style.border=this.pageBorder,t.style.background=this.pageBackground))},h.prototype.setViewMode=function(t,e){var i,n;if(this.rows=e,this.columns=t,this.updatePageLayout(),this.selectThumbnailByIndexes(),1===e&&1===t?null!==(i=this._thumbnailElement)&&void 0!==i&&i.classList.add("dvs-hide-remove-btn"):this.showRemoveBtn&&null!==(n=this._thumbnailElement)&&void 0!==n&&n.classList.remove("dvs-hide-remove-btn"),10===document.documentMode){var s=this._myQuery("thumbLists"+this.uid);if(!s)return;s.style.marginTop=s.style.marginTop?"":"0.1px",this.renderCanvas()}return!0},h.prototype.updatePageLayout=function(){var t;if(!this.showThumbnail)return!1;var e=this._myQuery("thumbLists"+this.uid);if(null===(t=null==e?void 0:e.children)||void 0===t||!t.length)return!1;var i=e.clientWidth-1,n=e.clientHeight-1,s=this._getCurrentPageMargin(i,n,e);this._pageMarginNumber=s,this._setPageSize(i,n,e,s),this.renderCanvas()},h.prototype.calculateSize=function(){var t=this._thumbnailElement;if(t){var e=t.getBoundingClientRect();if(0==e.width||0==e.height)return!1;var i=this._tempThumbnailSize,n=t.clientWidth,s=t.clientHeight;i.width===n&&i.height===s||(i.width=n,i.height=s,this._emit(L.viewerEvent.THUMBNAIL_STRETCH,e.width,e.height))}this.updatePageLayout()},h.prototype._getCurrentPageMargin=function(t,e,i){var n,s,o,r,a=this.rows,l=this.columns,h=this._pageMargin;return h=String(h),h=/%$/.test(h)?(s=parseInt(h),n=Math.min(1/(l+1),1/(a+1)),(s=Math.min(s/100,n))*e-1):/em$/.test(h)?(this._currentPageMargin<0&&(o=parseInt(h),r=parseInt(window.getComputedStyle(i).fontSize),this._currentPageMargin=o*r),this._currentPageMargin):parseInt(h),t&&t+5<h*(l+1)&&(h=t/(l+1)),e&&e+5<h*(a+1)&&(h=e/(a+1)),h},h.prototype._setPageSize=function(t,e,i,n){if(null!=i&&i.children)for(var s=this.rows,o=this.columns,r=1===this.columns&&1===this.rows,a=((t-(o+1)*n)/o).toFixed(2),l=((e-(s+1)*n)/s).toFixed(2),h=i.children,u="vertical"===this._scrollDirection,d=0;d<h.length;d++){var c=h[d];r?(c.style.width=u?t+"px":"100%",c.style.height=u?"100%":e+"px",i.style.padding="0px",c.style.margin=0===d?"0px":u?n+"px 0px 0px":"0px 0px 0px "+n+"px "):(c.style.margin="0px "+n+"px "+n+"px 0px",i.style.padding=n+"px 0px 0px "+n+"px",d===h.length-1&&(c.style[u?"marginBottom":"marginRight"]=n+1+"px"),c.style.width=a+"px",c.style.height=l+"px")}},h.prototype.triggerTopImageChange=function(t){void 0===t&&(t=""),this.updateDisplayedIndexes(),this._onTopImageChange(this._calculateTopIndex,t)},h.prototype.scrollTo=function(t,e){if(void 0===e&&(e=""),this._tempScrollIndex=null,!this.showThumbnail)return this._tempScrollIndex=t,!0;var i,n,s,o,r,a,l,h=this._myQuery("thumbLists"+this.uid);return!(!h||h.clientWidth<=0||h.clientHeight<=0||t>h.children.length-1||h.children.length<=0||t<0||((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&(i=h.getBoundingClientRect(),n=this.scrollDirection,o=s=-1,a=(r=h.children[t]).getBoundingClientRect(),l=parseInt(h.style.padding),"vertical"===n?(o=0,a.top<=i.top?s=r.offsetTop-l+1:a.bottom>=i.bottom&&(s=r.offsetTop-i.height+a.height+l+1)):(s=0,a.left<=i.left?o=r.offsetLeft-l+1:a.right>=i.right&&(o=r.offsetLeft-i.width+a.width+l+1)),-1!==s&&(h.scrollTop=s),-1!==o&&(h.scrollLeft=o)),this.triggerTopImageChange(e),0))},h.prototype.showLatestPage=function(){var t=this.selectedIndexes.slice();t.length?(this.updatePageLayout(),this.scrollTo(t.pop())):this.triggerTopImageChange()},h.prototype._onTopImageChange=function(t,e){void 0===e&&(e="");var i=this._thumbnailElement;if(!this.showThumbnail||!i)return!1;if(this._thumbnailCanvas[t]){if(this.isDrag)return!1}else t=-1,e="";if(this._topImageIndex===t)return!1;this._topImageIndex=t,this._emit(L.viewerEvent.TOP_PAGE_CHANGED,t,e)},h.prototype._getDisplayedImages=function(){var t=this._myQuery("thumbLists"+this.uid),e=null==t?void 0:t.getBoundingClientRect();if(!e||!e.width)return[];var i=t.children[0];if(!i)return[];var n,s,o,r=i.getBoundingClientRect(),a=-1,l=0,h=this.rows,u=this.columns;for(l="vertical"===this.scrollDirection?(o=(t.scrollTop+1-(n=Math.floor(r.height))-(parseInt(i.style.marginTop)||parseInt(i.style.marginBottom)))/(n+this._pageMarginNumber),(a=((o=Math.floor(o))+1)*this.columns)+(h+1)*u-1):(o=(t.scrollLeft+1-(s=Math.floor(r.width))-(parseInt(i.style.marginLeft)||parseInt(i.style.marginRight)))/(s+this._pageMarginNumber),(a=((o=Math.floor(o))+1)*this.rows)+h*(u+1)-1);!this._thumbnailCanvas[a]&&-1<a;)a--;for(;!this._thumbnailCanvas[l]&&a<l;)l--;for(var d=[],c=a;c<=l;c++)0<=c&&d.push(c);return this._calculateTopIndex=a,this._displayedIndexes=d.slice(),d},h.prototype.dragThumbnail=function(t){return!(t.ctrlKey||t.shiftKey||t.metaKey)&&0===t.button&&this._dragStartFunction(t)},h.prototype.dragStartMobile=function(t){var e=this;return t=t.changedTouches[0],this._dragTimer=setTimeout(function(){return document.addEventListener("touchmove",M.preventDefault,{passive:!1}),e._dragStartFunction(t)},300),!0},h.prototype._dragStartFunction=function(t){if(!this.allowPageDragging||this._isCrop)return!1;var e=this.rows,i=this.columns;if(1===e&&1===i)return!1;var n=this.getImageItem(t);if(!n)return!1;n.classList.contains("dvs-activeThumb")||(this.selectedIndexes=[M.getIndex(n)],this._updateSelectedPageStyle(),this.needClick=!1);var s=n.getBoundingClientRect(),o=t.clientX-s.left,r=t.clientY-s.top;return this.thumbMoveOption={napX:o,napY:r,clickX:t.pageX,clickY:t.pageY,target:n},this.isDrag=!0,this._dragStart=!0},h.prototype._initReplaceBlocks=function(){for(var t=this._myQuery("thumbLists"+this.uid),e=t.querySelectorAll(".dvs-activeThumb"),i=0;i<e.length;i++){var n=e[i],s=document.createElement("li");s.className="dvs-replaceBlock",s.style.backgroundColor=this.placeholderBackground,s.style.margin=n.style.margin,s.style.width=n.style.width,s.style.height=n.style.height,s["dvs-defaultIndex"]=n["dvs-defaultIndex"],M.insertBefore(s,n,t)}t.classList.add("hideReplaceBlock")},h.prototype.dragMove=function(t){return this._dragMoveFunction(t)},h.prototype.dragMoveMobile=function(t){return t=t.changedTouches[0],clearTimeout(this._dragTimer),this._dragMoveFunction(t)},h.prototype._dragMoveFunction=function(t){if(this.isDrag){var e=this.thumbMoveOption,i=e.napX,n=e.napY,s=e.clickX,o=e.clickY,r=e.target,a=t.pageX,l=t.pageY;if(Math.abs(a-s)<10&&Math.abs(l-o)<10&&!this.ifDragMoves)return;var h=r["dvs-defaultIndex"],u=this._myQuery("thumbLists"+this.uid);if(!u)return;this._dragStart&&(this._dragStart=!1,this._initReplaceBlocks(),this._thumbnailCanvas.length<=this.rows*this.columns&&(u.style.overflow="hidden"),this._emit(L.viewerEvent.DRAG_START,{index:h,pageX:t.pageX,pageY:t.pageY},t)),this.ifDragMoves=!0;for(var d=u.scrollTop,c=u.scrollLeft,p=r.getBoundingClientRect(),v=this._myQueryAll("thumbLists"+this.uid+">li:not(.dvs-activeThumb):not(.dvs-replaceBlock)"),_=0;_<v.length;_++){var f=(x=v[_]).getBoundingClientRect(),m=f.left-p.left,g=f.top-p.top;if(Math.abs(m)<=p.width/2&&Math.abs(g)<=p.height/2){for(var y=M.getIndex(x),b=u.querySelectorAll("li.dvs-replaceBlock"),E=M.getIndex(b[0]),C=0;C<b.length;C++){var S=b[C];y<E?M.insertBefore(S,x,u):M.insertAfter(S,x)}return u.scrollTop=d,u.scrollLeft=c,!0}}var T=u.getBoundingClientRect(),w=t.clientY-T.top-n,R=t.clientX-T.left-i+c,I=w+d;u.classList.remove("hideReplaceBlock");for(var x,P=this._myQueryAll("thumbLists"+this.uid+">li.dvs-activeThumb"),A=0;A<P.length;A++)(x=P[A]).classList.add("dvs-absolute"),x.style.left=R+5*A+"px",x.style.top=I+5*A+"px";this._emit(L.viewerEvent.DRAG_MOVE,{index:h,pageX:t.pageX,pageY:t.pageY},t),M.preventDefault(t)}},h.prototype.dragUp=function(){return this._dragUpFunction()},h.prototype.dragUpMobile=function(){return document.removeEventListener("touchmove",M.preventDefault),clearTimeout(this._dragTimer),this._dragUpFunction()},h.prototype._dragUpFunction=function(){if(this.isDrag){this.thumbMoveOption=null,this.isDrag=!1;var t=this.ifDragMoves;if(this.clearAbsolute(),!t)return!1;for(var e=this._myQuery("thumbLists"+this.uid),i=e.children.length,n=[],s=[],o=[],r=this.selectedIndexes.slice(0),a=[],l=0;l<i;l++){var h,u=e.children[l],d=u["dvs-defaultIndex"];o.push(d),!u.classList.contains("dvs-activeThumb")||-1!==(h=r.indexOf(d))&&d!==(a[h]=l)&&s.push([d,l]),n[l]=this._thumbnailCanvas[d]}this._thumbnailCanvas=n,this.selectedIndexes=a,this._updateElements(),this._viewerEmit(L.privateEvent.REORDER_THUMBNAIL,o,a.slice()),s.length&&this._emit(L.viewerEvent.DRAG_DONE,s)}},h.prototype.stretchStart=function(t){if(1===t.button)return!1;var e=t.target;if(null==e||!e.classList.contains("dvs-stretchBar"))return!1;this.fullThumbnail||(e.classList.add("dvs-streching"),this._stretchItem=e,this._isStretching=!0,M.preventDefault(t))},h.prototype.stretchMove=function(t){if(!this._isStretching)return!1;var e,i,n=this._stretchItem;if(!n||!this._thumbnailElement)return!1;var s=this._thumbnailElement.getBoundingClientRect(),o=n.classList;o.contains("dvs-stretchRight")?(e=t.clientX-s.left<0?0:t.clientX-s.left,n.style.left=e+"px"):o.contains("dvs-stretchLeft")?(e=s.right-t.clientX<0?0:s.right-t.clientX,n.style.left=s.width-e+"px"):o.contains("dvs-stretchTop")?(i=s.bottom-t.clientY<0?0:s.bottom-t.clientY,n.style.top=s.height-i+"px"):(i=t.clientY-s.top<0?0:t.clientY-s.top,n.style.top=i+"px")},h.prototype.stretchEnd=function(){var t;if(!this._isStretching||!this._thumbnailElement)return!1;var e=this._stretchItem;if(!e)return!1;this._stretchItem=null,this._isStretching=!1;var i=parseInt(e.style.left),n=parseInt(e.style.top),s=0,o=this._thumbnailElement.getBoundingClientRect(),r=o.width-i,a=o.height-n,l=null===(t=this._pubQuery("showImageArea"+this._postfix))||void 0===t?void 0:t.getBoundingClientRect(),i=Math.min(i,l.width),n=Math.min(n,l.height),s=e.classList.contains("dvs-stretchRight")?i/l.width:e.classList.contains("dvs-stretchLeft")?r/l.width:e.classList.contains("dvs-stretchTop")?a/l.height:n/l.height;e.style.left=null,e.style.top=null,e.classList.remove("dvs-streching"),this.size=Math.min(100*s,100).toFixed(2)+"%",this._emit(L.privateEvent.CHANGE_THUMBNAIL_VIEW_PROP,{_size:this.size}),this._resizeViewer()},h.prototype._updateStretchBars=function(){var t=this._allowResizing,e=this._location,i=this._sequence,n="horizontal"===e&&t&&0<=i?"remove":"add",s="vertical"===e&&t&&0<=i?"remove":"add",o="horizontal"===e&&t&&i<0?"remove":"add",r="vertical"===e&&t&&i<0?"remove":"add",a=this.uid,l=this._myQuery("stretchBarLeft"+a),h=this._myQuery("stretchBarRight"+a),u=this._myQuery("stretchBarTop"+a),d=this._myQuery("stretchBarBottom"+a);null!=l&&l.classList[n]("dvs-nodisplay"),null!=h&&h.classList[o]("dvs-nodisplay"),null!=u&&u.classList[s]("dvs-nodisplay"),null!=d&&d.classList[r]("dvs-nodisplay")},h.prototype._updateProps=function(t){for(var e in t)this[e]=t[e]},h.prototype._imageClickCallback=function(t,e){var i=this.selectedIndexes.slice();if(!e.ctrlKey&&!e.metaKey||e.shiftKey)if(!e.shiftKey||e.ctrlKey||e.metaKey)if((e.ctrlKey||e.metaKey)&&e.shiftKey){var n=i.slice(0),s=n[n.length-1];n.push(t);var o=t,r=t;n.forEach(function(t){t<o?o=t:r<t&&(r=t)});for(var a=[],l=o;l<=r;l++)l!==s&&a.push(l);0<=s&&a.push(s),i=a}else this.needClick?i=[t]:this.needClick=!0;else if(void 0===(s=i[i.length-1]))i.push(t);else{var h=[];if(s<t)for(var l=t;s<=l;l--)h.push(l);else for(var u=t;u<=s;u++)h.push(u);i=h}else{var d=i.indexOf(t);if(-1===d)i.push(t);else{if(1===i.length)return!1;i.splice(d,1)}}return this._viewerEmit(L.privateEvent.SET_SELECTED_INDEXES,i),!0},h.prototype._thumbnailDragStart=function(t){return M.isMobile()?this.dragStartMobile(t):this.dragThumbnail(t)},h.prototype._thumbnailDragMove=function(t){return M.isMobile()?this.dragMoveMobile(t):this.dragMove(t)},h.prototype._thumbnailDragUp=function(){return M.isMobile()?this.dragUpMobile():this.dragUp()},h.prototype._thumbnailMouseOver=function(t){var e,i;this.allowHover&&!this.ifDragMoves&&((e=this.getImageItem(t))?(e.classList.contains("dvs-activeThumb")||(e.style.background=this.hoverPageBackground,e.style.border=this.hoverPageBorder),i=e["dvs-defaultIndex"],this._emit(L.viewerEvent.PAGE_MOUSE_OVER,{index:i,pageX:t.pageX,pageY:t.pageY},t)):this._emit(L.viewerEvent.PAGE_MOUSE_OVER,{index:-1,pageX:t.pageX,pageY:t.pageY},t))},h.prototype._thumbnailMouseOut=function(t){var e,i;this.allowHover&&!this.ifDragMoves&&((e=this.getImageItem(t))?(i=e["dvs-defaultIndex"],this._emit(L.viewerEvent.PAGE_MOUSE_OUT,{index:i,pageX:t.pageX,pageY:t.pageY},t),e.classList.contains("dvs-activeThumb")?(e.style.background=this.selectedPageBackground,e.style.border=this.selectedPageBorder):(e.style.background=this._pageBackground,e.style.border=this.pageBorder)):this._emit(L.viewerEvent.PAGE_MOUSE_OUT,{index:-1,pageX:t.pageX,pageY:t.pageY},t))},h.prototype._thumbnailClick=function(t){var e,i;this.ifDragMoves||((e=this.getImageItem(t))?(i=e["dvs-defaultIndex"],this._imageClickCallback(i,t),this._emit(L.viewerEvent.PAGE_CLICK,{index:i,pageX:t.pageX,pageY:t.pageY},t)):this._emit(L.viewerEvent.PAGE_CLICK,{index:-1,pageX:t.pageX,pageY:t.pageY},t))},h.prototype._thumbnailRightClick=function(t){var e=this.getImageItem(t);if(e){if(this.ifDragMoves)return!1;var i=e["dvs-defaultIndex"];this._emit(L.viewerEvent.PAGE_RIGHT_CLICK,{index:i,pageX:t.pageX,pageY:t.pageY},t),this._emit(L.viewerEvent.PAGE_CONTEXTMENU,{index:i,pageX:t.pageX,pageY:t.pageY},t),-1!==this.selectedIndexes.indexOf(i)||M.isMobile()&&this.allowPageDragging||this._emit(L.privateEvent.SET_SELECTED_INDEXES,[i])}else this._emit(L.viewerEvent.PAGE_RIGHT_CLICK,{index:-1,pageX:t.pageX,pageY:t.pageY},t),this._emit(L.viewerEvent.PAGE_CONTEXTMENU,{index:-1,pageX:t.pageX,pageY:t.pageY},t)},h.prototype._thumbnailDoubleClick=function(t){var e,i=this.getImageItem(t);i?(e=i["dvs-defaultIndex"],this._emit(L.viewerEvent.PAGE_DOUBLE_CLICK,{index:e,pageX:t.pageX,pageY:t.pageY},t)):this._emit(L.viewerEvent.PAGE_DOUBLE_CLICK,{index:-1,pageX:t.pageX,pageY:t.pageY},t)},h.prototype._thumbnailPointerDown=function(t){var e,i=this.getImageItem(t);i?(e=i["dvs-defaultIndex"],this._emit(L.viewerEvent.PAGE_MOUSE_DOWN,{index:e,pageX:t.pageX,pageY:t.pageY},t)):this._emit(L.viewerEvent.PAGE_MOUSE_DOWN,{index:-1,pageX:t.pageX,pageY:t.pageY},t)},h.prototype._thumbnailPointerMove=function(t){var e,i,n,s,o,r;if(this.ifDragMoves){if(!(this.isInner?null!==(n=null===(i=null===(e=this._viewerPub)||void 0===e?void 0:e._events)||void 0===i?void 0:i[L.viewerEvent.PAGE_MOUSE_MOVE])&&void 0!==n&&n.length:null!==(r=null===(o=null===(s=this._pubSub)||void 0===s?void 0:s._events)||void 0===o?void 0:o[L.viewerEvent.PAGE_MOUSE_MOVE])&&void 0!==r&&r.length))return;var a=this._getPointIndex(t);this._emit(L.viewerEvent.PAGE_MOUSE_MOVE,{index:a,pageX:t.pageX,pageY:t.pageY},t)}else{var l,h=this.getImageItem(t);h?(l=h["dvs-defaultIndex"],this._emit(L.viewerEvent.PAGE_MOUSE_MOVE,{index:l,pageX:t.pageX,pageY:t.pageY},t)):this._emit(L.viewerEvent.PAGE_MOUSE_MOVE,{index:-1,pageX:t.pageX,pageY:t.pageY},t)}},h.prototype._thumbnailPointerUp=function(t){var e,i,n;this.ifDragMoves?(e=this._getPointIndex(t),this._emit(L.viewerEvent.PAGE_MOUSE_UP,{index:e,pageX:t.pageX,pageY:t.pageY},t)):(i=this.getImageItem(t))?(n=i["dvs-defaultIndex"],this._emit(L.viewerEvent.PAGE_MOUSE_UP,{index:n,pageX:t.pageX,pageY:t.pageY},t)):this._emit(L.viewerEvent.PAGE_MOUSE_UP,{index:-1,pageX:t.pageX,pageY:t.pageY},t)},h.prototype._thumbnailScroll=function(){this.triggerTopImageChange("scroll")},h.prototype._thumbnailStretchStart=function(t){this.stretchStart(t)},h.prototype._documentMouseMove=function(t){this.stretchMove(t)},h.prototype._documentMouseUp=function(){this.stretchEnd(),this._thumbnailDragUp()},h.prototype.getImageItem=function(t){var e,i,n;if(!t)return null;if(!(n=M.isElement(t)?t:t.target)||null!==(e=n.classList)&&void 0!==e&&e.contains("dvs-replaceBlock"))return null;if("CANVAS"===n.tagName)n=n.parentNode;else{if(n===(null===(i=this._thumbnailElement)||void 0===i?void 0:i.querySelector(".dvs-thumbLists")))return!1;if("LI"!==n.tagName)return null}return n},h.prototype._getPointIndex=function(t){var e,i,n=null===(e=this._thumbnailElement)||void 0===e?void 0:e.querySelector(".dvs-thumbLists");if(!n)return-1;for(var s=n.children,o=0;o<s.length;o++){var r=s[o];if(this._checkPointOnElement(t,r)&&(null===(i=r.classList)||void 0===i||!i.contains("dvs-activeThumb")))return M.getIndexByCallback(r,function(t){var e;return!(null!==(e=t.classList)&&void 0!==e&&e.contains("dvs-activeThumb"))})}return-1},h.prototype.clearAbsolute=function(){var t=this._myQuery("thumbLists"+this.uid);if(!t)return!1;var e=this._myQueryAll("thumbLists"+this.uid+">li.dvs-replaceBlock");this.ifDragMoves=!1,this.isDrag=!1;for(var i=this._myQueryAll("thumbLists"+this.uid+">li.dvs-absolute"),n=0;n<i.length;n++){var s=i[n];M.insertBefore(s,e[n],t),s.classList.remove("dvs-absolute"),s.style.left=null,s.style.top=null}for(var o=0;o<e.length;o++){var r=e[o];t.removeChild(r)}"vertical"===this.scrollDirection?t.style.overflowY="auto":t.style.overflowX="auto"},h.prototype.setPercent=function(t){var e=this._thumbnailElement;e&&(e.style.flex="0 0 "+t+"%",e.style.msFlex="0 0 "+t+"%")},h.prototype.getIndexByUid=function(t){for(var e,i=0;i<this._thumbnailCanvas.length;i++)if(t===(null===(e=this._thumbnailCanvas[i])||void 0===e?void 0:e.uid))return i;return-1},h.prototype.getUidByIndex=function(t){var e;return null===(e=this._thumbnailCanvas[t])||void 0===e?void 0:e.uid},h.prototype._resizeViewer=function(){this._viewerEmit(L.uiEvent.VIEWER_RESIZE)},h.prototype._checkPointOnElement=function(t,e){var i,n;if(!t||!e)return!1;var s,o=-1,r=-1;r=null!==(i=t.changedTouches)&&void 0!==i&&i[0]?(o=(s=null===(n=t.changedTouches)||void 0===n?void 0:n[0]).clientX,s.clientY):(o=t.clientX,t.clientY);var a=e.getBoundingClientRect();return o>=a.left&&r>=a.top&&o<=a.right&&r<=a.bottom},h.prototype._emit=function(t){for(var e,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];(e=this._pubSub).emit.apply(e,s([t],i))},h.prototype._viewerEmit=function(t){for(var e,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];(e=this._viewerPub).emit.apply(e,s([t],i))},h);function h(t,e,i,n,s){this.uid="",this._pubSub=null,this._viewerPub=null,this._viewerContainer=null,this._postfix="",this._thumbnailElement=null,this._dataStore=null,this.isInner=!1,this._size=180,this._mouseShape="pointer",this._scrollDirection="vertical",this._sequence=0,this._location="horizontal",this._showThumbnail=!0,this._showPageNumber=!1,this._showSelectBox=!1,this._showRemoveBtn=!1,this._fullThumbnail=!1,this.allowPageDragging=!0,this._allowResizing=!1,this.allowHover=!0,this.allowKeyboardControl=!0,this.rows=1,this.columns=1,this._background="rgba(67,66,70,1)",this._border="1px solid rgba(27,27,29,1)",this._pageBackground="rgba(0,0,0,0)",this._pageBorder="1px solid rgba(128,128,128,1)",this._selectedPageBackground="rgba(127,133,251,1)",this._selectedPageBorder="1px solid rgba(255,0,0,1)",this.hoverPageBackground="rgba(196,250,248,1)",this.hoverPageBorder="1px solid rgba(255,255,0,1)",this.placeholderBackground="rgba(255,192,203,1)",this._pageMargin=10,this._pageMarginNumber=0,this._currentPageMargin=-1,this.isDrag=!1,this.ifDragMoves=!1,this._dragTimer=null,this._dragStart=!1,this.needClick=!0,this.thumbMoveOption={napX:0,napY:0,clickX:0,clickY:0,target:null},this._showLatestTimer=null,this._stretchItem=null,this._isStretching=!1,this._isCrop=!1,this._topImageIndex=-1,this._calculateTopIndex=-1,this._tempScrollIndex=-1,this._getDisplayTimer=null,this._displayedUrls=[],this._displayedIndexes=[],this._tempThumbnailSize={width:1,height:1},this.selectedIndexes=[],this._thumbnailCanvas=[],this._eventList={},this._viewerPub=e,this._viewerContainer=i,this._postfix=n,this._dataStore=s,this._thumbnailInit(t),this._pubQuery=function(t){var e;return null===(e=null==i?void 0:i.el)||void 0===e?void 0:e.querySelector("#"+t)}}e.ThumbnailItem=l},function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerItem=void 0;var o,r=i(5),a=(o=r.BaseComponent,s(l,o),l);function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.apply(this,t)||this}e.ContainerItem=a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ViewUi=void 0,i(51);var n=i(52);Object.defineProperty(e,"ViewUi",{enumerable:!0,get:function(){return n.ViewUi}}),window.Dynamsoft=window.Dynamsoft||{},window.Dynamsoft.ViewUi=n.ViewUi},function(t,e,i){},function(t,e,i){"use strict";var s=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<i;e++)for(var o=arguments[e],r=0,a=o.length;r<a;r++,s++)n[s]=o[r];return n};Object.defineProperty(e,"__esModule",{value:!0}),e.ViewUi=void 0;var a=i(0),o=i(53),l=i(1),r=i(54),n=(h.prototype._myQuery=function(t){var e,i;return null===(i=null===(e=this._viewerContainer)||void 0===e?void 0:e.el)||void 0===i?void 0:i.querySelector("#"+t)},h.prototype._myQueryAll=function(t){var e,i;return null===(i=null===(e=this._viewerContainer)||void 0===e?void 0:e.el)||void 0===i?void 0:i.querySelectorAll("#"+t)},h.prototype._initViewer=function(t,e){if(!t)return!1;if(a.isString(t))t=document.getElementById(t);else if(!a.isElement(t))return!1;return this.containerBox=t,this._createMember(e,t),this._initMember(),this._initStatus(e),this._bindUiEvent(),this._bindButtonEvent(),!0},h.prototype._createMember=function(t,e){var i=this.postfix,n=this._viewPubsub;this._uiRender=new r.UiRender({postfix:i,container:e,uiConfig:t,pubsub:n});var s=this._uiRender.viewerContainer;this._viewerContainer=s,this._sideRender=new r.SideRender(i,s),this._thumbnailRender=new r.ThumbnailRender(i,n,s,this._dataStore),this._directoryRender=new r.DirectoryRender(i,n,s),this._tagRender=new r.TagRender(i,n,s),this._scrollRender=new r.ScrollRender(i,n,s),this._pagerRender=new r.PagerRender(i,n),this._uiEventControl=new o.UiEventControl(i,n,s),this._tabRender=new r.TabRender(i,n,s),this._canvasRender=new r.CanvasRender({postfix:i,pubsub:n,viewerContainer:s})},h.prototype._destroy=function(){for(var t in this)delete this[t],this[t]=null},h.prototype._initMember=function(){this._sideRender.sidebarInit(),this._directoryRender.treeInit(),this._tagRender.tagInit(),this._scrollRender._addButtonScroll(),this._uiEventControl.uiEventInit(),this._tabRender.tabRenderInit(),this._canvasRender.canvasRenderInit()},h.prototype._initStatus=function(t){this.setViewerWidth(t.width),this.setViewerHeight(t.height),this.setOuterBorder(t.outerBorder),this.setFooterColor(t.footerColor),this.setHeaderColor(t.headerColor),this.setTopMenuColor(t.topMenuColor),this.setTopMenuBorder(t.topMenuBorder),this.setShowMain(t.showMain),this.setSidebarWidth(t.sidebarWidth),this.setShowVideoContainer(t.showVideoContainer),this.setShowTab(t.showTab),this.setCanvasBackground(t.canvasConfig.canvasBackground),this.setCanvasMouseShape(t.canvasConfig.canvasMouseShape),this.setCanvasBorder(t.canvasConfig.canvasBorder),this.setLoadingImage(t.canvasConfig.loadingImageUrl),this._setShowLoadingImage(!1),this.useMyEvent=!t.useOuterDrop},h.prototype.unbindView=function(){var t,e=null===(t=this._viewerContainer)||void 0===t?void 0:t.el;if(!e)return!1;var i=e.parentNode;return i&&(this._unbindStatus(),i.removeChild(e),i=null,this._viewerContainer.el=null),!0},h.prototype.updateUiSetting=function(t){},h.prototype._bindUiEvent=function(){var t,e=((t={})[l.uiEvent.VIEWER_RESIZE]=this._viewerResize,t[l.uiEvent.DOCUMENT_POINTER_MOVE]=this._documentMouseMove,t[l.uiEvent.DOCUMENT_POINTER_UP]=this._documentMouseUp,t[l.uiEvent.DOCUMENT_KEY_DOWN]=this._documentKeyDown,t[l.uiEvent.DOCUMENT_KEY_UP]=this._documentKeyUp,t[l.uiEvent.DOCUMENT_CLICK]=this._documentClick,t[l.uiEvent.VIEWER_CLICK]=this._viewerClick,t[l.uiEvent.VIEWER_RIGHT_CLICK]=this._viewerRightClick,t[l.uiEvent.VIEWER_MOVE]=this._viewerMove,t[l.uiEvent.FILE_DROP]=this._dropFile,t[l.uiEvent.SIDEBAR_CLICK]=this._sideBarClick,t[l.uiEvent.SIDEBAR_STRETCH_START]=this._sidebarStretchStart,t[l.uiEvent.OPEN_DEFAULT_TAG]=this._openDefaultTag,t[l.uiEvent.FILE_LIST_CLICK]=this._fileListClick,t[l.uiEvent.FILE_LIST_RIGHT_CLICK]=this._fileListRightClick,t[l.uiEvent.FILE_KEY_UP]=this._fileListKeyUp,t[l.uiEvent.ADD_NEW_FOLDER]=this._addNewFolder,t[l.uiEvent.TAG_LIST_CLICK]=this._tagListClick,t[l.uiEvent.TAG_LIST_RIGHT_CLICK]=this._tagListRightClick,t[l.uiEvent.TAG_KEY_UP]=this._tagListKeyUp,t[l.uiEvent.ADD_NEW_TAG]=this._addNewTag,t[l.uiEvent.PAGER_BLUR]=this._pagerBlur,t[l.uiEvent.SET_SCROLLER_SIZE]=this._setScrollerSize,t[l.uiEvent.CHANGE_CANVAS_CURSOR]=this.setCanvasCursorTemp,t[l.privateEvent.SHOW_CANVAS_LOADING]=this._setShowLoadingImage,t[l.uiEvent.TAB_CHANGED]=this._tabChanged,t[l.uiEvent.TAB_LIST_CLICK]=this._tabListClick,t[l.uiEvent.CLOSE_SAVE_SETTING_BOX]=this._closeSaveSettingBox,t.onPanelChange=this._togglePaneBox,t.onSetSplitBar=this._setSplitBar,t[l.uiEvent.SHOW_LATEST_PAGE]=this._showLatestPage,t[l.uiEvent.UPDATE_PAGES_LAYOUT]=this._updatePagesLayout,t[l.uiEvent.CUSTOM_BUTTON_CLICK]=this._customButtonClick,t[l.uiEvent.TAG_REFRESH]=this._tagRefresh,t[l.uiEvent.TAG_SELECTED]=this._tagSelectedCallback,t[l.uiEvent.IMAGE_SELECTED]=this._imageSelectedCallback,t[l.uiEvent.FILE_REFRESH]=this._directoryRefresh,t[l.uiEvent.FILE_SELECTED]=this._fileSelectedCallback,t[l.uiEvent.PAGER_CHANGED]=this._pagerRefresh,t[l.uiEvent.THUMBNAIL_CHANGED]=this._thumbnailRefresh,t);for(var i in e)this._viewOn(i,e[i]);this._eventList=e},h.prototype._unbindStatus=function(){for(var t=Object.keys(this._eventList),e=0;e<t.length;e++){var i=t[e];this._viewOff(i)}this._uiEventControl.unbindEvents(),this._tabRender=null,this._tagRender=null,this._directoryRender=null,this._thumbnailRender.removeAllThumbnail(),this._canvasRender.removeAllCanvas(),this._scrollRender.unbindEvents(),this._uiRender.unbindContent()},h.prototype._bindButtonEvent=function(){var o=this,r=this.uiConfig.buttons;Object.keys(r).forEach(function(t){var e,i,n=r[t],s=null===(i=null===(e=o._viewerContainer)||void 0===e?void 0:e.el)||void 0===i?void 0:i.querySelector("#"+t+o.postfix);if(!s)return!1;"loadImage"!==t&&s.classList.add("dvs-iconColor"),n.onButtonClick&&a.addEvent(s,l.originEvent.CLICK,function(t){o._scrollRender.buttonMove?o._scrollRender.buttonMove=!1:t.changedTouches?o._viewEmit(n.onButtonClick,t.changedTouches[0]):o._viewEmit(n.onButtonClick,t)})})},h.prototype._viewOn=function(t,e){this._viewPubsub.on(t,e.bind(this))},h.prototype._viewOff=function(t,e){this._viewPubsub.off(t,e)},h.prototype._viewEmit=function(t){for(var e,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];(e=this._viewPubsub).emit.apply(e,s([t],i))},h.prototype.setShowViewer=function(t){var e,i=null===(e=this._viewerContainer)||void 0===e?void 0:e.el;return this.showViewer=t,!!i&&(this._viewEmit(l.privateEvent.CANVAS_VISIBILITY_CHANGED,this.showViewer&&this.showMain),t?(i.classList.remove("dvs-disabled"),this.styleChange(),this._showLatestPage()):i.classList.add("dvs-disabled"),!0)},h.prototype.setShowTopMenu=function(t){var e=this._myQuery("topMenu"+this.postfix);return this.showTopMenu=t,!!e&&(t?e.classList.remove("dvs-disabled"):e.classList.add("dvs-disabled"),this.styleChange(),!0)},h.prototype.setShowHeader=function(t){var e=this._myQuery("header"+this.postfix);return this.showHeader=t,!!e&&(t?e.classList.remove("dvs-disabled"):e.classList.add("dvs-disabled"),this.styleChange(),!0)},h.prototype.setShowSidebar=function(t){this.showSidebar=t;var e=this._sideRender.setShowSidebar(t);return this.styleChange(),e},h.prototype.setShowAside=function(t){var e=this._myQuery("asideMenu"+this.postfix);return this.showAside=t,!!e&&(t?e.classList.remove("dvs-disabled"):e.classList.add("dvs-disabled"),this.styleChange(),!0)},h.prototype.setShowMain=function(t){var e=this._myQuery("container"+this.postfix);return this.showMain=t,!!e&&(t?e.classList.remove("dvs-disabled"):e.classList.add("dvs-disabled"),this._viewEmit(l.privateEvent.CANVAS_VISIBILITY_CHANGED,this.showMain&&this.showViewer),this.styleChange(),!0)},h.prototype.setShowFooter=function(t){var e=this._myQuery("bottomMenu"+this.postfix);return this.showFooter=t,!!e&&(t?e.classList.remove("dvs-disabled"):e.classList.add("dvs-disabled"),this.styleChange(),!0)},h.prototype.setShowTab=function(t){var e=this._myQuery("tabList"+this.postfix);return this.showTab=t,!!e&&(t?e.classList.remove("dvs-disabled"):e.classList.add("dvs-disabled"),this.styleChange(),!0)},h.prototype.setHeaderColor=function(t){var e=this._myQuery("header"+this.postfix);return this.headerColor=t,e&&(e.style.background=t),!0},h.prototype.setTopMenuColor=function(t){var e=this._myQuery("topMenu"+this.postfix);return this.topMenuColor=t,e&&(e.style.background=t),!0},h.prototype.setTopMenuBorder=function(t){var e=this._myQuery("topMenu"+this.postfix);return this.topMenuBorder=t,e&&(e.style.border=t),this.styleChange(),!0},h.prototype.setFooterColor=function(t){var e=this._myQuery("bottomMenu"+this.postfix);return this.footerColor=t,e&&(e.style.background=t),!0},h.prototype.setAsideMenuColor=function(t){this.asideMenuColor=t;var e=this._myQuery("asideMenu"+this.postfix);return e&&(e.style.background=t),!0},h.prototype.setViewerBorderColor=function(t){var e,i=null===(e=this._viewerContainer)||void 0===e?void 0:e.el,n=this._myQuery("Thumbnail"+this.postfix),s=this._myQuery("content"+this.postfix),o=this._myQuery("middle"+this.postfix);i&&(i.style.borderColor=t),n&&(n.style.borderColor=t),s&&(s.style.borderColor=t),o&&(o.style.borderColor=t),this.viewerBorderColor=t},h.prototype.setOuterBorder=function(t){var e;this.outerBorder=t;var i=null===(e=this._viewerContainer)||void 0===e?void 0:e.el;i&&(i.style.border=t);var n,s=this._myQuery("container"+this.postfix),o=this._myQuery("middle"+this.postfix);s&&o&&(n=t.split(" "),s.style.borderStyle=n[1],s.style.borderColor=n[2],o.style.borderStyle=n[1],o.style.borderColor=n[2],this._setSplitBar()),this.styleChange()},h.prototype.setViewerWidth=function(t){var e,i=null===(e=this._viewerContainer)||void 0===e?void 0:e.el;if(this.width=t,!i)return!1;var n=String(t);return/\d+$/.test(n)&&(t=n+"px"),i.style.width=""+t,this.styleChange(),this._showLatestPage(),!0},h.prototype.getViewerWidth=function(){var t;return null!==(t=this._viewerContainer)&&void 0!==t&&t.el?this.showWidth:this.width},h.prototype.setViewerHeight=function(t){var e,i=null===(e=this._viewerContainer)||void 0===e?void 0:e.el;if(this.height=t,!i)return!1;var n=String(t);return/\d+$/.test(n)&&(t=n+"px"),i.style.height=""+t,this.styleChange(),this._showLatestPage(),!0},h.prototype.getViewerHeight=function(){var t;return null!==(t=this._viewerContainer)&&void 0!==t&&t.el?this.showHeight:this.height},h.prototype.setSidebarWidth=function(t){var e=this._sideRender.setSidebarWidth(t);return this.styleChange(),e},h.prototype.getSidebarWidth=function(){return this._sideRender.getSidebarWidth()},h.prototype.setShowVideoContainer=function(t){var e=this._myQuery("container"+this.postfix);if(!e)return!1;for(var i=e.children,n=0,s=i.length;n<s;n++){var o=i[n];if(null!=o&&o.classList.contains("dvs-customElement"))break;o.classList.contains("dvs-videoContainer")?t?o.classList.remove("dvs-hideVideoContainer"):o.classList.add("dvs-hideVideoContainer"):t?o.classList.add("dvs-hideVideoContainer"):o.classList.remove("dvs-hideVideoContainer")}return(this.showVideoContainer=t)||(this.styleChange(),this._showLatestPage()),!0},h.prototype.switchToTagTab=function(){var t=this._myQuery("TagsNav"+this.postfix),e=t&&t.children[0];return!!e&&(e.click(),!0)},h.prototype.switchToTreeTab=function(){var t=this._myQuery("DirctoryTreeNav"+this.postfix),e=t&&t.children[0];return!!e&&(e.click(),!0)},h.prototype.showGroup=function(t){var e=this._myQuery(t+this.postfix);return!!e&&(e.classList.remove("dvs-disabled"),e.classList.remove("dvs-noDisplay"),!0)},h.prototype.hideGroup=function(t){var e=this._myQuery(t+this.postfix);return!!e&&(e.classList.add("dvs-disabled"),e.classList.add("dvs-noDisplay"),!0)},h.prototype._viewerResize=function(){this.styleChange()},h.prototype._documentMouseMove=function(t){this._cameraRender&&this._cameraRender.mouseMoveCallback(t)},h.prototype._documentMouseUp=function(t){var e;return!(null===(e=this._viewerContainer)||void 0===e||!e.el)&&(!t.button||0===t.button)&&(this._cameraRender&&this._cameraRender.mouseUpCallback(t),void this._sideRender.stretchMouseUp())},h.prototype._documentKeyDown=function(t,e){e?this._thumbnailRender.keydownCallback(t,e):this._viewEmit(l.privateEvent.CANVAS_KEY_DOWN,t)},h.prototype._documentKeyUp=function(t,e){e?this._thumbnailRender.keyupCallback(t,e):this._viewEmit(l.privateEvent.CANVAS_KEY_UP,t)},h.prototype._documentClick=function(t){this._viewEmit(l.privateEvent.UPDATE_FOCUS,{viewerId:void 0,thumbnailId:void 0})},h.prototype.styleChange=function(){var t;if(!this.showViewer)return!1;this.uiConfig.buttonResize.ifResize&&(a.isMobile()?(null===(t=this._viewerContainer)||void 0===t?void 0:t.el).classList.add("DWT_imageEditor"):this.changeButtonSize());var e=this._myQuery("topMenu"+this.postfix),i=this._myQuery("topMenuRight"+this.postfix);i&&(e.style.paddingRight=(i.getBoundingClientRect().width||0)+"px"),this._thumbnailRender.calculateSize(),this._thumbnailRender.updateAllDisplayed(),this.updateVideoSize(),this._scrollRender.updateAllGroupShowMore(),this._canvasRender.updateCanvasInnerSize(),this._sendViewSize()},h.prototype._viewerClick=function(t){},h.prototype._viewerRightClick=function(t){},h.prototype._viewerMove=function(t){this._sideRender.stretchMouseMove(t)},h.prototype._dropFile=function(t){if(!this.useMyEvent)return!1;for(var e=t.dataTransfer.files,i=[],n=0;n<e.length;n++){var s,o=e[n];/^image\/(?!tiff)/.test(o.type)&&(s={oriData:URL.createObjectURL(o),minData:null,metadata:{width:500,height:600},tags:[]},i.push(s))}this._viewEmit(l.privateEvent.APPEND_SYNC_DROP,i)},h.prototype._sendViewSize=function(){var t,e=null===(t=this._viewerContainer)||void 0===t?void 0:t.el;if(!e)return!1;var i=e.getBoundingClientRect();if(0===i.width||0===i.height||i.width===this.showWidth&&i.height===this.showHeight)return!1;this.showWidth=i.width,this.showHeight=i.height,this._viewEmit(l.viewerEvent.RESIZE,i.width,i.height)},h.prototype.createThumbnail=function(t){return this._thumbnailRender.createThumbnail(t)},h.prototype.createInnerThumbnail=function(){this._thumbnailRender.createInnerThumbnail(this.uiConfig.canvasConfig)},h.prototype.removeThumbnail=function(t){var e=this._thumbnailRender.removeThumbnail(t);return this._setSplitBar(),e},h.prototype._sideBarClick=function(t){this._sideRender.setShowNavigationBox(!1)},h.prototype._sidebarStretchStart=function(t){this._sideRender.stretchMouseDown(t)},h.prototype._openDefaultTag=function(){this._viewEmit("_onOpenAll"),this._myQuery("defaultTag"+this.postfix).classList.add("dvs-activeAllImage"),this._tagRender.selectTagByName(""),this._directoryRender.selectFileByName("")},h.prototype._fileListClick=function(t){this._directoryRender.confirmFolder(t),this._directoryRender.cancelFolder(t),this._directoryRender.enterFolder(t)},h.prototype._fileListRightClick=function(t){},h.prototype._fileListKeyUp=function(t){var e,i;13===t.keyCode?(e=t.target.nextSibling.children[0])&&e.click():27!==t.keyCode||(i=t.target.nextSibling.children[1])&&i.click()},h.prototype._addNewFolder=function(t){this._directoryRender.addNewFolder(t)},h.prototype._tagListClick=function(t){var e=t.target;if(!e)return!1;e.classList.contains("confirmTag")||e.classList.contains("renameConfirmTag")?this._tagRender.confirmTag(e):e.classList.contains("cancelTag")?this._tagRender.cancelTag(e):e.classList.contains("dvs-quickEdit")?this._tagRender.quickRenameTag(e):e.classList.contains("dvs-quickDel")?this._tagRender.quickDelTag(e):this._tagRender.showTagContent(t)},h.prototype._tagListRightClick=function(t){},h.prototype._tagListKeyUp=function(t){var e,i;13===t.keyCode?(e=t.target.nextSibling.children[0])&&e.click():27!==t.keyCode||(i=t.target.nextSibling.children[1])&&i.click()},h.prototype._addNewTag=function(t){this._tagRender.addNewTag(t)},h.prototype._pagerBlur=function(t){this._pagerRender.pageBlur(t)},h.prototype.setCanvasBackground=function(t){var e;this.canvasBackground=t;var i=this._myQuery("mainCanvas"+this.postfix);i&&(i.style.background="",setTimeout(function(){i.style.background=t})),this._thumbnailRender.innerThumbnail&&(this._thumbnailRender.innerThumbnail.background=t);var n=null===(e=this._viewerContainer.el)||void 0===e?void 0:e.querySelector(".dvs-slideWrapper");n&&(n.style.background=t)},h.prototype.setCanvasBorder=function(t){this.canvasBorder=t;var e=this._myQuery("viewPort"+this.postfix);e&&(e.style.border=t),this._thumbnailRender.innerThumbnail&&(this._thumbnailRender.innerThumbnail.border=t),this.styleChange()},h.prototype.setCanvasMouseShape=function(t,e){void 0===e&&(e=!1),e||(this.canvasMouseShape=t,this._viewEmit(l.privateEvent.CANVAS_DEFAULT_CURSOR,t));var i=this._myQuery("canvasWrapper"+this.postfix);i&&(i.style.cursor=t),this._thumbnailRender.innerThumbnail&&(this._thumbnailRender.innerThumbnail.mouseShape=t)},h.prototype.setCanvasCursorTemp=function(t){t?this.setCanvasMouseShape(t,!0):this.setCanvasMouseShape(this.canvasMouseShape,!0)},h.prototype.setCanvasPageBackground=function(t){this._thumbnailRender.innerThumbnail.pageBackground=t},h.prototype.setCanvasPageBorder=function(t){this._thumbnailRender.innerThumbnail.pageBorder=t},h.prototype.setCanvasPageMargin=function(t){this._thumbnailRender.innerThumbnail.pageMargin=t},h.prototype.setCanvasSelectedPageBackground=function(t){this._thumbnailRender.innerThumbnail.selectedPageBackground=t},h.prototype.setCanvasSelectedPageBorder=function(t){this._thumbnailRender.innerThumbnail.selectedPageBorder=t},h.prototype.setCanvasHoverPageBorder=function(t){this._thumbnailRender.innerThumbnail.hoverPageBorder=t},h.prototype.setCanvasHoverPageBackground=function(t){this._thumbnailRender.innerThumbnail.hoverPageBackground=t},h.prototype.setCanvasPlaceholderBackground=function(t){this._thumbnailRender.innerThumbnail.placeholderBackground=t},h.prototype.setCanvasShowPageNumber=function(t){this._thumbnailRender.innerThumbnail.showPageNumber=t},h.prototype.setCanvasAllowPageDragging=function(t){this._thumbnailRender.innerThumbnail.allowPageDragging=t},h.prototype.setCanvasAllowKeyboardControl=function(t){this._thumbnailRender.innerThumbnail.allowKeyboardControl=t},h.prototype.setScrollDirection=function(t){this._thumbnailRender.innerThumbnail.scrollDirection=t},h.prototype.setSelectedBoxLineColor=function(t){this._thumbnailRender.innerThumbnail.setSelectedBoxLineColor(t)},h.prototype.setOperationMode=function(t){this._thumbnailRender.innerThumbnail.setOperationMode(t)},h.prototype.setSelectedBoxes=function(t,e){this._thumbnailRender.innerThumbnail.setSelectedBoxes(t,e)},h.prototype.clearSelectedBoxes=function(t){this._thumbnailRender.innerThumbnail.clearSelectedBoxes(t)},h.prototype.setKeepAspectRatio=function(t){this._thumbnailRender.innerThumbnail.setKeepAspectRatio(t)},h.prototype.setAspectRatio=function(t){this._thumbnailRender.innerThumbnail.setAspectRatio(t)},h.prototype._setScrollerSize=function(t){this._canvasRender.updateScrollSize(t)},h.prototype._tabChanged=function(t){this._tabRender.updateTabList(t)},h.prototype._tabListClick=function(t){var e=t.target;null!=e&&e.classList.contains("dvs-closeTab")&&(null==e||e["dvs-id"])},h.prototype._tagRefresh=function(t){this._tagRender.updateTagList(t)},h.prototype._tagSelectedCallback=function(t){this._tagRender.selectTagByName(t)},h.prototype._imageSelectedCallback=function(t){return this._thumbnailRender.updateSelectedIndexes(t)},h.prototype._directoryRefresh=function(t){if(!this._myQuery("treeLists"+this.postfix))return!1;this._directoryRender.updateDirectory(t);var e=this._myQuery("addFolder"+this.postfix);e&&e.style&&(e.style.pointerEvents="auto")},h.prototype._fileSelectedCallback=function(t){this._directoryRender.selectFileByName(t)},h.prototype._pagerRefresh=function(t){var e=t.currentPage,i=t.totalPages,n=this._pagerRender.getCurrentPage();this._thumbnailRender.pageChangeCallback(n,e,i),this._pagerRender.updatePage(t)},h.prototype._thumbnailRefresh=function(t){this._thumbnailRender.updateContents(t)},h.prototype.setDisplayMode=function(t){var e,i,n=this._myQuery("viewPort"+this.postfix);if("single"===t)this._thumbnailRender.innerThumbnail.clearRects(),this._thumbnailRender.innerThumbnail.showThumbnail=!1,null!=n&&n.classList.remove("dvs-disabled"),null!==(e=this._myQuery("innerThumbnail"+this.postfix))&&void 0!==e&&e.classList.add("dvs-disabled");else{if("continuous"!==t)return!1;null!=n&&n.classList.add("dvs-disabled"),null!==(i=this._myQuery("innerThumbnail"+this.postfix))&&void 0!==i&&i.classList.remove("dvs-disabled"),this._thumbnailRender.innerThumbnail.showThumbnail=!0}return this.styleChange(),!0},h.prototype.setViewMode=function(t,e){return this._thumbnailRender.innerThumbnail.setViewMode(t,e)},h.prototype._togglePaneBox=function(){var t=this._sideRender.getShowNavigation();this._sideRender.setShowNavigationBox(!t)},h.prototype._customButtonClick=function(t,e){this._scrollRender.buttonMove?this._scrollRender.buttonMove=!1:this._viewEmit(t,e)},h.prototype._closeSaveSettingBox=function(){},h.prototype._setSplitBar=function(){var t,e=this._myQuery("container"+this.postfix),i=this._myQuery("middle"+this.postfix);if(!e||!i)return!1;var n,s,o,r,a=Object.keys(this._thumbnailRender._thumbnails),l=this._thumbnailRender._thumbnails[a[0]];!l||null==l||!l.showThumbnail||null!=l&&l.fullThumbnail||null!==(t=this._cameraRender)&&void 0!==t&&t.isVideoShow?(e.style.borderWidth="0px",i.style.borderWidth="0px"):(n=this.outerBorder.split(" ")[0],s="horizontal"===l.location,o=l.sequence,r=this._getBorderWidth(n,s,o),s?(e.style.borderWidth=r,i.style.borderWidth="0px"):(i.style.borderWidth=r,e.style.borderWidth="0px")),this.styleChange()},h.prototype._getBorderWidth=function(t,e,i){var n="";return n+=!e&&i<0?t:"0px",n+=" ",n+=e&&0<=i?t:"0px",n+=" ",n+=!e&&0<=i?t:"0px",n+=" ",n+=e&&i<0?t:"0px"},h.prototype._updatePagesLayout=function(){this._thumbnailRender.updatePagesLayout()},h.prototype._showLatestPage=function(){this._thumbnailRender.showLatestPage()},h.prototype.setButtonClass=function(t){var e=this.uiConfig.buttons,i=this._myQuery(""+t+this.postfix);if(i){var n=e[t].iconClass?" "+e[t].iconClass:"",s=e[t].setClass?" "+e[t].setClass:"",o=i.classList.contains("dvs-disabled")?" dvs-disabled":"";return i.className="ds-dvs-ui-iconfont dvs-iconColor"+o+n+s,!0}return!1},h.prototype.setGroupClass=function(t,e){var i=this.uiConfig.groups,n=this._myQuery(t+this.postfix);if(n){var s=i[t].cssStyle?" "+i[t].cssStyle:"",o=n.classList.contains("dvs-disabled")?" dvs-disabled":"";return n.className="dvs-"+t+" dvs-groupType"+o+s+" "+e,!0}return!1},h.prototype.changeButtonSize=function(){var t,e=null===(t=this._viewerContainer)||void 0===t?void 0:t.el;if(!e)return!1;e.classList.add("dvs-buttonResize");for(var i=e.clientWidth,n=e.clientHeight,s=36*(i/1920<n/1080?i/1920:n/1080)*window.devicePixelRatio,o=this._myQueryAll("topMenu"+this.postfix+">div:not(.dvs-pager)>div"),r=this._myQueryAll("bottomMenu"+this.postfix+">div>div"),a=this.uiConfig.buttonResize.maxSize,l=this.uiConfig.buttonResize.minSize,s=Math.floor(a<s?a:s<l?l:s),h=Math.floor(s/2*3),u=Math.floor(h/4*5),d=[o,r],c=0;c<d.length;c++)for(var p=d[c],v=0;v<p.length;v++){var _=p[v];_.classList.contains("dvs-emptyBtn")?(_.style.width=s+"px",_.style.height=s+"px",_.style.flexBasis=s+"px"):(_.style.fontSize=s+"px",_.style.width=h+"px",_.style.height=h+"px",_.style.flexBasis=h+"px")}this._myQuery("topMenu"+this.postfix).style.flexBasis=u+"px",this._myQuery("topMenu"+this.postfix).style.height=u+"px",this._myQuery("bottomMenu"+this.postfix).style.flexBasis=u+"px",this._myQuery("bottomMenu"+this.postfix).style.height=u+"px",this._myQuery("bottomMenu"+this.postfix).style.justifyContent="flex-start"},h.prototype.fullScreen=function(){var t,e=null===(t=this._viewerContainer)||void 0===t?void 0:t.el,i=a.launchFullscreen(e);return this.styleChange(),i},h.prototype.cancelFullScreen=function(){var t=a.isFullscreen()&&a.exitFullscreen();return this.styleChange(),t},h.prototype.fullPage=function(){var t,e=null===(t=this._viewerContainer)||void 0===t?void 0:t.el;return!!e&&(e.classList.add("fitPage"),this.cancelFullScreen(),this.styleChange(),!0)},h.prototype.cancelFullPage=function(){var t,e=null===(t=this._viewerContainer)||void 0===t?void 0:t.el;return!!e&&(e.classList.remove("fitPage"),this.cancelFullScreen(),this.styleChange(),!0)},h.prototype.createCustomElement=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=!1),this._uiRender.createCustomElement(t,e,i)},h.prototype.updateVideoSize=function(){if(this._videoSize&&this.showVideoContainer){var t=this._myQuery("videoContainer"+this.postfix),e=this._myQuery("videoImage"+this.postfix);if(!t||!e)return!1;var i,n=t.clientWidth,s=t.clientHeight,o=this._videoSize,r=o.imageWidth,a=o.imageHeight;n/r-1<s/a-1?(i=n/r,e.style.width=n+"px",e.style.height=a*i+"px"):(i=s/a,e.style.width=r*i+"px",e.style.height=s+"px"),this._videoSize.imageBoxWidth=e.clientWidth,this._videoSize.imageBoxHeight=e.clientHeight}},h.prototype.updateVideoContainer=function(t){var e=this;return this._videoImageReady?this._updateVideoImage(t):(clearTimeout(this._updateVideoTimer),this._updateVideoTimer=setTimeout(function(){e._updateVideoImage(t)},200),!0)},h.prototype._updateVideoImage=function(t){var e=this,i=this._myQuery("videoImage"+this.postfix);if(!i)return!1;i.src=t,clearTimeout(this._updateVideoTimer),this._videoImageReady=!1,i.onload=function(){e._videoImageReady=!0,i.style.display="",e._videoSize&&e._videoSize.imageWidth===i.naturalWidth&&e._videoSize.imageHeight===i.naturalHeight&&e._videoSize.imageBoxWidth===i.clientWidth&&e._videoSize.imageBoxHeight===i.clientHeight||(e._videoSize={imageWidth:i.naturalWidth,imageHeight:i.naturalHeight,imageBoxWidth:i.clientWidth,imageBoxHeight:i.clientHeight},e.updateVideoSize())},i.onerror=function(){e._videoImageReady=!0,i.style.display="none",i.onload=null}},h.prototype.getViewerElement=function(){var t;return(null===(t=this._viewerContainer)||void 0===t?void 0:t.el)||null},h.prototype.bindContent=function(t){return this._uiRender.bindContent(t)},h.prototype.unbindContent=function(){return this._uiRender.unbindContent()},h.prototype.setLoadingImage=function(t){if(!t)return!1;var e=this._myQuery("loadingImage"+this.postfix);return e&&(e.src=t),!0},h.prototype._setShowLoadingImage=function(t){var e=this._myQuery("loadingLayer"+this.postfix);e&&(t?e.classList.remove("dvs-disabled"):e.classList.add("dvs-disabled"))},h.prototype.bindCamera=function(t){try{return this._cameraRender=new r.CameraRender(t,{pubsub:this._viewPubsub,viewerContainer:this._viewerContainer,postfix:this.postfix}),this._initCameraEvents(),this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.OK),!0}catch(t){return this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.CAMERA_CLASS_INVALID),!1}},h.prototype.showVideo=function(t,e,i,n){if(!this._cameraRender)return this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.CAMERA_CLASS_REQUIRE),Promise.reject(l.errorMessages.CAMERA_CLASS_REQUIRE);if(this._cameraRender.isVideoShow)return Promise.reject(l.errorMessages.CAMERA_EXIST);var s=document.createElement("div");return s.id="cameraContainer"+this.postfix,s.className="dvs-cameraContainer",this._webcamItem=this.createCustomElement(s,0,!0),this._webcamItem.hide(),this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.OK),this._cameraRender.showVideo(this._webcamItem,t,e,i,n)},h.prototype.closeVideo=function(){return this._cameraRender?this._cameraRender.isVideoShow?(this._webcamItem&&this._webcamItem.dispose(),this._cameraRender.closeVideo(),this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.OK),!0):(this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.CAMERA_NOT_EXIST),!1):(this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.CAMERA_CLASS_REQUIRE),!1)},h.prototype._initCameraEvents=function(){var e=this,t=this._cameraRender,i={onExitCamera:function(){e.closeVideo()},onCapture:function(){t.captureCallback()},onDetect:function(){t.detectCallback()},onRemake:function(){t.remakeCallback()},onPerspective:function(){t.perspectiveCallback()},onBack:function(){t.backCallback()},onConfirm:function(){t.confirmCallback()},webcamResize:function(){t.drawSelectedArea()},"video-error":function(t){e._viewEmit("video-error",t)}};for(var n in i)t.webcamOn(n,i[n])},h.prototype.bindAreaDetectFunction=function(t){return this._cameraRender?(this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.OK),this._cameraRender.bindAreaDetectFunction(t)):(this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.CAMERA_CLASS_REQUIRE),!1)},h.prototype.bindPerspectiveFunction=function(t){return this._cameraRender?(this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.OK),this._cameraRender.bindPerspectiveFunction(t)):(this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.CAMERA_CLASS_REQUIRE),!1)},h.prototype.bindLicenseCallback=function(t){return a.isFunction(t)?(this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.OK),!0):(this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.PARAMETER_TYPE),!1)},h.prototype.bindSavePhotoCallback=function(t){return this._cameraRender?(this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.OK),this._cameraRender.bindSavePhotoCallback(t)):(this._viewEmit(l.privateEvent.UPDATE_ERROR_MESSAGE,l.errorMessages.CAMERA_CLASS_REQUIRE),!1)},h);function h(t,e,i,n,s){this._viewPubsub=null,this._dataStore=null,this._sideRender=null,this._thumbnailRender=null,this._directoryRender=null,this._tagRender=null,this._scrollRender=null,this._contextMenuRender=null,this._pagerRender=null,this._tabRender=null,this._canvasRender=null,this._cameraRender=null,this._uiRender=null,this._uiEventControl=null,this.uiConfig={},this._viewerContainer=null,this.containerBox=null,this.fullThumbnail=!1,this.useMyEvent=!0,this.topMenuColor="#3a393b",this.topMenuBorder="1px solid #1b1b1d",this.headerColor="#2a292b",this.footerColor="#434246",this.asideMenuColor="#434246",this.viewerBorderColor="#1b1b1d",this.canvasBackground="#434246",this.canvasBorder="0px solid #1b1b1d",this.canvasMouseShape="default",this.outerBorder="1px solid #1b1b1d",this._webcamItem=null,this._licenseCallback=null,this._videoImageReady=!0,this._updateVideoTimer=null,this.showViewer=!0,this.showTopMenu=!0,this.showHeader=!0,this.showSidebar=!1,this.showTab=!1,this.showAside=!1,this.showMain=!0,this.showFooter=!0,this.showVideoContainer=!1,this.width="100%",this.height="100%",this.showWidth=-1,this.showHeight=-1,this.mouseShape="default",this._eventList={},this.postfix=i,this._viewPubsub=n,this.uiConfig=e,this._dataStore=s,this._initViewer(t,e)}e.ViewUi=n},function(t,e,i){"use strict";var s=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<i;e++)for(var o=arguments[e],r=0,a=o.length;r<a;r++,s++)n[s]=o[r];return n},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.UiEventControl=void 0;var h=i(0),u=i(1),d=n(i(12)),o=(r.prototype.uiEventInit=function(){var e=this,i=function(t){var e,i,n="#"+t+this.postfix;return null===(i=null===(e=this._viewerContainer)||void 0===e?void 0:e.el)||void 0===i?void 0:i.querySelector(n)}.bind(this),t=u.originEvent.CLICK,n=(u.originEvent.MOUSE_DOWN,u.originEvent.MOUSE_MOVE),s=u.originEvent.MOUSE_UP;"ontouchend"in document.documentElement&&(u.originEvent.TOUCH_START,n=u.originEvent.TOUCH_MOVE,s=u.originEvent.TOUCH_END);var o=this._unbindList;o.push(h.addEvent(window,u.originEvent.RESIZE,h.throttleStable.call(this,this._viewerResize,40))),o.push(h.addEvent(window,"load",function(t){e._viewerResize(t)})),o.push(h.addEvent(document,n,function(t){e._documentMouseMove(t)})),o.push(h.addEvent(document,s,function(t){e._documentMouseUp(t)})),o.push(h.addEvent(document,u.originEvent.CLICK,function(t){e._documentClick(t)}));var r=this._viewerContainer.el;h.addEvent(r,"dragstart",function(){return!1}),h.addEvent(r,t,function(t){e._viewerClick(t)}),h.addEvent(r,u.originEvent.CONTEXTMENU,function(t){e._viewerRightClick(t)}),h.addEvent(r,n,function(t){e._viewerMove(t)}),h.addEvent(r,"dragover",function(t){h.preventDefault(t)}),h.addEvent(r,"drop",function(t){e._dropFile(t)}),h.addEvent(i("navChange"),t,function(t){e._setSelectedSidetype(t)}),h.addEvent(i("besides"),t,function(t){e._sidebarClick(t)}),h.addEvent(i("stretchBar"),u.originEvent.MOUSE_DOWN,function(t){e._sidebarStretchStart(t)}),h.addEvent(i("defaultTag"),t,function(){e._openDefaultTag()}),h.addEvent(i("treeLists"),t,function(t){e._fileListClick(t)}),h.addEvent(i("treeLists"),u.originEvent.CONTEXTMENU,function(t){e._fileListRightClick(t)}),h.addEvent(i("treeLists"),"keyup",function(t){e._fileListKeyUp(t)}),h.addEvent(i("addFolder"),u.originEvent.CLICK,function(t){e._addNewFolder(t)}),h.addEvent(i("tagLists"),t,function(t){e._tagListClick(t)}),h.addEvent(i("tagLists"),u.originEvent.CONTEXTMENU,function(t){e._tagListRightClick(t)}),h.addEvent(i("tagLists"),"keyup",function(t){e._tagListKeyUp(t)}),h.addEvent(i("addTag"),t,function(t){e._addNewTag(t)});var a=i("canvasEventLayer");h.addEvent(a,"touchstart",function(t){e._canvasTouchStart(t)}),h.addEvent(a,"mousedown",function(t){e._canvasMouseDown(t)}),h.addEvent(a,"touchmove",function(t){e._canvasTouchMove(t)}),h.addEvent(a,"mousemove",function(t){e._canvasMouseMove(t)}),h.addEvent(a,"touchend",function(t){e._canvasTouchEnd(t)}),h.addEvent(a,"mouseup",function(t){e._canvasMouseUp(t)}),h.addEvent(a,"wheel",function(t){e._canvasWheel(t)}),h.addEvent(a,"click",function(t){h.stopBubble(t)});var l=new d.default(i("canvasEventLayer"));l.onClick=function(t){e.emit(u.privateEvent.CANVAS_CLICK,t)},l.onRightClick=function(t){e.emit(u.privateEvent.CANVAS_RIGHT_CLICK,t)},l.onDoubleClick=function(t){e.emit(u.privateEvent.CANVAS_DOUBLE_CLICK,t)},l.onPointOver=function(t){e.emit(u.privateEvent.CANVAS_MOUSE_OVER,t)},l.onPointOut=function(t){e.emit(u.privateEvent.CANVAS_MOUSE_OUT,t)},l=null,h.addEvent(i("canvasScroll"),"scroll",function(t){e._canvasScroll(t)}),h.addEvent(i("canvasWrapper"),"scroll",function(){var t=i("canvasWrapper");t.scrollTop=0,t.scrollLeft=0}),h.addEvent(i("tabList"),t,function(t){e._tabListClick(t)}),h.addEvent(i("pageInput"),"blur",function(t){e._pagerBlur(t)}),h.addEvent(i("pageInput"),"keyup",function(t){13===t.keyCode&&t.target.blur()}),h.addEvent(i("cancelSaveBtn"),t,function(){e._closeSaveSettingBox()})},r.prototype.unbindEvents=function(){this._unbindList.forEach(function(t){h.isFunction(t)&&t()}),this._unbindList=[]},r.prototype.emit=function(t){for(var e,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];(e=this._pubSub).emit.apply(e,s([t],i))},r.prototype._viewerResize=function(t){this.emit(u.uiEvent.VIEWER_RESIZE,t)},r.prototype._documentMouseUp=function(t){this.emit(u.uiEvent.DOCUMENT_POINTER_UP,t),this.emit(u.privateEvent.DOCUMENT_UP,t),this.emit(u.viewerEvent.DOCUMENT_POINTER_UP,t)},r.prototype._documentMouseMove=function(t){this.emit(u.uiEvent.DOCUMENT_POINTER_MOVE,t),this.emit(u.privateEvent.DOCUMENT_MOVE,t),this.emit(u.viewerEvent.DOCUMENT_POINTER_MOVE,t)},r.prototype._documentClick=function(t){this.emit(u.uiEvent.DOCUMENT_CLICK,t),this.emit(u.viewerEvent.DOCUMENT_CLICK,t)},r.prototype._viewerClick=function(t){this.emit(u.uiEvent.VIEWER_CLICK,t)},r.prototype._viewerRightClick=function(t){h.preventDefault(t),this.emit(u.uiEvent.VIEWER_RIGHT_CLICK,t)},r.prototype._viewerMove=function(t){this.emit(u.uiEvent.VIEWER_MOVE,t)},r.prototype._dropFile=function(t){h.preventDefault(t),this.emit(u.uiEvent.FILE_DROP,t),this.emit(u.viewerEvent.FILE_DROP,t)},r.prototype._setSelectedSidetype=function(t){},r.prototype._sidebarClick=function(t){h.stopBubble(t),this.emit(u.uiEvent.SIDEBAR_CLICK),this.emit(u.viewerEvent.SIDEBAR_CLICK)},r.prototype._sidebarStretchStart=function(t){this.emit(u.uiEvent.SIDEBAR_STRETCH_START,t)},r.prototype._openDefaultTag=function(){this.emit(u.uiEvent.OPEN_DEFAULT_TAG)},r.prototype._fileListClick=function(t){this.emit(u.uiEvent.FILE_LIST_CLICK,t),this.emit(u.viewerEvent.FILE_LIST_CLICK,t)},r.prototype._fileListRightClick=function(t){this.emit(u.uiEvent.FILE_LIST_RIGHT_CLICK,t),this.emit(u.viewerEvent.FILE_LIST_RIGHT_CLICK,t)},r.prototype._fileListKeyUp=function(t){this.emit(u.uiEvent.FILE_KEY_UP,t),this.emit(u.viewerEvent.FILE_KEY_UP,t)},r.prototype._addNewFolder=function(t){this.emit(u.uiEvent.ADD_NEW_FOLDER,t)},r.prototype._tagListClick=function(t){this.emit(u.uiEvent.TAG_LIST_CLICK,t),this.emit(u.viewerEvent.TAG_LIST_CLICK,t)},r.prototype._tagListRightClick=function(t){this.emit(u.uiEvent.TAG_LIST_RIGHT_CLICK,t),this.emit(u.viewerEvent.TAG_LIST_RIGHT_CLICK,t)},r.prototype._tagListKeyUp=function(t){this.emit(u.uiEvent.TAG_KEY_UP,t),this.emit(u.viewerEvent.TAG_KEY_UP,t)},r.prototype._addNewTag=function(t){this.emit(u.uiEvent.ADD_NEW_TAG,t)},r.prototype._canvasTouchStart=function(t){this.emit(u.privateEvent.CANVAS_TOUCH_START,t)},r.prototype._canvasTouchMove=function(t){this.emit(u.privateEvent.CANVAS_TOUCH_MOVE,t)},r.prototype._canvasTouchEnd=function(t){this.emit(u.privateEvent.CANVAS_TOUCH_END,t)},r.prototype._canvasMouseDown=function(t){this.emit(u.privateEvent.CANVAS_MOUSE_DOWN,t)},r.prototype._canvasMouseMove=function(t){this.emit(u.privateEvent.CANVAS_MOUSE_MOVE,t)},r.prototype._canvasMouseUp=function(t){this.emit(u.privateEvent.CANVAS_MOUSE_UP,t)},r.prototype._canvasWheel=function(t){this.emit(u.privateEvent.CANVAS_WHEEL,t),h.preventDefault(t)},r.prototype._canvasScroll=function(t){this.emit(u.privateEvent.CANVAS_SCROLL,t)},r.prototype._tabListClick=function(t){this.emit(u.uiEvent.TAB_LIST_CLICK,t)},r.prototype._pagerBlur=function(t){this.emit(u.uiEvent.PAGER_BLUR,t)},r.prototype._closeSaveSettingBox=function(){this.emit(u.uiEvent.CLOSE_SAVE_SETTING_BOX)},r);function r(t,e,i){this.useMyEvent=!0,this._hasDocumentEvent=!1,this._unbindList=[],this._viewerContainer=null,this._pubSub=e,this.postfix=t,this._viewerContainer=i}e.UiEventControl=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CameraRender=e.UiRender=e.CanvasRender=e.TabRender=e.PagerRender=e.ContextMenuRender=e.ScrollRender=e.TagRender=e.DirectoryRender=e.ThumbnailRender=e.SideRender=void 0;var n=i(55);Object.defineProperty(e,"SideRender",{enumerable:!0,get:function(){return n.SideRender}});var s=i(56);Object.defineProperty(e,"ThumbnailRender",{enumerable:!0,get:function(){return s.ThumbnailRender}});var o=i(59);Object.defineProperty(e,"DirectoryRender",{enumerable:!0,get:function(){return o.DirectoryRender}});var r=i(61);Object.defineProperty(e,"TagRender",{enumerable:!0,get:function(){return r.TagRender}});var a=i(62);Object.defineProperty(e,"ScrollRender",{enumerable:!0,get:function(){return a.ScrollRender}});var l=i(63);Object.defineProperty(e,"ContextMenuRender",{enumerable:!0,get:function(){return l.ContextMenuRender}});var h=i(64);Object.defineProperty(e,"PagerRender",{enumerable:!0,get:function(){return h.PagerRender}});var u=i(65);Object.defineProperty(e,"TabRender",{enumerable:!0,get:function(){return u.TabRender}});var d=i(67);Object.defineProperty(e,"CanvasRender",{enumerable:!0,get:function(){return d.CanvasRender}});var c=i(68);Object.defineProperty(e,"UiRender",{enumerable:!0,get:function(){return c.UiRender}});var p=i(74);Object.defineProperty(e,"CameraRender",{enumerable:!0,get:function(){return p.CameraRender}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SideRender=void 0;var n,s,o=i(0);(s=n=n||{}).TAG="tag",s.TREE="tree";var r=(a.prototype._initVisible=function(){var t=this._myQuery("navChange"+this._postfix);if(!t)return!1;for(var e=t.children,i=e.length-1;0<=i;i--){var n,s=e[i];s&&(n=s.getAttribute("sidetype"),s.classList.contains("dvs-disabled")?this._visibleList[n]=!1:(this._visibleList[n]=!0,this._sideType=n))}this.setSelectedNavAndPane(this._sideType)},a.prototype.sidebarInit=function(){this._initVisible(),this.setSidebarWidth(this._sidebarWidth)},a.prototype.setShowNavigationBox=function(t){var e,i,n=this._myQuery("navigationPane"+this._postfix);return!!n&&(null!==(i=null===(e=null==n?void 0:n.classList)||void 0===e?void 0:e[t?"remove":"add"])&&void 0!==i&&i.call(e,"dvs-nodisplay"),this._showNavigation=t,!0)},a.prototype.setShowSelectorBox=function(t){var e=this._myQuery("paneSelector"+this._postfix),i=this._myQuery("isShowPane"+this._postfix);if(!e||!i)return!1;t?e.classList.remove("dvs-nodisplay"):e.classList.add("dvs-nodisplay"),i.children[0].className="ds-dvs-ui-iconfont "+(t?"ds-dvs-ui-selected":"ds-dvs-ui-mutiple")},a.prototype.setShowSelector=function(t,e){var i=this._myQuery("paneSelector"+this._postfix);if(!i)return!1;for(var n=i.children,s=0;s<n.length;s++)n[s].getAttribute("sidetype")===t&&((n[s]&&n[s].children[0]).className="ds-dvs-ui-iconfont "+(e?"ds-dvs-ui-selected":"ds-dvs-ui-mutiple"));return!0},a.prototype.setShowNavAndPane=function(t,e){var i=this._myQuery("navChange"+this._postfix),n=this._myQuery("paneShow"+this._postfix);if(!i||!n)return!1;for(var s=i.children,o=0;o<s.length;o++){var r=s[o];r&&r.getAttribute("sidetype")==t&&(e?r.classList.remove("dvs-disabled"):r.classList.add("dvs-disabled"))}for(var a=n.children,o=0;o<a.length;o++){var l=a[o];l&&l.getAttribute("sidetype")==t&&(e?l.classList.remove("dvs-disabled"):l.classList.add("dvs-disabled"))}return this._visibleList[t]=e,this._ifHideSidebar(),!0},a.prototype.setSelectedNavAndPane=function(t){if(!this._visibleList[t])return!1;var e=this._myQuery("navChange"+this._postfix),i=this._myQuery("paneShow"+this._postfix);if(!e||!i)return!1;for(var n=e.children,s=0;s<n.length;s++){var o=n[s];o&&(o.getAttribute("sidetype")==t?o.classList.add("activeTab"):o.classList.remove("activeTab"))}for(var r=i.children,s=0;s<r.length;s++){var a=r[s];a&&(a.getAttribute("sidetype")==t?a.classList.remove("dvs-nodisplay"):a.classList.add("dvs-nodisplay"))}return this._sideType=t,!0},a.prototype.setShowSidebar=function(t){this._showSidebar=t;var e=this._myQuery("sidebar"+this._postfix);return!!e&&(t?e.classList.remove("dvs-disabled"):e.classList.add("dvs-disabled"),!0)},a.prototype._ifHideSidebar=function(){for(var t in this._visibleList)if(this._visibleList[t])return this.setHiddenSidebar(!0),!0;return this.setHiddenSidebar(!1),!1},a.prototype.setHiddenSidebar=function(t){var e=this._myQuery("sidebar"+this._postfix);return!!e&&(t?e.classList.remove("dvs-nodisplay"):e.classList.add("dvs-nodisplay"),!0)},a.prototype.getTypeVisible=function(t){return void 0!==this._visibleList[t]&&this._visibleList[t]},a.prototype.getShowNavigation=function(){return this._showNavigation},a.prototype.getShowSidebar=function(){return this._showSidebar},a.prototype.stretchMouseDown=function(t){if(o.isNumber(t.button)&&0!==t.button)return!1;this._myQuery("stretchBar"+this._postfix).classList.add("dvs-streching"),this._stretching=!0,o.preventDefault(t)},a.prototype.stretchMouseMove=function(t){var e;this._stretching&&(e=this._myQuery("sidebar"+this._postfix).getBoundingClientRect().left,this._stretchWidth=0<t.clientX-e?t.clientX-e:0,this._myQuery("stretchBar"+this._postfix).style.left=this._stretchWidth-5+"px")},a.prototype.stretchMouseUp=function(){if(!this._stretching)return!1;var t=this._myQuery("stretchBar"+this._postfix);if(this._stretching=!1,!t)return!1;var e=100<(e=this._stretchWidth/this._myQuery("body"+this._postfix).clientWidth*100)?100:e;this.setSideBarPercent(e),t.style.left=null,t.classList.remove("dvs-streching")},a.prototype.setSideBarPercent=function(t){var e=this._myQuery("sidebar"+this._postfix);if(!e)return!1;e.style.flex="0 0 "+t+"%",e.style.msFlex="0 0 "+t+"%",e.style.width=t+"%"},a.prototype.setSidebarWidth=function(t){this._sidebarWidth=t;var e=String(t);/\d+$/.test(e)&&(t=e+"px");var i=this._myQuery("sidebar"+this._postfix);return!!i&&(i.style.flex="0 0 "+t,i.style.width=""+t,!0)},a.prototype.getSidebarWidth=function(){var t=this._sidebarWidth;if(o.isNumber(t))return t;var e=this._myQuery("sidebar"+this._postfix);return e&&e.clientWidth?e.clientWidth:t},a);function a(t,i){this._postfix="",this._sideType=n.TAG,this._showNavigation=!1,this._showSidebar=!0,this._stretching=!1,this._sidebarWidth=180,this._visibleList={tag:!0,tree:!0},this._postfix=t,this._myQuery=function(t){var e;return null===(e=null==i?void 0:i.el)||void 0===e?void 0:e.querySelector("#"+t)}}e.SideRender=r},function(t,e,i){"use strict";var s=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<i;e++)for(var o=arguments[e],r=0,a=o.length;r<a;r++,s++)n[s]=o[r];return n};Object.defineProperty(e,"__esModule",{value:!0}),e.ThumbnailRender=void 0;var o=i(0),r=i(1),n=i(13),a=i(58),l=i(2),h=(u.prototype.createThumbnail=function(t){var e=t.uid;e||(e=o.uid(11),t.uid=e);var i=new n.ThumbnailItem(t,this._pubSub,this._viewerContainer,this.postfix,this._dataStore);return(this._thumbnails[e]=i).updateContent(this._thumbnailContents),i.selectThumbnailByIndexes(this._selectedIndexes),!0},u.prototype.createInnerThumbnail=function(t){this.innerThumbnail=new a.InnerThumbnail({uid:this.postfix,pubsub:new l.PublishSubscribe,size:"100%",location:"canvas",allowResizing:!1,allowKeyboardControl:t.allowKeyboardControl,mouseShape:t.canvasMouseShape,background:t.canvasBackground,border:t.canvasBorder,showThumbnail:!1,showPageNumber:t.showPageNumber,pageBackground:t.pageBackground,pageBorder:t.pageBorder,selectedPageBackground:t.selectedPageBackground,selectedPageBorder:t.selectedPageBorder,hoverPageBorder:t.hoverPageBorder,hoverPageBackground:t.hoverPageBackground,placeholderBackground:t.placeholderBackground,rows:t.rows,columns:t.columns,selectedBoxLineColor:t.selectedBoxLineColor},this._pubSub,this._viewerContainer,this.postfix,this._dataStore)},u.prototype.removeThumbnail=function(t){var e=this._thumbnails[t];return!!e&&(e.unbindEvents(),e.unbindUi(),this.emit("onSetSplitBar"),delete this._thumbnails[t],!0)},u.prototype.removeAllThumbnail=function(){var t,e,i;for(var n in this._thumbnails)this.removeThumbnail(n);null!==(t=this.innerThumbnail)&&void 0!==t&&t.unbindEvents(),null!==(e=this.innerThumbnail)&&void 0!==e&&e.dispose(),null!==(i=this.innerThumbnail)&&void 0!==i&&i.unbindUi(),this._thumbnails={},this._viewerContainer=null},u.prototype.on=function(t,e){this._pubSub.on(t,e.bind(this))},u.prototype.off=function(t,e){this._pubSub.off(t,e)},u.prototype.emit=function(t){for(var e,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];(e=this._pubSub).emit.apply(e,s([t],i))},u.prototype._bindEvents=function(){var n=this;this.on("_mergeDisplayedIndexes",function(t){var e=n._displayedIndexes.concat(t),i=(e=o.uniqueArray(e)).map(function(t){var e;return null===(e=n._thumbnailContents[t])||void 0===e?void 0:e.uid});n._displayedIndexes=e,clearTimeout(n._displayTimer),n._displayTimer=setTimeout(function(){n.emit(r.privateEvent.DISPLAYED_IMAGE_CHANGED,i.slice(0)),n._displayedIndexes=[]})})},u.prototype.calculateSize=function(){var t;for(var e in this._thumbnails)this._thumbnails[e].calculateSize();null!==(t=this.innerThumbnail)&&void 0!==t&&t.calculateSize()},u.prototype.updateAllDisplayed=function(){var t;for(var e in this._thumbnails)this._thumbnails[e].updateDisplayedIndexes();null!==(t=this.innerThumbnail)&&void 0!==t&&t.updateDisplayedIndexes()},u.prototype.showLatestPage=function(){var t;for(var e in this._thumbnails)this._thumbnails[e].showLatestPage();null!==(t=this.innerThumbnail)&&void 0!==t&&t.showLatestPage()},u.prototype.updatePagesLayout=function(){var t;for(var e in this._thumbnails)this._thumbnails[e].updatePageLayout();null!==(t=this.innerThumbnail)&&void 0!==t&&t.updatePageLayout()},u.prototype.updateContents=function(t){var e;for(var i in this._thumbnailContents=t,this._thumbnails)this._thumbnails[i].updateContent(t);null!==(e=this.innerThumbnail)&&void 0!==e&&e.updateContent(t)},u.prototype.updateSelectedIndexes=function(t){var e;for(var i in this._selectedIndexes=t,this._thumbnails)this._thumbnails[i].selectThumbnailByIndexes(t);null!==(e=this.innerThumbnail)&&void 0!==e&&e.selectThumbnailByIndexes(t)},u.prototype.pageChangeCallback=function(t,e,i){var n,s=this._thumbnailContents,o=this.innerThumbnail,r=this._lastShowUid,a=null===(n=s[e])||void 0===n?void 0:n.uid;void 0!==a&&r===a||(o.clearRects(),o.cropIndex=e,o.cropUid=a,this._lastShowUid=a)},u.prototype.keydownCallback=function(t,e){var i=this._thumbnails[e];i?i.keydownCallBack(t):e===this.innerThumbnail.uid&&(this.innerThumbnail.keydownCallBack(t),this.emit(r.privateEvent.CANVAS_KEY_DOWN,t))},u.prototype.keyupCallback=function(t,e){var i=this._thumbnails[e];i?i.keyupCallBack(t):e===this.innerThumbnail.uid&&(this.innerThumbnail.keyupCallBack(t),this.emit(r.privateEvent.CANVAS_KEY_UP,t))},u);function u(t,e,i,n){this._viewerContainer=null,this._dataStore=null,this._thumbnails={},this.innerThumbnail=null,this._selectedIndexes=[],this._displayedIndexes=[],this._thumbnailContents=[],this._lastShowUid="",this._displayTimer=null,this.postfix=t,this._pubSub=e,this._viewerContainer=i,this._dataStore=n,this._bindEvents()}e.ThumbnailRender=h},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ThumbnailPage=void 0;var a=i(1),n=i(0),s=(o.prototype.init=function(t){for(var e in t)void 0!==e&&t[e]&&(this[e]=t[e]);this.renderImg=null},o.prototype.updateData=function(t){var e=t.data,i=t.tags,n=t.optimization;e!==this.imgSrc&&(this.imgSrc=e,this.renderImg&&(this.renderImg.onload=null),this.renderImg=null,this.tags=i,this.optimization=n)},o.prototype.dispose=function(){this.renderImg&&(this.renderImg.onload=null),this.renderImg=null,this._canvasItem=null},o.prototype.render=function(){var t=this;if(!this._canvasItem||this._canvasItem.clientWidth<=0||this._canvasItem.clientHeight<=0)return!1;if(this.renderImg)this.renderImg.complete&&(this.renderImg.onload=null,this._renderImage());else{if(!this.imgSrc)return this._clearCanvas(),!1;var e=this.renderImg||new Image;this.allowCrossOrigin&&(e.crossOrigin="anonymous"),e.src=this.imgSrc,e.onload=function(){t._renderImage()},this.renderImg=e}},o.prototype.renderPage=function(){var t,e,i,n,s,o,r;this.renderImg&&this._showPage&&this._canvasItem&&(t=this.width,e=this.height,i=this._devicePixelRatio,n=Math.min(t,e)/10,n=Math.max(10*i,n),o=.99*t-(n=Math.min(20*i,n)),r=.99*e-n,(s=this._canvasItem.getContext("2d")).save(),s.beginPath(),s.lineWidth=i,s.fillStyle="rgba(255,255,255,0.8)",s.strokeStyle="#a79898",s.arc(o,r,n,0,2*Math.PI),s.closePath(),s.fill(),s.stroke(),s.textAlign="center",s.textBaseline="middle",s.fillStyle="#333",s.font=n+"px normal",s.fillText(String(this._currentPage),o,r+n/8,n),s.restore())},o.prototype.renderBox=function(){var t,e,i,n,s,o,r;this.renderImg&&this._showSelectBox&&this._canvasItem&&(t=this.width,e=this.height,n=Math.min(t,e)/7,i=this._devicePixelRatio,n=Math.max(15*i,n),o=.99*t-(n=Math.min(40*i,n)),r=.99*e-n,(s=this._canvasItem.getContext("2d")).save(),s.lineWidth=n/10,s.fillStyle="#fff",s.strokeStyle="#333",s.fillRect(o,r,n,n),s.strokeRect(o,r,n,n),this._isSelected&&(s.save(),s.beginPath(),s.lineCap="round",s.lineJoin="round",s.moveTo(o+.25*n,r+.5*n),s.lineTo(o+.5*n,r+.7*n),s.lineTo(o+5*n/6,r+.3*n),s.stroke(),s.closePath(),s.restore()),s.restore())},o.prototype.renderOptimizedPage=function(t,e,i,n){var s=this;if(void 0===n&&(n=0),!(2<=n))if(this.renderImg&&(this.renderImg.onload=null),0!==this.width&&0!==this.height){var o=(this.width-e)/2,r=(this.height-i)/2,a=this._canvasItem;if(a){var l=a.getContext("2d");if(l){l.save(),l.clearRect(0,0,a.width,a.height);for(var h=0;h<t.length;h++){var u=t[h];l.putImageData(u.target,o,r+u.start_y)}l.restore(),this.renderPage(),this.renderBox(),this.drawRect()}}}else setTimeout(function(){s.renderOptimizedPage(t,e,i,n++)},20)},o.prototype._renderImage=function(){var t,e,i,n,s,o,r=this.renderImg;r&&this._canvasItem&&(e=(t=this._calDrawImagePos(r)).left,i=t.top,n=t.width,s=t.height,(o=this._canvasItem.getContext("2d"))&&(o.save(),o.clearRect(0,0,this._canvasItem.width,this._canvasItem.height),o.drawImage(r,e,i,n,s),o.restore(),this.renderPage(),this.renderBox(),this.drawRect(),this._pubsub.emit(a.viewerEvent.VIEWER_PAGE_RENDERED,this._currentPage-1)))},o.prototype._calDrawImagePos=function(t){var e=t.naturalWidth,i=t.naturalHeight,n={left:0,top:0,width:0,height:0};if(this.width<=0||this.height<=0)return n;var s,o,r,a,l,h=this._devicePixelRatio;return this.optimization||(r=this.width,a=this.height,null!=(s=this._dataStore.getMetadataSync(this.uid))&&s.width&&null!=s&&s.height&&(r=(o=Math.min(r/h/s.width,a/h/s.height,1))*s.width,a=o*s.height),l=Math.max(e/r,i/a),e/=this.fitRatio=l,i/=l),n={left:(this.width-e*h)/2,top:(this.height-i*h)/2,width:e*h,height:i*h}},o.prototype._clearCanvas=function(){var t;!this._canvasItem||(t=this._canvasItem.getContext("2d"))&&t.clearRect(0,0,this._canvasItem.width,this._canvasItem.height)},Object.defineProperty(o.prototype,"width",{get:function(){return this._canvasWidth},set:function(t){this._setCanvasWidth(t)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this._canvasHeight},set:function(t){this._setCanvasHeight(t)},enumerable:!1,configurable:!0}),o.prototype.setTempData=function(t){this._tempData=t},o.prototype._setCanvasWidth=function(t){this._canvasItem&&(this._canvasWidth=t,this._canvasItem.width=t)},o.prototype._setCanvasHeight=function(t){this._canvasItem&&(this._canvasHeight=t,this._canvasItem.height=t)},o.prototype.resizeCanvasSize=function(){var t=this._canvasItem;if(!t||!this.renderImg&&!this.imgSrc)return!1;var e=t.clientWidth*this._devicePixelRatio,i=t.clientHeight*this._devicePixelRatio;if(e<=0||i<=0)return!1;var n=this._checkIfRenderPageOrBox();if(Math.abs(e-this.width)<=2&&Math.abs(i-this.height)<=2&&this.renderImg&&!n)return!1;this.width=e,this.height=i,this.render()},o.prototype._checkIfRenderPageOrBox=function(){var t=!1;for(var e in this._tempData){var i=this["_"+e],n=this._tempData[e];if(n===i)this._tempData[e]=i;else switch(this["_"+e]=n,e){case"currentPage":this._showPage&&(t=!0);break;case"isSelected":this._showSelectBox&&(t=!0);break;default:t=!0}}return t},o.prototype.setRect=function(t,e){this._rectArr=t,e&&(this._boxColor=e)},o.prototype.drawRect=function(){var t=this._rectArr;if(0!==t.length&&this.renderImg){var e=this._boxColor,i=this._dataStore.getMetadataSync(this.uid);if(null!=i&&i.width&&null!=i&&i.height)for(var n=i.width/this.renderImg.naturalWidth,s=0;s<t.length;s++)for(var o=t[s],r=0;r+1<8;r+=2){var a=e,l=o.probePoints[r]/n,h=o.probePoints[r+1]/n,u=o.midpoints[r]/n,d=o.midpoints[r+1]/n;this._drawPoint(this._transformRect(l,h),a),this._drawPoint(this._transformRect(u,d),e);var c=o.probePoints[(r+2)%8]/n,p=o.probePoints[(r+3)%8]/n;this._drawLine(this._transformRect(l,h),this._transformRect(c,p),e,o.dashLine)}}},o.prototype._transformRect=function(t,e){var i=this.renderImg,n=i.naturalWidth,s=i.naturalHeight,o=this.fitRatio;return{x:this.width/2+(t-n/2)/o*this._devicePixelRatio,y:this.height/2+(e-s/2)/o*this._devicePixelRatio}},o.prototype._drawPoint=function(t,e){var i,n=t.x,s=t.y;this._canvasItem&&((i=this._canvasItem.getContext("2d")).save(),i.lineWidth=this._devicePixelRatio,i.strokeStyle=e,i.strokeRect(n-4*this._devicePixelRatio,s-4*this._devicePixelRatio,8*this._devicePixelRatio,8*this._devicePixelRatio),i.restore())},o.prototype._drawLine=function(t,e,i,n){var s=this,o=t.x,r=t.y,a=e.x,l=e.y;if(this._canvasItem){var h=this._canvasItem.getContext("2d");h.save();try{h.setLineDash(n.map(function(t){return t*s._devicePixelRatio}))}catch(t){}h.lineWidth=this._devicePixelRatio,h.strokeStyle=i,h.beginPath(),h.moveTo(o,r),h.lineTo(a,l),h.stroke(),h.restore()}},o);function o(t,e,i){this._canvasItem=null,this.renderImg=null,this.imgSrc=null,this.uid="",this.tags=[],this.optimization=!1,this._pubsub=null,this._dataStore=null,this._showPage=!1,this._showSelectBox=!1,this._currentPage=-1,this._isSelected=!1,this._tempData={currentPage:-1,showPage:!1,showSelectBox:!1,isSelected:!1},this.allowCrossOrigin=!0,this.fitRatio=0,this._canvasWidth=0,this._canvasHeight=0,this._devicePixelRatio=1,this._rectArr=[],this._pubsub=e,this._dataStore=i,this._devicePixelRatio=n.devicePixelRatio(),t&&this.init(t)}e.ThumbnailPage=s},function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.InnerThumbnail=void 0;var r,c=i(1),o=i(13),a=i(4),p=i(0),l=(r=o.ThumbnailItem,s(h,r),h.prototype._initEvents=function(){var i=this,t=[c.privateEvent.CANVAS_MOUSE_DOWN,c.privateEvent.CANVAS_MOUSE_MOVE,c.privateEvent.CANVAS_MOUSE_UP,c.privateEvent.CANVAS_CLICK,c.privateEvent.CANVAS_RIGHT_CLICK,c.privateEvent.CANVAS_DOUBLE_CLICK,c.privateEvent.CANVAS_MOUSE_OVER,c.privateEvent.CANVAS_MOUSE_OUT],e=[c.viewerEvent.PAGE_MOUSE_DOWN,c.viewerEvent.PAGE_MOUSE_MOVE,c.viewerEvent.PAGE_MOUSE_UP,c.viewerEvent.PAGE_CLICK,c.viewerEvent.PAGE_RIGHT_CLICK,c.viewerEvent.PAGE_DOUBLE_CLICK,c.viewerEvent.PAGE_MOUSE_OVER,c.viewerEvent.PAGE_MOUSE_OUT];this._originEvents=e;for(var n=0;n<t.length;n++)this._packageEvent(e[n],t[n]);this._pubSub.on(c.viewerEvent.DRAG_DONE,function(t){i._viewerPub.emit(c.privateEvent.CANVAS_DRAG_DONE,t)}),this._pubSub.on(c.viewerEvent.TOP_PAGE_CHANGED,function(t,e){i._viewerPub.emit(c.viewerEvent.TOP_PAGE_CHANGED,t,e)}),this._pubSub.on(c.viewerEvent.PAGE_MOUSE_DOWN,this._cropStart.bind(this)),this._pubSub.on(c.viewerEvent.VIEWER_PAGE_RENDERED,function(t){i._viewerPub.emit(c.viewerEvent.VIEWER_PAGE_RENDERED,t)}),this._viewerPub.on(c.uiEvent.DOCUMENT_POINTER_MOVE,this._cropMove.bind(this)),this._viewerPub.on(c.uiEvent.DOCUMENT_POINTER_UP,this._cropUp.bind(this)),this._viewerPub.on(c.privateEvent.UPDATE_INNER_THUMBNAIL_PAGE,this._updateInnerPage.bind(this))},h.prototype.dispose=function(){var e=this;this._originEvents.forEach(function(t){e._pubSub.off(t)}),this._pubSub.off(c.viewerEvent.DRAG_DONE),this._pubSub.off(c.viewerEvent.TOP_PAGE_CHANGED),this._pubSub.off(c.viewerEvent.PAGE_MOUSE_DOWN),this._viewerPub.off(c.privateEvent.UPDATE_INNER_THUMBNAIL_PAGE)},h.prototype._packageEvent=function(t,l){var h=this;this._pubSub.on(t,function(t,e){var i=t.index,n=t.pageX,s=t.pageY;if(-1===i)h._viewerPub.emit(l,e,{index:i,imageX:-1,imageY:-1,pageX:n,pageY:s});else{if(!h._thumbnailCanvas[i])return;var o=h._getOriginPosition(i,e),r=o.imageX,a=o.imageY;h._viewerPub.emit(l,e,{index:i,imageX:r,imageY:a,pageX:n,pageY:s})}})},h.prototype._getOriginPosition=function(t,e,i){var n;void 0===i&&(i=!0);var s=null,o=null,r=null===(n=this._thumbnailElement.querySelector(".dvs-thumbLists"))||void 0===n?void 0:n.children;if(r){if(this.ifDragMoves)for(var a=-1,l=0;l<r.length;l++){var h=r[l];if((null==h||!h.classList.contains("dvs-activeThumb"))&&t===++a){s=h,o=this._thumbnailCanvas[h["dvs-defaultIndex"]];break}}else s=r[t],o=this._thumbnailCanvas[t];if(s){var u=s.getBoundingClientRect(),d=this._dataStore.getMetadataSync(o.uid);if(!o.renderImg||null==d||!d.width||null==d||!d.height)return{imageX:-1,imageY:-1};var c=e.clientX-u.left,p=e.clientY-u.top,v=o.renderImg.naturalWidth,_=o.renderImg.naturalHeight,f=o.fitRatio,m=c-(u.width-v/f)/2,g=p-(u.height-_/f)/2;if(i&&(m<0||g<0||v/f<m||_/f<g))return{imageX:-1,imageY:-1};var y=d.width/v;return{imageX:Math.floor(m*f*y),imageY:Math.floor(g*f*y)}}}},h.prototype._cropStart=function(t,e){var i=t.index,n=this.selectedIndexes.slice().pop();if(-1!==i&&n===i&&this._isCrop){var s=this._thumbnailCanvas[i];if(s&&s.renderImg){var o=this._getOriginPosition(i,e),r=o.imageX,a=o.imageY;if(-1!==r&&-1!==a){var l=this._dataStore.getMetadataSync(s.uid);if(null==l||!l.width||!l.height)return this._pubSub.emit(c.privateEvent.UPDATE_ERROR_MESSAGE,c.errorMessages.META_DATA_NOT_EXIST),!1;var h=l.width/s.renderImg.naturalWidth,u=s.fitRatio,d=this.cropManager;d.setZoom(1/u/h),d.setPageSize(l.width,l.height),d.onStartHandler(r,a,e.ctrlKey),s.setRect(d.cropBoxes,this.selectedBoxLineColor),p.preventDefault(e)}}}},h.prototype._cropMove=function(t){var e,i,n,s,o,r,a,l;this.showThumbnail&&this._isCrop&&(-1===(e=this.selectedIndexes.slice().pop())||(i=this._thumbnailCanvas[e])&&(s=(n=this._getOriginPosition(e,t,!1)).imageX,o=n.imageY,(a=(r=this.cropManager).checkSelectForCursor(s,o))?(l="move"===a.position?"move":a.position+"-resize",this._viewerPub.emit(c.uiEvent.CHANGE_CANVAS_CURSOR,l)):this._viewerPub.emit(c.uiEvent.CHANGE_CANVAS_CURSOR,""),r.mouseDown&&(r.setKeepAspectRatio(t.shiftKey),r.onMoveHandler(s,o,!1),this.setPageRect(i))))},h.prototype._cropUp=function(t){var e,i,n,s;this._isCrop&&this.cropManager.mouseDown&&(e=this.selectedIndexes.slice().pop(),this._thumbnailCanvas[e],n=(i=this._getOriginPosition(e,t,!1)).imageX,s=i.imageY,this.cropManager.onEndHandler(n,s))},h.prototype.setPageRect=function(t,e){var i;void 0===e&&(e=this.selectedBoxLineColor),t&&(i=this.cropManager.cropBoxes,t.setRect(i,e),t.render())},h.prototype._updateInnerPage=function(t){return t.data,t.index,t.uid,t.width,t.height,!1},h.prototype.clearRects=function(){this.cropManager.clear()},h.prototype.setSelectedBoxLineColor=function(t){this.selectedBoxLineColor=t;var e=this.selectedIndexes.slice().pop(),i=this._thumbnailCanvas[e];i&&this._isCrop&&this.setPageRect(i,t)},h.prototype.setOperationMode=function(t){1===t?this._isCrop=!0:(this._isCrop=!1,this.clearRects())},h.prototype.setSelectedBoxes=function(t,e){e||this.cropManager.clear(),p.isArray(t)||(t=[t]);var i=this.selectedIndexes.slice().pop(),n=this._thumbnailCanvas[i],s=this._dataStore.getMetadataSync(n.uid);this.cropManager.setPageSize(s.width,s.height);for(var o=t.length,r=0;r<o;r++){var a=t[r];this.cropManager.addBox([a.left,a.top,a.left+a.width,a.top,a.left+a.width,a.top+a.height,a.left,a.top+a.height],"bottomRight")}var l=this.cropManager.getRectArr();this.setPageRect(n),this._viewerPub.emit(c.viewerEvent.PAGE_AREA_SELECTED,i,l),this._viewerPub.emit(c.viewerEvent.VIEWER_PAGE_RENDERED,i,l)},h.prototype.setKeepAspectRatio=function(t){},h.prototype.setAspectRatio=function(t){this.cropManager.setAspectRatio(t)},h.prototype.clearSelectedBoxes=function(t){this.clearRects()},h);function h(t,e,i,n,s){var o=r.call(this,t,e,i,n,s)||this;return o.isInner=!0,o._isCrop=!1,o.cropIndex=-1,o.cropUid="",o._originEvents=[],o.cropManager=new a.CropManager(0,0),o.cropManager.selectedCallback=function(t){var e=o.selectedIndexes.slice().pop(),i=o._thumbnailCanvas[e];i&&i.renderImg&&o._viewerPub.emit(c.viewerEvent.PAGE_AREA_SELECTED,e,t)},o.cropManager.unselectedCallback=function(){for(var t=o.cropIndex,e=o._thumbnailCanvas.length,i=0;i<e;i++){var n=o._thumbnailCanvas[i];o.cropUid===n.uid&&n.renderImg&&(o.cropManager.cropBoxes=[],o.setPageRect(n))}o._viewerPub.emit(c.viewerEvent.PAGE_AREA_UNSELECTED,t)},o._initEvents(),o}e.InnerThumbnail=l},function(t,e,i){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.DirectoryRender=void 0;var s=i(0),a=n(i(8)),o=(r.prototype.treeInit=function(){var t=this._myQuery("treeLists"+this.postfix);this.treeList=a.default.createVnode("UL",{},[],t)},r.prototype.updateDirectory=function(t){if(!this._myQuery("treeLists"+this.postfix))return!1;var e=t.children.slice(0);"root"!==t.name?(e.unshift({name:".....",class:"backTree",type:"back",isBack:!0}),this.isRoot=!1):this.isRoot=!0;var i=this._createVirtualTree(e);this.treeList=a.default.patch(this.treeList,i)},r.prototype.getChildIndex=function(t){var e=s.getIndex(t),i=t.parentNode.children[0];return"back"===i.type&&e--,i.classList.contains("createBox")&&e--,e},r.prototype.getTargetDom=function(t){var e,i=t.target;return!!i&&("LI"===i.tagName&&i.dvs_type?e=i:i.parentNode.dvs_type&&(e=i.parentNode),e)},r.prototype.addNewFolder=function(t){var e=a.default.createVnode,i=e("LI",{class:"createBox",id:"createBox"+this.postfix},[e("DIV",{class:"ds-dvs-ui-iconfont ds-dvs-ui-tree"}),e("INPUT",{id:"folderInput"+this.postfix}),e("DIV",{class:"judgeBox"},[e("DIV",{class:"confirmFolder ds-dvs-ui-iconfont ds-dvs-ui-confire"}),e("DIV",{class:"cancelFolder ds-dvs-ui-iconfont ds-dvs-ui-cancle"})])]),n=this.treeList.children;n&&n.length&&!this.isRoot?a.default.addOneVnode(this.treeList,1,i):a.default.addOneVnode(this.treeList,0,i),this._myQuery("folderInput"+this.postfix).focus(),this._myQuery("addFolder"+this.postfix).style.pointerEvents="none"},r.prototype.renameFile=function(t){var e,i,n,s,o,r;t.target.classList.contains("renameFileBtn")&&(e=this._myQuery("contextMenu"+this.postfix)["dvs-activeIndex"],n=(i=this._myQuery("treeLists"+this.postfix).children[e]).children[1].innerText,o=(s=a.default.createVnode)("LI",{class:"createBox",id:"createBox"+this.postfix,dvs_fileName:n,dvs_type:i.dvs_type},[s("DIV",{class:"ds-dvs-ui-iconfont ds-dvs-ui-tree"}),s("INPUT",{id:"folderInput"+this.postfix,value:n}),s("DIV",{class:"judgeBox"},[s("DIV",{class:"renameConfirmFile ds-dvs-ui-iconfont ds-dvs-ui-confire"}),s("DIV",{class:"cancelFolder ds-dvs-ui-iconfont ds-dvs-ui-cancle"})])]),this.treeList.children[e]=a.default.patch(this.treeList.children[e],o),(r=this._myQuery("folderInput"+this.postfix)).focus(),r.select())},r.prototype.selectFileByName=function(e){var t,i=this;Array.from(null===(t=this._myQuery("treeLists"+this.postfix))||void 0===t?void 0:t.children).forEach(function(t){t.children[1].innerText===e?(t.classList.add("dvs-activeFile"),i._myQuery("defaultTag"+i.postfix).classList.remove("dvs-activeAllImage")):t.classList.remove("dvs-activeFile")})},r.prototype._createVirtualTree=function(t){for(var e=a.default.createVnode,i=e("UL",{},[]),n=0,s=t.length;n<s;n++){var o=t[n];o&&i.children.push(e("LI",{id:"",class:"",title:o.name,dvs_type:o.type,dvs_fileName:o.name},[e("DIV",{class:"ds-dvs-ui-iconfont "+("folder"===o.type?"ds-dvs-ui-tree":o.isBack?"ds-dvs-ui-folderopen":"ds-dvs-ui-file")}),e("SPAN",{},[],null,o.name)]))}return i},r.prototype.confirmFolder=function(t){if(!t.target.classList.contains("confirmFolder"))return!1;var e=t.target.parentNode.parentNode.children[1].value;if(e)this._pubsub.emit("_onAddFolder",e,[]);else if(t.target.classList.contains("renameConfirmFile")){var i=t.target.parentNode.parentNode,n=i.dvs_fileName,s=i.children[1].value,o=i.dvs_type;if("folder"===o)this._pubsub.emit("_onRenameFolder",n,s);else{if("file"!==o)return;this._pubsub.emit("_onRenameFile",n,s)}}},r.prototype.enterFolder=function(t){var e,i,n=this.getTargetDom(t);n&&(e=n.dvs_type,i=n.dvs_fileName,"folder"===e?this._pubsub.emit("_onOpenFolder",i):"back"===e?this._pubsub.emit("_onBackToPrevious"):this._pubsub.emit("_onOpenFile",i))},r.prototype.cancelFolder=function(t){t.target.classList.contains("cancelFolder")&&this._pubsub.emit("_onDirectoryChange")},r);function r(t,e,i){this.isRoot=!0,this.postfix=t,this._pubsub=e,this._myQuery=function(t){var e;return null===(e=null==i?void 0:i.el)||void 0===e?void 0:e.querySelector("#"+t)}}e.DirectoryRender=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VNode=void 0;var s=i(0),n=(o.prototype.createVNode=function(t,e,i,n,s){void 0===e&&(e={}),void 0===i&&(i=[]),void 0===s&&(s="");var o={el:n,tagName:t,sel:"",data:e,children:i,text:s};return this._updateVNode(o)},o.prototype._updateVNode=function(t){var e=this;s.isObject(t.data)||(t.data={}),s.isArray(t.children)||(t.children=[]);var i=t.data.id,n=t.tagName;return i?(n+="#"+i,t.sel=n):t.data.class&&(n+="."+t.data.class,t.sel=n),t.children.forEach(function(t){return e._updateVNode(t)}),t},o);function o(t,e,i,n,s){return this.createVNode(t,e,i,n,s)}e.VNode=n},function(t,e,i){"use strict";var s=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<i;e++)for(var o=arguments[e],r=0,a=o.length;r<a;r++,s++)n[s]=o[r];return n},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.TagRender=void 0;var a=i(0),l=n(i(8)),o=(r.prototype.emit=function(t){for(var e,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];(e=this._pubSub).emit.apply(e,s([t],i))},r.prototype.tagInit=function(){var t=this._myQuery("tagLists"+this.postfix);this.tagNode=l.default.createVnode("UL",{},[],t)},r.prototype.getTargetDom=function(t){var e=t.target;return!!e&&("SPAN"===e.tagName&&(e=e.parentNode),e&&e.classList&&!e.classList.contains("createBox")?e:void 0)},r.prototype.updateTagList=function(t){if(a.isArray(t)||(t=[]),!this._myQuery("tagLists"+this.postfix))return!1;this.tagList=t;var e=this._createVirtualTag(t);this.tagNode=l.default.patch(this.tagNode,e),this.bindHoverEvent()},r.prototype.selectTagByName=function(e){var i=this;Array.from(this._myQuery("tagLists"+this.postfix).children).forEach(function(t){t.children[0].innerText===e?(t.classList.add("dvs-activeTag"),t.children[1].classList.remove("dvs-nodisplay"),i._myQuery("defaultTag"+i.postfix).classList.remove("dvs-activeAllImage")):(t.classList.remove("dvs-activeTag"),t.children[1].classList.add("dvs-nodisplay"))})},r.prototype.bindHoverEvent=function(){var t=this._myQuery("tagLists"+this.postfix);if(!t)return!1;var n=t.children;if(n&&n.length)for(var e=0;e<n.length;e++)!function(t){var e=n[t],i=e.children[1];e.onmouseenter=function(t){i.classList.remove("dvs-nodisplay")},e.onmouseleave=function(t){e.classList.contains("dvs-activeTag")||i.classList.add("dvs-nodisplay")}}(e)},r.prototype._createVirtualTag=function(t){for(var e=(0,l.default.createVnode)("UL",{},[]),i=0,n=t.length;i<n;i++){var s=t[i],o=l.default.createVnode("LI",{class:"",id:"",dvs_name:s.name,key:s.tagId},[l.default.createVnode("SPAN",{},[],null,s.name),l.default.createVnode("DIV",{class:"editDelBox  dvs-nodisplay"},[l.default.createVnode("DIV",{class:"dvs-quickEdit ds-dvs-ui-pencil ds-dvs-ui-iconfont"}),l.default.createVnode("DIV",{class:"dvs-quickDel ds-dvs-ui-delete ds-dvs-ui-iconfont"})])]);e.children.push(o)}return e},r.prototype.confirmTag=function(t){var e,i,n=this._myQuery("createBox"+this.postfix),s=n.children[0].value;t.classList.contains("confirmTag")?this.emit("_onAddTag",s):t.classList.contains("renameConfirmTag")&&((e=n.dvs_oldName)===(i=s)?this.emit("_onTagChange"):this.emit("_onRenameTag",e,i));var o=this._myQuery("addTag"+this.postfix);o&&(o.style.pointerEvents="auto")},r.prototype.cancelTag=function(t){var e;t.classList.contains("cancelTag")&&(this.emit("_onTagChange"),this._myQuery("addTag"+this.postfix).style.pointerEvents="auto",(e=this._myQuery("addTag"+this.postfix))&&(e.style.pointerEvents="auto"))},r.prototype.addNewTag=function(t){var e=l.default.createVnode("LI",{class:"createBox",id:"createBox"+this.postfix},[l.default.createVnode("INPUT",{id:"tagInput"+this.postfix}),l.default.createVnode("DIV",{class:"judgeBox"},[l.default.createVnode("DIV",{class:"confirmTag ds-dvs-ui-iconfont ds-dvs-ui-confire"}),l.default.createVnode("DIV",{class:"cancelTag ds-dvs-ui-iconfont ds-dvs-ui-cancle"})])]);l.default.addOneVnode(this.tagNode,0,e),this._myQuery("tagInput"+this.postfix).focus(),t.target.style.pointerEvents="none",a.stopBubble(t)},r.prototype.renameTag=function(t){var e,i,n,s,o;t.target.classList.contains("renameTagBtn")&&(e=this._myQuery("contextMenu"+this.postfix)["dvs-activeIndex"],i=this._myQuery("tagLists"+this.postfix).children[e].children[0].innerText,n=this.tagNode,s=l.default.createVnode("LI",{class:"createBox",id:"createBox"+this.postfix,dvs_oldName:i},[l.default.createVnode("INPUT",{id:"tagInput"+this.postfix,value:i}),l.default.createVnode("DIV",{class:"judgeBox"},[l.default.createVnode("DIV",{class:"renameConfirmTag ds-dvs-ui-iconfont ds-dvs-ui-confire"}),l.default.createVnode("DIV",{class:"cancelTag ds-dvs-ui-iconfont ds-dvs-ui-cancle"})])]),n.children[e]=l.default.patch(n.children[e],s),(o=this._myQuery("tagInput"+this.postfix)).focus(),o.select())},r.prototype.quickRenameTag=function(t){if(t&&t.classList.contains("dvs-quickEdit")){var e=t.parentNode.parentNode;if(!e)return!1;var i=e.dvs_name;if(!i)return!1;var n=a.getIndex(e),s=this.tagNode,o=l.default.createVnode("LI",{class:"createBox",id:"createBox"+this.postfix,dvs_oldName:i},[l.default.createVnode("INPUT",{id:"tagInput"+this.postfix,value:i}),l.default.createVnode("DIV",{class:"judgeBox"},[l.default.createVnode("DIV",{class:"renameConfirmTag ds-dvs-ui-iconfont ds-dvs-ui-confire"}),l.default.createVnode("DIV",{class:"cancelTag ds-dvs-ui-iconfont ds-dvs-ui-cancle"})])]);s.children[n]=l.default.patch(s.children[n],o);var r=this._myQuery("tagInput"+this.postfix);r.focus(),r.select()}},r.prototype.quickDelTag=function(t){if(t&&t.classList.contains("dvs-quickDel")){var e=t.parentNode.parentNode;if(!e)return!1;var i=e.dvs_name;this.emit("_onRemoveTag",i)}},r.prototype.showTagContent=function(t){var e,i=this.getTargetDom(t);i&&((e=i.dvs_name)&&(this.emit("_onOpenTag",e),this.selectTagByName(e)),a.stopBubble(t))},r);function r(t,e,i){this._pubSub=e,this.postfix=t,this._myQuery=function(t){var e;return null===(e=null==i?void 0:i.el)||void 0===e?void 0:e.querySelector("#"+t)}}e.TagRender=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScrollRender=void 0;var h=i(0),o=i(1),n=(s.prototype.getImageSize=function(t){var e=this,i=this.setOuterSize(t.width,t.height);return this.setScroller(t.x,t.y),i&&setTimeout(function(){e.setViewPort(),e._pub.emit("_onCanvasResize")}),i},s.prototype.setScroller=function(t,e){var i=h.id("outer"+this._postfix);if(!i)return!1;var n=i.scrollLeft,s=i.scrollTop;return n===t&&s===e||(this.isMyScroll=!0),i.scrollLeft=t,i.scrollTop=e,!0},s.prototype.setOuterSize=function(t,e){var i=h.id("outer"+this._postfix),n=h.id("inner"+this._postfix),s=!1,o=!1;if(!i||!n)return!1;t>i.offsetWidth?(i.style.overflowX="auto",s=!0):i.style.overflowX="hidden",e>i.offsetHeight?(i.style.overflowY="auto",o=!0):i.style.overflowY="hidden",n.style.width=t+"px",n.style.height=e+"px";var r=this._xOver!==s,a=this._yOver!==o;return this._xOver=s,this._yOver=o,r||a},s.prototype.setViewPort=function(){var t=h.id("outer"+this._postfix),e=h.id("viewPort"+this._postfix);if(!t||!e)return!1;var i=t.offsetWidth-t.clientWidth,n=t.offsetHeight-t.clientHeight;e.style.width="calc(100% - "+i+"px)",e.style.height="calc(100% - "+n+"px)"},s.prototype._addButtonScroll=function(){var n=this,s=[],t=this._myQueryAll("dvs-groupType","."),e=h.isMobile();this._pub.on(o.uiEvent.DOCUMENT_POINTER_MOVE,function(t){e?n.buttonScrollMoveMobile(t):n.buttonScrollMove(t)}),this._pub.on(o.uiEvent.DOCUMENT_POINTER_UP,function(){n.buttonScrollEndFun()}),[].forEach.call(t,function(t){"ontouchstart"in document.documentElement?h.addEvent(t,o.originEvent.TOUCH_START,function(t){n.buttonScrollStartMobile(t)}):h.addEvent(t,o.originEvent.MOUSE_DOWN,function(t){n.buttonScrollStart(t)}),n._unbindList=s;var e=t.children[0];e&&(e.onclick=function(){t.scrollLeft=0,n._updateShowMore(t)});var i=t.querySelector(".showAfter");i&&(i.onclick=function(){t.scrollLeft=t.scrollWidth-t.clientWidth,n._updateShowMore(t)})})},s.prototype.buttonScrollStart=function(t){return!(t.button&&0!==t.button||(this._buttonScrollStartFun(t),0))},s.prototype.buttonScrollStartMobile=function(t){var e=t.changedTouches[0];return!!e&&(this._buttonScrollStartFun(e),!0)},s.prototype._buttonScrollStartFun=function(t){var e;if(t.target&&t.target.classList.contains("dvs-groupType"))e=t.target;else{if(!(t.target&&t.target.parentNode&&t.target.parentNode.classList.contains("dvs-groupType")))return!1;e=t.target.parentNode}this._isButtonScroll=!0,this._scrollStartInfo={x:t.clientX,y:t.clientY,left:e.scrollLeft,top:e.scrollTop,item:e}},s.prototype.buttonScrollMove=function(t){return this._buttonScrollMoveFun(t),!0},s.prototype.buttonScrollMoveMobile=function(t){var e=t.changedTouches[0];return!!e&&(this._buttonScrollMoveFun(e),!0)},s.prototype._buttonScrollMoveFun=function(t){if(!this._isButtonScroll)return!1;var e,i,n=this._scrollStartInfo,s=n.x,o=n.y,r=n.left,a=n.top,l=n.item;l.scrollWidth>l.clientWidth&&(e=t.clientX-s,i=t.clientY-o,(5<Math.abs(e)||5<Math.abs(i))&&(this.buttonMove=!0,l.scrollLeft=r-e,l.scrollTop=a-i,this._updateShowMore(l),h.preventDefault(t)))},s.prototype.buttonScrollEndFun=function(){this._isButtonScroll=!1,this._scrollStartInfo={},document.removeEventListener(o.originEvent.TOUCH_MOVE,h.preventDefault)},s.prototype._updateShowMore=function(t){if(!t)return!1;if(0==t.children.length)return!1;5<=t.scrollWidth-t.clientWidth?t.style.justifyContent="flex-start":t.style.justifyContent="";var e=t.scrollLeft,i=5<=e,n=e+t.clientWidth<t.scrollWidth-5,s=t.querySelector(".showBefore");if(!s||"SPAN"!==s.tagName)return!1;i&&60<=t.clientWidth?s.classList.remove("dvs-nodisplay"):s.classList.add("dvs-nodisplay"),t.children.length;var o=t.querySelector(".showAfter");n&&60<=t.clientWidth?o.classList.remove("dvs-nodisplay"):o.classList.add("dvs-nodisplay"),e=t.scrollLeft,s.style.left=e+"px",o.style.right=-e+"px"},s.prototype.updateAllGroupShowMore=function(){var e=this,t=this._myQueryAll("dvs-groupType",".");[].forEach.call(t,function(t){e._updateShowMore(t)})},s.prototype.unbindEvents=function(){this._unbindList.forEach(function(t){null!=t&&t()})},s);function s(t,e,n){this._pub=null,this._xOver=!1,this._yOver=!1,this.isMyScroll=!1,this.buttonMove=!1,this._isButtonScroll=!1,this._unbindList=[],this._postfix=t,this._pub=e,this._myQuery=function(t,e){var i;return void 0===e&&(e="#"),null===(i=null==n?void 0:n.el)||void 0===i?void 0:i.querySelector(e+t)},this._myQueryAll=function(t,e){var i;return void 0===e&&(e="#"),null===(i=null==n?void 0:n.el)||void 0===i?void 0:i.querySelectorAll(e+t)}}e.ScrollRender=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContextMenuRender=void 0;var p=i(0),v=i(0),n=(s.prototype._initContextMenu=function(l){var h,u=this,d=document.createElement("ul");d.className="dvs-contextMenu dvs-nodisplay";for(var c=this,t=0;t<l.length;t++)!function(t){var e,i,n,s,o,r,a=l[t];v.isObject(a)&&((e=document.createElement("li")).id=a.id,(i=document.createElement("span")).className=(null==a?void 0:a.iconClass)||"",e.appendChild(i),(r=document.createElement("span")).innerText=a.text||"",e.appendChild(r),v.isString(a.onClick)&&(e.onclick=function(t){p.stopBubble(t),u._pubsub.emit(a.onClick,e)}),v.isArray(a.children)&&null!==(h=a.children)&&void 0!==h&&h.length&&((n=document.createElement("span")).className="ds-dvs-ui-iconfont ds-dvs-ui-pageNext dvs-showMore",e.appendChild(n),s=c._initContextMenu(a.children),e.appendChild(s),e.onmouseenter=function(){o=setTimeout(function(){u.showSubmenu(e)},200)},e.onmouseleave=function(){clearTimeout(o),u.hideSubmenu(e)}),d.appendChild(e))}(t);return d},s.prototype.showContextMenu=function(t,e){var i;if(!this.allowContextMenu)return!1;var n=this._currentMenu;e&&(n&&null!==(i=n.parentNode)&&void 0!==i&&i.removeChild(n),this._currentMenu=this._initContextMenu(e),n=this._currentMenu);var s,o,r=this._viewerEl;!r||(s=r.querySelector("#hiddenBoxs"+this._postfix))&&(s.appendChild(n),null!=n&&n.classList.remove("dvs-nodisplay"),o=r.getBoundingClientRect(),t.clientX,o.left,n.style.left=t.clientX-o.left+"px",n.clientHeight+t.clientY<o.bottom?(n.style.top=t.clientY-o.top+"px",n.style.bottom=null):(n.style.bottom=o.bottom-t.clientY+"px",n.style.top=null,t.clientY-n.clientHeight<o.top&&(n.style.top="0px",n.style.bottom=null)))},s.prototype.hideContextMenu=function(){var t;null!==(t=this._currentMenu)&&void 0!==t&&t.classList.add("dvs-nodisplay")},s.prototype.showSubmenu=function(t){var e,i=null==t?void 0:t.children[(null===(e=t.children)||void 0===e?void 0:e.length)-1];if(!i)return!1;i.classList.remove("dvs-nodisplay"),i.style.top="-1px",i.style.left="100%";var n=this._viewerEl.getBoundingClientRect(),s=i.getBoundingClientRect();n.height<=s.height?s.style.height=n.height+"px":s.top+s.height>n.bottom&&(i.style.top=n.bottom-s.height-s.top+"px")},s.prototype.hideSubmenu=function(t){var e,i=null==t?void 0:t.children[(null===(e=t.children)||void 0===e?void 0:e.length)-1];null!=i&&i.classList.add("dvs-nodisplay")},s);function s(t,e,i){this._pubsub=null,this._viewerEl=null,this._currentMenu=null,this.backgroundColor="#3b3a3c",this.hoverColor="#434246",this.menuBorder="#2a292b",this.cssClass="dvs-contextMenu",this.allowContextMenu=!0,this._postfix=t,this._pubsub=e,this._viewerEl=i}e.ContextMenuRender=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PagerRender=void 0;var n=i(0),s=(o.prototype.nextPage=function(){this._pubsub.emit("_onNextPage")},o.prototype.prevPage=function(){this._pubsub.emit("_onPreviousPage")},o.prototype.homePage=function(){this._pubsub.emit("_onFirstPage")},o.prototype.endPage=function(){this._pubsub.emit("_onLastPage")},o.prototype.goToPage=function(t){this._pubsub.emit("_onGotoPage",t)},o.prototype.getCurrentPage=function(){return this._currentPage},o.prototype.setCurrentPage=function(t){return!!n.isNumber(t)&&(this._currentPage=t,!0)},o.prototype.getTotalPage=function(){return this._totalPage},o.prototype.setTotalPage=function(t){return!!n.isNumber(t)&&(this._totalPage=t,!0)},o.prototype.updatePage=function(t){var e=document.getElementById("pagerInput"+this._postfix),i=document.getElementById("pagerLabel"+this._postfix),n=t.currentPage,s=t.totalPages;this.setCurrentPage(n),this.setTotalPage(s);var o,r=s?n+1:0;e&&i&&(e.value=r,i.innerText=String(s),e.style.fontSize="16px",o=16*String(s).length+"px",e.style.width=o)},o.prototype.pageBlur=function(t){var e=parseInt(t.target.value);this.goToPage(e)},o);function o(t,e){this._currentPage=-1,this._totalPage=0,this._postfix=t,this._pubsub=e}e.PagerRender=s},function(t,e,i){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.TabRender=void 0;var s=i(66),l=n(i(8)),o=(r.prototype.tabRenderInit=function(){var t,e,i=null===(e=null===(t=this._viewerContainer)||void 0===t?void 0:t.el)||void 0===e?void 0:e.querySelector("#tabList"+this._postfix);this._tabVNode=l.default.createVnode("DIV",{},[],i)},r.prototype.tabDestroy=function(){this._tabVNode=null},r.prototype.updateTabList=function(t){var e=t.selectedTabId,i=t.tabs;this._updateTabData(i);var n=this._createVirtualTab(i);this._tabVNode=l.default.patch(this._tabVNode,n),this.selectTabById(e)},r.prototype.getSelectedIndex=function(){for(var t,e=0;e<this._tabList.length;e++)if((null===(t=this._tabList[e])||void 0===t?void 0:t.id)===this._selectedTabId)return e;return-1},r.prototype.selectTabByIndex=function(t){var e;return void 0!==this._tabList[t]&&(this._selectedTabId=null===(e=this._tabList[t])||void 0===e?void 0:e.id,this._updateSelectedStyle(),!0)},r.prototype.selectTabById=function(t){this._selectedTabId=t,this._updateSelectedStyle()},r.prototype.closeTabById=function(t){},r.prototype._updateSelectedStyle=function(){var t,e,i=null===(e=null===(t=this._viewerContainer)||void 0===t?void 0:t.el)||void 0===e?void 0:e.querySelector("#tabList"+this._postfix);if(i)for(var n=null==i?void 0:i.children,s=0;s<n.length;s++){var o=n[s];null!=o&&o.classList[(null==o?void 0:o.id)===this._selectedTabId?"add":"remove"]("dvs-activeTab")}},r.prototype._updateTabData=function(t){for(var e=[],i=0;i<t.length;i++){var n=this._createTabItem(t[i]);e.push(n)}this._tabList=e},r.prototype._createTabItem=function(t){return new s.TabItem(t)},r.prototype._createVirtualTab=function(t){for(var e,i=l.default.createVnode,n=i("DIV"),s=0,o=t.length;s<o;s++){var r=t[s],a=i("DIV",{class:"dvs-tabItem "+(r.id===this._selectedTabId?"activeTab":""),id:r.uid,key:r.uid,title:r.name},[i("SPAN",{class:r.iconClass||""}),i("SPAN",{class:"dvs-tabText"},[],null,r.name),i("A",{class:"ds-dvs-ui-iconfont ds-dvs-ui-cancle dvs-closeTab","dvs-id":r.uid})]);null!==(e=n.children)&&void 0!==e&&e.push(a)}return n},r);function r(t,e,i){this._viewerContainer=null,this._postfix="",this._pubsub=null,this._tabList=[],this._tabVNode=null,this._selectedTabId="",this._postfix=t,this._pubsub=e,this._viewerContainer=i}e.TabRender=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TabItem=void 0;var s=i(0),n=(o.prototype._init=function(t){if(s.isObject)for(var e=Object.keys(t),i=0;i<e.length;i++){var n=e[i];void 0!==n&&(this[n]=t[n])}},o);function o(t){this.id="",this.name="",this.type="",this.iconClass="",this._init(t)}e.TabItem=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasRender=void 0;var o=i(1),_=i(0),n=(s.prototype._query=function(t){var e,i;return null===(i=null===(e=this._viewerContainer)||void 0===e?void 0:e.el)||void 0===i?void 0:i.querySelector("#"+t+this._postfix)},s.prototype.canvasRenderInit=function(){this._createCanvas("main"),this._createCanvas("cropper"),this._createSlider()},s.prototype.updateCanvasInnerSize=function(){var t,e=this._query("canvasScroll"),i=null===(t=this._query("innerThumbnail"))||void 0===t?void 0:t.querySelector(".dvs-thumbLists");if(!e||!i)return!1;var n=e.offsetWidth||i.clientWidth,s=e.offsetHeight||i.clientHeight;if(0===n||0===s)return!1;this._pubsub.emit("_setCanvasSize",{width:n,height:s})},s.prototype.updateScrollSize=function(t){var e,i=t.width,n=t.height,s=t.x,o=t.y;if(0<i&&0<n){this._innerWidth=i,this._innerHeight=n;var r=this._query("scrollInner");r&&(r.style.width=i+"px",r.style.height=n+"px");var a=this._query("canvasWrapper"),l=this._query("canvasScroll");if(a&&l){var h=l.clientWidth,u=l.clientHeight;a.style.width=h+"px",a.style.height=u+"px";for(var d=_.devicePixelRatio(),c=null==a?void 0:a.children,p=0;p<c.length;p++){var v=c[p];"CANVAS"===v.tagName&&(v.width=h*d,v.height=u*d),v=null}}}s===this._scrollLeft&&o===this._scrollTop||((e=this._query("canvasScroll"))&&(this._scrollLeft=e.scrollLeft=s,this._scrollTop=e.scrollTop=o),e=null)},s.prototype._createSlider=function(){var t=this._query("viewPort");if(!t)return null;var e=document.createElement("div");e.className="dvs-slideWrapper";for(var i=0;i++<3;){var n=document.createElement("div"),s=document.createElement("img");n.className="dvs-slideItem",s.className="dvs-slideImg",n.appendChild(s),e.appendChild(n)}t.appendChild(e),t=null,this._pubsub.emit(o.privateEvent.BIND_SLIDE_COMPONENT,e),e=null},s.prototype._removeSlider=function(){var t=this._query("viewPort");if(!t)return null;var e=t.querySelector(".dvs-slideWrapper");this._pubsub.emit(o.privateEvent.UNBIND_SLIDE_COMPONENT),e&&t.removeChild(e),e=null},s.prototype._createCanvas=function(t){var e,i=this._query("canvasWrapper");if(!i)return null;var n=document.createElement("canvas");n.id=t+"Canvas"+this._postfix,n.className="dvs-canvas dvs-"+t,i.appendChild(n),this._pubsub.emit("_bindCanvas",((e={})[t]=n,e)),this._canvasList.push(t),n=null},s.prototype._removeCanvas=function(t){var e=this._query("canvasWrapper");if(!e)return null;var i=this._query(t+"Canvas");if(!i)return null;e.removeChild(i),this._pubsub.emit("_unbindCanvas",t);for(var n=0;n<this._canvasList.length;n++)if(this._canvasList[n]===t){this._canvasList.splice(n,1);break}},s.prototype.removeAllCanvas=function(){for(var t=0;t<this._canvasList.length;t++)this._removeCanvas(this._canvasList[t])&&t--;this._removeSlider()},s);function s(t){var e=t.postfix,i=t.pubsub,n=t.viewerContainer;this._postfix="",this._pubsub=null,this._viewerContainer=null,this._width=0,this._height=0,this._innerWidth=0,this._innerHeight=0,this._scrollLeft=0,this._scrollTop=0,this._canvasList=[],this._postfix=e,this._pubsub=i,this._viewerContainer=n}e.CanvasRender=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UiRender=void 0;var a=i(0),l=i(69),o=i(73),n=(s.prototype._myQueryById=function(t){var e,i;return null===(i=null===(e=this.viewerContainer)||void 0===e?void 0:e.el)||void 0===i?void 0:i.querySelector("#"+t)},s.prototype.initUi=function(t,e){if(e){if(!a.isObject(e))return!1;this._mergeConfig(e,this.uiConfig)}a.isString(t)&&(t=document.getElementById(t)),this._initComponents();var i=new l.ContainerItem(this._postfix,{name:"WebViewer"});return this._createContainers({header:{},body:{sidebar:{},showImageArea:{content:{topMenu:{},tabList:{},middle:{asideMenu:{},container:{viewPort:{canvasWrapper:{canvasEventLayer:{},loadingLayer:{loadingImage:"img"}},canvasScroll:{scrollInner:{}}},videoContainer:{videoImage:"img"},innerThumbnail:{}}},bottomMenu:{}}}},hiddenBox:{}},i.element),t.appendChild(i.element),this._components={},this.viewerContainer={el:i.element},this.viewerContainer},s.prototype._initComponents=function(){this._initGroups(this.uiConfig.groups),this._initButtons(this.uiConfig.buttons)},s.prototype._createContainers=function(t,e){for(var i in t){var n=null;(n="sidebar"===i?this._initSidebar():"hiddenBox"===i?this._initHiddenBox():new l.ContainerItem(this._postfix,{name:i,tagName:a.isString(t[i])?t[i]:void 0,visibility:void 0===this.uiConfig.toolbars[i]||this.uiConfig.toolbars[i]}).element)&&(this._createGroupsButtons(n,i),a.isObject(t[i])&&this._createContainers(t[i],n),e.appendChild(n))}return!0},s.prototype._initGroups=function(t){for(var e in t){var i=t[e],n=new l.GroupItem(this._postfix,{visibility:null==i?void 0:i.visibility,name:e,cssStyle:"dvs-"+e+" dvs-groupType",sequence:i.sequence,location:i.location});void 0===this._components[i.location]&&(this._components[i.location]=[]),void 0===this._components[e]&&(this._components[e]=[]),this._components[e].push(new l.ButtonItem(this._postfix,{visibility:!0,name:"showBefore"+e,cssStyle:"showMore ds-dvs-ui-iconfont showBefore",iconClass:"ds-dvs-ui-move_right",location:e,tagName:"span"})),this._components[e].push(new l.ButtonItem(this._postfix,{visibility:!0,name:"showAfter"+e,cssStyle:"showMore ds-dvs-ui-iconfont showAfter",iconClass:"ds-dvs-ui-move_left",location:e,tagName:"span"})),this._components[i.location].push(n)}},s.prototype._initButtons=function(s){var o=this,r=this;for(var t in s)!function(t){var e,i=s[t],n=r.uiConfig.tipsConfig;void 0===r._components[i.location]&&(r._components[i.location]=[]),"pagination"===t?[{name:"pagerInput",sequence:i.sequence,tagName:"input",text:"0"},{name:"pageBreak",sequence:i.sequence,tagName:"span",text:"|"},{name:"pagerLabel",sequence:i.sequence,tagName:"label",text:"0"}].forEach(function(t){o._components[i.location].push(new l.ButtonItem(o._postfix,{visibility:null==i?void 0:i.visibility,name:t.name,sequence:t.sequence,location:i.location,text:t.text||"",tagName:t.tagName,cssStyle:"dvs-"+t.name}))}):(e=new l.ButtonItem(r._postfix,{visibility:null==i?void 0:i.visibility,name:t,cssStyle:"ds-dvs-ui-iconfont dvs-iconColor"+(i.setClass?" "+i.setClass:""),sequence:i.sequence,location:i.location,callback:i.callback,buttonClick:i.onButtonClick,text:i.text,iconClass:i.iconClass||"dvs-emptyBtn",title:n[t]}),r._components[i.location].push(e))}(t)},s.prototype._createGroupsButtons=function(t,e){var i;if(0<(null===(i=this._components[e])||void 0===i?void 0:i.length))for(var n=this._components[e],s=0;s<this._components[e].length;s++){var o,r=n[s];r.visibility&&(t.appendChild(r.element),o=r.name,this._createGroupsButtons(r.element,o))}},s.prototype._initSidebar=function(){var t=this.uiConfig,e=0,i=t.tree&&t.tree.visibility,n=t.tag&&t.tag.visibility;if(!i&&!n)return null;var s=new l.ContainerItem(this._postfix,{name:"sidebar",visibility:t.showSidebar&&(i||n)}),o="",r='<ul id="navChange'+this._postfix+'" class="dvs-navChange">',a='<ul id="paneShow'+this._postfix+'"  class="dvs-paneShow">';return r+='<li id="DirctoryTreeNav'+this._postfix+'" sidetype="tree" class="dvs-DirctoryTreeNav'+(0===e?" activeTab":"")+" "+(i?"":"dvs-disabled")+'">\n    <div class="ds-dvs-ui-iconfont '+t.tree.iconClass+'"></div>\n    </li>',a+='<li id="DirctoryTree'+this._postfix+'" sidetype="tree" class="dvs-DirctoryTree'+(e?" dvs-nodisplay":"")+" "+(i?"":"dvs-disabled")+'">\n        <ul class="treeLists" id="treeLists'+this._postfix+"\"></ul>\n        <div id='addFolderBox"+this._postfix+"' class='dvs-addFolderBox'>\n          <div id='addFolder"+this._postfix+"' class='dvs-addFolder'>Add folder</div>\n        </div>\n        </li>\n        ",i&&e++,r+='<li id="TagsNav'+this._postfix+'" sidetype="tag" class="dvs-TagsNav'+(0===e?" activeTab":"")+" "+(n?"":"dvs-disabled")+' ">\n    <div class="ds-dvs-ui-iconfont '+t.tag.iconClass+'"></div>\n    </li>',a+='<li id="Tags'+this._postfix+'" sidetype="tag" class="dvs-Tags'+(e?" dvs-nodisplay":"")+" "+(n?"":"dvs-disabled")+'">\n       \n        <ul id="tagLists'+this._postfix+'" class="tagLists"></ul>\n        <div id=\'addTagBox'+this._postfix+"' class='dvs-addTagBox'>\n          <div id='addTag"+this._postfix+"' class='dvs-addTag'>Add tag</div>\n        </div>\n        </li>",n&&e++,o+=(r+="</ul>")+(a+="</ul>"),o+='<div id="stretchBar'+this._postfix+'" class="dvs-stretchBar"></div>',s.element.innerHTML=o,s.element},s.prototype._initHiddenBox=function(){return this.uiConfig,new l.ContainerItem(this._postfix,{name:"hiddenBox"}).element},s.prototype._mergeConfig=function(t,e){for(var i in t){var n=t[i],s=e[i];void 0===s?e[i]=t[i]:a.isBoolean(n)&&a.isObject(s)?s.visibility=n:a.isObject(n)&&a.isObject(s)?this._mergeConfig(t[i],e[i]):e[i]=t[i]}},s.prototype.bindContent=function(t){var e=this._myQueryById("content"+this._postfix),i=this._myQueryById("header"+this._postfix);if(!t||!i||!e)return!1;var n=document.createElement("div");return n.setAttribute("style","display:flex;flex-direction:column;width:100%;height:100%;"),n.id="contentContainer"+this._postfix,n.appendChild(i),n.appendChild(e),t.appendChild(n),this.contentContainer=n,!0},s.prototype.unbindContent=function(t){var e;void 0===t&&(t=!1);var i=null===(e=this.viewerContainer)||void 0===e?void 0:e.el,n=this.contentContainer;if(!i||!n)return!1;var s=n.querySelector("#content"+this._postfix),o=n.querySelector("#header"+this._postfix),r=this._myQueryById("showImageArea"+this._postfix);return o&&a.insertBefore(o,i.children[0],i),r&&s&&r.appendChild(s),n&&n.parentNode&&n.parentNode.removeChild(n),!(this.contentContainer=null)},s.prototype.createCustomElement=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=!1),a.isString(t)&&(t=document.getElementById(t)),!a.isElement(t))return null;var n=new o.CustomElementItem({el:t,sequence:e,isFull:i,pubsub:this._pubsub,container:this._myQueryById("container"+this._postfix)}),s=n.uid;return this._customElements[s]=n},s.prototype.removeAllCustomElements=function(){for(var t in this._customElements)this._customElements[t].element=null,this._customElements[t]=null;this._customElements=null},s);function s(t){var e=t.postfix,i=t.container,n=t.uiConfig,s=t.pubsub;this._postfix="",this._container=null,this.uiConfig=null,this._components={},this._customElements={},this.contentContainer=null,this.viewerContainer=null,this._postfix=e,this._pubsub=s,this._container=i,this.uiConfig=n,this.initUi(i)}e.UiRender=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerItem=e.ToolbarItem=e.GroupItem=e.ButtonItem=void 0;var n=i(70);Object.defineProperty(e,"ButtonItem",{enumerable:!0,get:function(){return n.ButtonItem}});var s=i(71);Object.defineProperty(e,"GroupItem",{enumerable:!0,get:function(){return s.GroupItem}});var o=i(72);Object.defineProperty(e,"ToolbarItem",{enumerable:!0,get:function(){return o.ToolbarItem}});var r=i(14);Object.defineProperty(e,"ContainerItem",{enumerable:!0,get:function(){return r.ContainerItem}})},function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.ButtonItem=void 0;var o,r=i(0),a=i(1),l=i(5),h=(o=l.BaseComponent,s(u,o),u.prototype._updateAttributes=function(t){var i=this;if(r.isElement(t)||(t=this.element),!t)return!1;t.className=((this.cssStyle||"")+" "+(this.iconClass||"")+" "+(this.visibility?"":"dvs-nodisplay")).trim(),t.id=""+(this.name+this._postfix),this.text&&("input"===this.tagName?t.value=this.text||"":t.innerText=this.text||"");var e=null==t?void 0:t.style;return"string"==typeof e.msFlexOrder?e.msFlexOrder=this.sequence:e.order=this.sequence,this.title&&(t.title=this.title),this.buttonClick||null!==this.callback?t.onclick=function(t){var e;null!==(e=i.callback)&&void 0!==e&&e.call(i,t),i.buttonClick&&i._pubsub.emit(a.uiEvent.CUSTOM_BUTTON_CLICK,i.buttonClick,t)}:t.onclick=null,!0},u);function u(t,e,i){var n=o.call(this,t,e,i)||this;return n.buttonClick="",n.callback=null,n.iconClass="",n.text="",n.title="",n}e.ButtonItem=h},function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.GroupItem=void 0;var o,r=i(0),a=i(5),l=(o=a.BaseComponent,s(h,o),h.prototype._updateAttributes=function(t){if(r.isElement(t)||(t=this.element),!t)return!1;t.className=this.cssStyle+" "+(this.visibility?"":"dvs-nodisplay"),t.id=""+(this.name+this._postfix);var e=null==t?void 0:t.style;return"string"==typeof e.msFlexOrder?e.msFlexOrder=this.sequence:e.order=this.sequence,!0},h);function h(t,e,i){return o.call(this,t,e,i)||this}e.GroupItem=l},function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.ToolbarItem=void 0;var o,r=i(5),a=(o=r.BaseComponent,s(l,o),l);function l(t,e,i){return o.call(this,t,e,i)||this}e.ToolbarItem=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CustomElementItem=void 0;var n=i(1),r=i(0),s=(o.prototype.show=function(){var t,e;return!this._visibility&&(this._visibility=!0,null!==(e=null===(t=this.element)||void 0===t?void 0:t.classList)&&void 0!==e&&e.remove("dvs-nodisplay"),this._pubsub.emit(n.uiEvent.VIEWER_RESIZE),!0)},o.prototype.hide=function(){var t,e;return!!this._visibility&&(this._visibility=!1,null!==(e=null===(t=this.element)||void 0===t?void 0:t.classList)&&void 0!==e&&e.add("dvs-nodisplay"),this._pubsub.emit(n.uiEvent.VIEWER_RESIZE),!0)},o.prototype.dispose=function(){var t,e;for(var i in null!==(e=null===(t=this.element)||void 0===t?void 0:t.parentNode)&&void 0!==e&&e.removeChild(this.element),this._pubsub.emit(n.uiEvent.VIEWER_RESIZE),this)delete this[i];return!0},o.prototype._bindElement=function(){var t=this._container;if(!t)return!1;var e=this.element;this.isFull?e.classList.add("dvs-upper-full"):e.classList.remove("dvs-upper-full"),e.style.order=String(this.sequence),e.style.msFlexOrder=String(this.sequence),e.classList.add("dvs-customElement"),this._visibility||e.classList.add("dvs-nodisplay"),t.appendChild(e),this._container=null,this._pubsub.emit(n.uiEvent.VIEWER_RESIZE)},o);function o(t){var e=t.el,i=t.sequence,n=t.isFull,s=t.pubsub,o=t.container;this.uid="",this.element=null,this.sequence=0,this.isFull=!1,this._visibility=!0,this.uid=r.uid(11),this.element=e,this.sequence=i,this._pubsub=s,this.isFull=n,this._container=o,this._bindElement()}e.CustomElementItem=s},function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,r,a,l){return new(a=a||Promise)(function(i,e){function n(t){try{o(l.next(t))}catch(t){e(t)}}function s(t){try{o(l.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?i(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(n,s)}o((l=l.apply(t,r||[])).next())})},d=this&&this.__generator||function(i,n){var s,o,r,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(r=2&e[0]?o.return:e[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,e[1])).done)return r;switch(o=0,r&&(e=[2&e[0],r.value]),e[0]){case 0:case 1:r=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(r=0<(r=a.trys).length&&r[r.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!r||e[1]>r[0]&&e[1]<r[3])){a.label=e[1];break}if(6===e[0]&&a.label<r[1]){a.label=r[1],r=e;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(e);break}r[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{s=r=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<i;e++)for(var o=arguments[e],r=0,a=o.length;r<a;r++,s++)n[s]=o[r];return n};Object.defineProperty(e,"__esModule",{value:!0}),e.CameraRender=void 0;var c=i(1),o=i(0),r=i(4),a=(l.prototype._initWebcam=function(t){this.webcam=new t},l.prototype.on=function(t,e){this._pubsub.on(t,e.bind(this))},l.prototype.emit=function(t){for(var e,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];(e=this._pubsub).emit.apply(e,s([t],i))},l.prototype.off=function(t,e){this._pubsub.off(t,e)},l.prototype.webcamOn=function(t,e){this.webcam.on(t,e)},l.prototype.captureCallback=function(){var i,n,s=this;this._isProcessing||(i=this.webcam,n=this._cropManager,this._isProcessing=!0,"document"===this._displayMode?i.detectArea().then(function(t){s.showEditUi();var e=i._video;s._fillMode?n.setPageSize(e.clientWidth/i.pixelRatio,e.clientHeight/i.pixelRatio):n.setPageSize(e.videoWidth,e.videoHeight),n.addFreeBox(t),i.drawSelectedArea(n.cropBoxes[0]),s._isProcessing=!1}):(i.pause(),i.capture().then(function(t){var e=URL.createObjectURL(t);s.showSaveUi(e),s._isProcessing=!1})))},l.prototype.backCallback=function(){var t;this._isProcessing||(t=this.webcam,"document"===this._displayMode?(this.showEditUi(),t.drawSelectedArea(this._cropManager.cropBoxes[0])):this.showHomeUi(!0))},l.prototype.remakeCallback=function(){this.showHomeUi(!0)},l.prototype.confirmCallback=function(){var t,e;this._isProcessing||(e=this._resultImgSrc,this.showHomeUi(),null!==(t=this._savePhotoCallback)&&void 0!==t&&t.call(this,e))},l.prototype.detectCallback=function(){if(!this._isProcessing){var t=this._queryEl(".detectBtn");if(!t)return!1;var e=t.classList.toggle("selectedBtn");e?this.webcam.bindRealTimeRender(5):this.webcam.unbindRealTimeRender(),this._isDetecting=e}},l.prototype.perspectiveCallback=function(){var t,e,i=this;this._isProcessing||(t=this._cropManager.cropBoxes[0].vertexes.slice(),e=this.webcam,this._isProcessing=!0,e.perspective(t).then(function(t){i.showSaveUi(t),i._isProcessing=!1}))},l.prototype.mouseMoveCallback=function(t){var e;if(this._isMouseDown){if("ontouchmove"in document.documentElement&&(t=null===(e=t.changedTouches)||void 0===e?void 0:e[0]),!t)return;var i=this._getPagePosition(t),n=i[0],s=i[1];this._cropManager.onMoveHandler(n,s,!0),this.webcamResize()}},l.prototype.mouseUpCallback=function(t){var e;if(this._isMouseDown){if(this._isMouseDown=!1,"ontouchend"in document.documentElement&&(t=null===(e=t.changedTouches)||void 0===e?void 0:e[0]),!t)return;var i=this._getPagePosition(t),n=i[0],s=i[1];this._cropManager.onEndHandler(n,s),this.webcamResize()}},l.prototype.mousedownCallback=function(t){var e;if("edit"===this._showPage){if(this._isMouseDown=!0,o.preventDefault(t),"ontouchstart"in document.documentElement&&(t=null===(e=t.changedTouches)||void 0===e?void 0:e[0]),!t)return;var i=this._getPagePosition(t),n=i[0],s=i[1];this._cropManager.onStartHandler(n,s,!0)}},l.prototype.showVideo=function(r,a,l,h,u){return void 0===h&&(h="picture"),void 0===u&&(u=!1),n(this,void 0,void 0,function(){var e,i,n,s,o=this;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,7,,8]),this._isProcessing=!0,i=r.element,this.webcam.bindUI(i,!0,u?"cover":"contain"),this.webcam._cvsDrawArea.onmousedown=this.webcam._cvsDrawArea.ontouchstart=function(t){o.mousedownCallback(t)},n=document.createElement("div"),(this._controlBox=n).id="controlBox"+this._postfix,n.className="camera-controlBox",i.appendChild(this._controlBox),a?[4,this.webcam.selectSource(a)]:[3,2];case 1:t.sent(),t.label=2;case 2:return l&&l.width&&l.height?[4,this.webcam.play(void 0,l.width,l.height)]:[3,4];case 3:return e=t.sent(),[3,6];case 4:return[4,this.webcam.play()];case 5:e=t.sent(),t.label=6;case 6:return this.isVideoShow=!0,[3,8];case 7:return s=t.sent(),r.dispose(),this.isVideoShow=!1,this._isProcessing=!1,[2,Promise.reject(s)];case 8:return r.show(),this._displayMode=h,this._fillMode=u,this._hideToolbars(),this.showHomeUi(),this._isProcessing=!1,this.emit(c.uiEvent.VIEWER_RESIZE),[2,e]}})})},l.prototype.showHomeUi=function(t){void 0===t&&(t=!1);var e,i=this._controlBox;i&&(this._showPage="home",(e=this.webcam)._video.style.width=null,i.className="camera-controlBox dvs-homeControl",this._fillMode&&i.classList.add("dvs-suspend"),t&&(URL.revokeObjectURL(this._resultImgSrc),this._resultImgSrc=""),this._cropManager.clear(),e.resume(),"picture"===this._displayMode?e.bindControlBox(i,{detectBtn:{className:"camera-empty",iconClass:"",onButtonClick:""}}):e.bindControlBox(i),e.hideResultImage(),this.webcamResize(),this._isDetecting&&this.detectCallback())},l.prototype.showEditUi=function(){var t,e,i,n=this._controlBox;n&&(this._showPage="edit",t=this.webcam,n.className="camera-controlBox dvs-editControl",t.pause(),t.bindConfirmBox(n),t.unbindRealTimeRender(),t.hideResultImage(),this._fillMode&&(e=t._video,i=this._queryEl(".dvs-cameraContainer"),e.style.width=i.clientWidth*e.clientHeight/i.clientHeight+"px"),this.webcamResize())},l.prototype.showSaveUi=function(t){var e,i=this._controlBox;i&&(this._showPage="save",e=this.webcam,i.className="camera-controlBox dvs-saveControl","picture"===this._displayMode?e.bindSaveBox(i,{remakeBtn:{className:"camera-saveEmpty",iconClass:"",onButtonClick:""}}):e.bindSaveBox(i),this._resultImgSrc=t,e.unbindRealTimeRender(),e.showResultImage(t),this.webcamResize())},l.prototype.closeVideo=function(){var t;this.isVideoShow&&(this.isVideoShow=!1,this._showPage="",(t=this.webcam).stop(),this._showToolbars(),t.unbindRealTimeRender(),t.emptyTempCanvas(),URL.revokeObjectURL(this._resultImgSrc),this._resultImgSrc="",this._isDetecting=!1,this.emit("video-closed"),this.emit(c.uiEvent.VIEWER_RESIZE),this.emit(c.uiEvent.UPDATE_PAGES_LAYOUT),this.emit(c.uiEvent.SHOW_LATEST_PAGE))},l.prototype.webcamResize=function(){var t=this.webcam;t&&(this._cropManager.setZoom(t.pixelRatio),t.webcamResize())},l.prototype.drawSelectedArea=function(){this._cropManager.cropBoxes.length&&"edit"===this._showPage&&this.webcam.drawSelectedArea(this._cropManager.cropBoxes[0])},l.prototype.bindAreaDetectFunction=function(t){return this.webcam.bindAreaDetectFunction(t)},l.prototype.bindPerspectiveFunction=function(t){return this.webcam.bindPerspectiveFunction(t)},l.prototype.bindLicenseCallback=function(t){return this.webcam.bindLicenseCallback(t)},l.prototype.bindSavePhotoCallback=function(t){return this._savePhotoCallback=t,!0},l.prototype._hideToolbars=function(){var t,e,i,n,s,o,r,a,l,h=this._queryEl("#header"+this._postfix),u=this._queryEl("#topMenu"+this._postfix),d=this._queryEl("#bottomMenu"+this._postfix),c=this._queryEl("#viewPort"+this._postfix),p=this._queryEl("#videoContainer"+this._postfix);if(h&&null!==(t=h.classList)&&void 0!==t&&t.add("dvs-hideToolbars"),u&&null!==(e=u.classList)&&void 0!==e&&e.add("dvs-hideToolbars"),d&&null!==(i=d.classList)&&void 0!==i&&i.add("dvs-hideToolbars"),c&&null!==(n=c.classList)&&void 0!==n&&n.add("dvs-hideToolbars"),p&&null!==(s=p.classList)&&void 0!==s&&s.remove("dvs-hideToolbars"),(null===(o=window.screen)||void 0===o?void 0:o.availWidth)<500){var v=null===(a=null===(r=this._viewerContainer)||void 0===r?void 0:r.el)||void 0===a?void 0:a.querySelectorAll(".dvs-Thumbnail");if(v){for(var _=0;_<v.length;_++)null!==(l=v[_])&&void 0!==l&&l.classList.add("dvs-hideToolbars");this.emit("onSetSplitBar")}}},l.prototype._showToolbars=function(){var t,e,i,n,s,o,r,a,l,h=this._queryEl("#header"+this._postfix),u=this._queryEl("#topMenu"+this._postfix),d=this._queryEl("#bottomMenu"+this._postfix),c=this._queryEl("#viewPort"+this._postfix),p=this._queryEl("#videoContainer"+this._postfix);if(h&&null!==(t=h.classList)&&void 0!==t&&t.remove("dvs-hideToolbars"),u&&null!==(e=u.classList)&&void 0!==e&&e.remove("dvs-hideToolbars"),d&&null!==(i=d.classList)&&void 0!==i&&i.remove("dvs-hideToolbars"),c&&null!==(n=c.classList)&&void 0!==n&&n.remove("dvs-hideToolbars"),p&&null!==(s=p.classList)&&void 0!==s&&s.remove("dvs-hideToolbars"),(null===(o=window.screen)||void 0===o?void 0:o.availWidth)<500){var v=null===(a=null===(r=this._viewerContainer)||void 0===r?void 0:r.el)||void 0===a?void 0:a.querySelectorAll(".dvs-Thumbnail");if(v){for(var _=0;_<v.length;_++)null!==(l=v[_])&&void 0!==l&&l.classList.remove("dvs-hideToolbars");this.emit("onSetSplitBar")}}},l.prototype._queryEl=function(t){var e,i;return null===(i=null===(e=this._viewerContainer)||void 0===e?void 0:e.el)||void 0===i?void 0:i.querySelector(t)},l.prototype._getPagePosition=function(t){var e=this.webcam,i=this.webcam._cvsDrawArea.getBoundingClientRect(),n=t.clientX-i.left,s=t.clientY-i.top;return e.getRealPosition(n,s)},l);function l(t,e){var i=e.pubsub,n=e.viewerContainer,s=e.postfix;this.webcam=null,this.isVideoShow=!1,this._pubsub=null,this._viewerContainer=null,this._savePhotoCallback=null,this._resultImgSrc="",this._displayMode="picture",this._fillMode=!1,this._showPage="",this._controlBox=null,this._cropManager=new r.CropManager(0,0),this._isDetecting=!1,this._isMouseDown=!1,this._isProcessing=!1,this._pubsub=i,this._viewerContainer=n,this._postfix=s,this._initWebcam(t)}e.CameraRender=a}]);