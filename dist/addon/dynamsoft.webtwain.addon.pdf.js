/*
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: http://www.dynamsoft.com
*
* Copyright 2019, Dynamsoft Corporation 
* Author: Dynamsoft R&D Department
*
* Version: 14.3.1
*
* Module: addon/pdf
* final js: build\addon\dynamsoft.webtwain.addon.pdf.js
*/
Dynamsoft.PdfVerForActiveX="10.3.0.0712";Dynamsoft.PdfVerInName="10.3.0.0712";var EnumDWT_ConvertMode={CM_DEFAULT:0,CM_RENDERALL:1,CM_AUTO:1};(function(b){if(!b.product.bChromeEdition){return}var a;var c=function(e){var f=b.html5.Funs,d;if(b.env.bMac){a="libDynamicPdf_"+Dynamsoft.PdfVerInName+".dylib"}else{if(b.env.bLinux){a="libDynamicPdf_"+Dynamsoft.PdfVerInName+".so"}else{if(dynamsoft.dcp.b64bit){a="DynamicPdfx64_"+Dynamsoft.PdfVerInName+".dll"}else{a="DynamicPdf_"+Dynamsoft.PdfVerInName+".dll"}}}e._innerSend("GetAddOnVersion",f.makeParams("pdf",a),true,false,false);d={PDF:{IsModuleInstalled:function(){var g=e._innerFun("GetAddOnVersion",f.makeParams("pdf",a));return(g!="")},Download:function(k,n,g){var j=e,l;Dynamsoft.Lib.cancelFrome=2;var i=function(){if(Dynamsoft.Lib.isFunction(n)){n()}return true},o=function(){if(Dynamsoft.Lib.isFunction(g)){g(j.ErrorCode,j.ErrorString)}return false};if(!b.License.checkProductKey(j,{Core:true})){return o()}if(!b.License.checkProductKey(j,{PDFRasterizer:true},true)){return o()}if(this.IsModuleInstalled()){i();return true}if(!k||k==""){Dynamsoft.Lib.Errors.Pdf_InvalidRemoteFilename(j);o();return false}if(f.isServerInvalid(j)){o();return false}l="get";Dynamsoft.Lib.showProgress(j,"Download",true);var m=function(q){var r=(q.total===0)?100:Math.round(q.loaded*100/q.total),s=[q.loaded," / ",q.total].join("");j._OnPercentDone([0,r,"","http"])},h=true;j._OnPercentDone([0,-1,"Downloading PDF Rasterizer Module...","http"]);if(!Dynamsoft.Lib.isFunction(n)){h=false}return f.loadHttpBlob(j,l,k,h,function(p){j._OnPercentDone([0,-1,"Loading..."]);var q=100;j.__LoadImageFromBytes(p,q,"",h,i,o)},function(){Dynamsoft.Lib.closeProgress("Download");o()},m)},ConvertToImage:function(j,n,h,k){var l=f.replaceLocalFilename(j);var g="ConvertPDFToImage";var i=function(m){f.hideMask(g);if(h){h()}return true},o=function(m){f.hideMask(g);if(k){k()}return false};f.showMask(g);e._innerSend(g,f.makeParams(l,n),true,i,o);return true},SetPassword:function(g){return e._innerFun("SetPDFPassword",f.makeParams(g))},SetConvertMode:function(g){var h=g*1;if(isNaN(h)){b.Errors.ParameterCannotEmpty(e);return false}if(h==2){h=EnumDWT_ConvertMode.CM_RENDERALL}if(h==EnumDWT_ConvertMode.CM_RENDERALL){if(!b.License.checkProductKey(e,{PDFRasterizer:true},true)){return false}}return e._innerFun("SetPDFConvertMode",f.makeParams(h,a))},GetConvertMode:function(){return e._innerFun("GetPDFConvertMode")},SetResolution:function(g){return e._innerFun("SetPDFResolution",f.makeParams(g))},IsTextBasedPDF:function(g){var h=f.replaceLocalFilename(g);return e._innerFun("IsTextBasedPDF",f.makeParams(h))}}};e.__addon=e.__addon||{};b.mix(e.__addon,d)};if(b.DynamicLoadAddonFuns){b.DynamicLoadAddonFuns.push(c)}})(Dynamsoft.Lib);(function(a){if(!a.product.bPluginEdition&&!a.product.bActiveXEdition){return}var b=function(h){var e,i,d;if(h.getSWebTwain()&&h.getSWebTwain().Addon){}else{return false}if(a.env.bWin){var g=navigator.userAgent.toLowerCase(),c=!dynamsoft.navInfo.isX64||(g.indexOf("wow64")>=0);if(c){d="DynamicPdf_"+Dynamsoft.PdfVerForActiveX+".dll"}else{d="DynamicPdfx64_"+Dynamsoft.PdfVerForActiveX+".dll"}}else{}i=h.getSWebTwain();try{i.GetAddOnVersion("pdf",d)}catch(f){}e={PDF:{IsModuleInstalled:function(){var j=i.GetAddOnVersion("pdf",d);a.setErrorString(h);return(j!="")},Download:function(o,j,m){var k=function(){if(Dynamsoft.Lib.isFunction(j)){j()}return true},n=function(){if(Dynamsoft.Lib.isFunction(m)){m(i.ErrorCode,i.ErrorString)}return false};if(this.IsModuleInstalled()){return k()}if(!a.License.checkProductKey(i,{Core:true})){return n()}if(!a.License.checkProductKey(i,{PDFRasterizer:true},true)){return n()}var l=i.DownloadAddon(o);return a.wrapperRet(h,l,k,n)},ConvertToImage:function(k,n,j,m){var l=i.ConvertPDFToImage(k,n);return a.wrapperRet(h,l,j,m)},SetPassword:function(j){var k=i.SetPDFPassword(j);return a.wrapperRet(h,k)},SetConvertMode:function(k){var l=k*1;if(isNaN(l)){a.Errors.ParameterCannotEmpty(h);return false}if(l==2){l=EnumDWT_ConvertMode.CM_RENDERALL}if(l==EnumDWT_ConvertMode.CM_RENDERALL){if(!a.License.checkProductKey(h,{PDFRasterizer:true},true)){return false}}var j=i.SetPDFConvertMode(l);return a.wrapperRet(h,j)},GetConvertMode:function(){var j=i.GetPDFConvertMode();return a.wrapperRet(h,j)},SetResolution:function(k){var j=i.SetPDFResolution(k);return a.wrapperRet(h,j)},IsTextBasedPDF:function(j){var k=i.IsTextBasedPDF(j);return a.wrapperRet(h,k)}}};h.Addon=h.Addon||{};a.mix(h.Addon,e)};if(a.DynamicLoadAddonFuns){a.DynamicLoadAddonFuns.push(b)}})(Dynamsoft.Lib);
