'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,f){a!=Array.prototype&&a!=Object.prototype&&(a[b]=f.value)};
$jscomp.polyfill=function(a,b,f,m){if(b){f=$jscomp.global;a=a.split(".");for(m=0;m<a.length-1;m++){var n=a[m];n in f||(f[n]={});f=f[n]}a=a[a.length-1];m=f[a];b=b(m);b!=m&&null!=b&&$jscomp.defineProperty(f,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function f(a){return a instanceof n?a:new n(function(b,r){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var m=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){m(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var f=a[b];a[b]=null;try{f()}catch(A){this.asyncThrow_(A)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var n=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(H){b.reject(H)}};n.prototype.createResolveAndReject_=function(){function a(a){return function(r){f||(f=!0,a.call(b,r))}}var b=this,f=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};n.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof n)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};n.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(H){this.reject_(H);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};n.prototype.reject_=function(a){this.settle_(2,a)};n.prototype.fulfill_=function(a){this.settle_(1,a)};n.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};n.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)u.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var u=new b;n.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};n.prototype.settleSameAsThenable_=function(a,b){var f=this.createResolveAndReject_();try{a.call(b,f.resolve,f.reject)}catch(A){f.reject(A)}};n.prototype.then=function(a,b){function f(a,b){return"function"==typeof a?function(b){try{m(a(b))}catch(V){r(V)}}:b}var m,r,u=new n(function(a,b){m=a;r=b});this.callWhenSettled_(f(a,m),f(b,r));return u};
n.prototype.catch=function(a){return this.then(void 0,a)};n.prototype.callWhenSettled_=function(a,b){function f(){switch(m.state_){case 1:a(m.result_);break;case 2:b(m.result_);break;default:throw Error("Unexpected state: "+m.state_);}}var m=this;null==this.onSettledCallbacks_?u.asyncExecute(f):this.onSettledCallbacks_.push(f)};n.resolve=f;n.reject=function(a){return new n(function(b,f){f(a)})};n.race=function(a){return new n(function(b,m){for(var n=$jscomp.makeIterator(a),r=n.next();!r.done;r=n.next())f(r.value).callWhenSettled_(b,
m)})};n.all=function(a){var b=$jscomp.makeIterator(a),m=b.next();return m.done?f([]):new n(function(a,n){function r(b){return function(f){u[b]=f;A--;0==A&&a(u)}}var u=[],A=0;do u.push(void 0),A++,f(m.value).callWhenSettled_(r(u.length-1),n),m=b.next();while(!m.done)})};return n},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(f){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(f||"")+"_"+b++,f)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(f){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var f=a.next();$jscomp.generator.ensureIteratorResultIsObject_(f);if(f.done)this.yieldResult=f.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(f.value,b)};
$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,f){f?this.finallyContexts_[f]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(a){return{value:a,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,f){try{var m=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(m);if(!m.done)return this.context_.stop_(),m;var n=m.value}catch(u){return this.context_.yieldAllIterator_=null,this.context_.throw_(u),this.nextStep_()}this.context_.yieldAllIterator_=null;f.call(this.context_,n);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(b){return a.next(b)}function f(b){return a.throw(b)}return new Promise(function(m,n){function u(a){a.done?m(a.value):Promise.resolve(a.value).then(b,f).then(u,n)}u(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
(()=>{const a=!!("object"==typeof global&&global.process&&global.process.release&&global.process.release.name);let b;a&&(b=require("worker_threads"));let f=a?b.parentPort:self,m,n,u,r,ha,H,A=!1,L=!1,M,Y,Z,Q="https://dbrjsauth.dynamsoft.com/v2/",V,ia,C,aa=Promise.resolve();a||!function(a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define([],a):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?
self:this).localforage=a()}(function(){return function w(a,b,f){function g(d,B){if(!b[d]){if(!a[d]){var q="function"==typeof require&&require;if(!B&&q)return q(d,!0);if(h)return h(d,!0);B=Error("Cannot find module '"+d+"'");throw B.code="MODULE_NOT_FOUND",B;}B=b[d]={exports:{}};a[d][0].call(B.exports,function(b){return g(a[d][1][b]||b)},B,B.exports,w,a,b,f)}return b[d].exports}for(var h="function"==typeof require&&require,d=0;d<f.length;d++)g(f[d]);return g}({1:[function(a,b,f){(function(a){function f(){n=
!0;for(var a,b,d=t.length;d;){b=t;t=[];for(a=-1;++a<d;)b[a]();d=t.length}n=!1}var g=a.MutationObserver||a.WebKitMutationObserver;if(g){var d=0;g=new g(f);var q=a.document.createTextNode("");g.observe(q,{characterData:!0});var h=function(){q.data=d=++d%2}}else if(a.setImmediate||void 0===a.MessageChannel)h="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var b=a.document.createElement("script");b.onreadystatechange=function(){f();b.onreadystatechange=null;b.parentNode.removeChild(b);
b=null};a.document.documentElement.appendChild(b)}:function(){setTimeout(f,0)};else{var m=new a.MessageChannel;m.port1.onmessage=f;h=function(){m.port2.postMessage(0)}}var n,t=[];b.exports=function(a){1!==t.push(a)||n||h()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(a,b,f){function g(){}function h(a){if("function"!=typeof a)throw new TypeError("resolver must be a function");this.state=v;this.queue=[];this.outcome=
void 0;a!==g&&t(this,a)}function m(a,b,d){this.promise=a;"function"==typeof b&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled);"function"==typeof d&&(this.onRejected=d,this.callRejected=this.otherCallRejected)}function d(a,b,d){r(function(){try{var f=b(d)}catch(E){return x.reject(a,E)}f===a?x.reject(a,new TypeError("Cannot resolve promise with itself")):x.resolve(a,f)})}function q(a){var b=a&&a.then;if(a&&("object"==typeof a||"function"==typeof a)&&"function"==typeof b)return function(){b.apply(a,
arguments)}}function t(a,b){function d(b){g||(g=!0,x.reject(a,b))}function f(b){g||(g=!0,x.resolve(a,b))}var g=!1,h=n(function(){b(f,d)});"error"===h.status&&d(h.value)}function n(a,b){var d={};try{d.value=a(b),d.status="success"}catch(va){d.status="error",d.value=va}return d}var r=a(1),x={},u=["REJECTED"],R=["FULFILLED"],v=["PENDING"];b.exports=h;h.prototype.catch=function(a){return this.then(null,a)};h.prototype.then=function(a,b){if("function"!=typeof a&&this.state===R||"function"!=typeof b&&this.state===
u)return this;var f=new this.constructor(g);this.state!==v?d(f,this.state===R?a:b,this.outcome):this.queue.push(new m(f,a,b));return f};m.prototype.callFulfilled=function(a){x.resolve(this.promise,a)};m.prototype.otherCallFulfilled=function(a){d(this.promise,this.onFulfilled,a)};m.prototype.callRejected=function(a){x.reject(this.promise,a)};m.prototype.otherCallRejected=function(a){d(this.promise,this.onRejected,a)};x.resolve=function(a,b){var d=n(q,b);if("error"===d.status)return x.reject(a,d.value);
if(d=d.value)t(a,d);else{a.state=R;a.outcome=b;d=-1;for(var f=a.queue.length;++d<f;)a.queue[d].callFulfilled(b)}return a};x.reject=function(a,b){a.state=u;a.outcome=b;for(var d=-1,f=a.queue.length;++d<f;)a.queue[d].callRejected(b);return a};h.resolve=function(a){return a instanceof this?a:x.resolve(new this(g),a)};h.reject=function(a){var b=new this(g);return x.reject(b,a)};h.all=function(a){function b(a,b){d.resolve(a).then(function(a){q[b]=a;++m!==f||h||(h=!0,x.resolve(t,q))},function(a){h||(h=
!0,x.reject(t,a))})}var d=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var f=a.length,h=!1;if(!f)return this.resolve([]);for(var q=Array(f),m=0,B=-1,t=new this(g);++B<f;)b(a[B],B);return t};h.race=function(a){function b(a){d.resolve(a).then(function(a){h||(h=!0,x.resolve(m,a))},function(a){h||(h=!0,x.reject(m,a))})}var d=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));
var f=a.length,h=!1;if(!f)return this.resolve([]);for(var q=-1,m=new this(g);++q<f;)b(a[q]);return m}},{1:1}],3:[function(a,b,f){b="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};"function"!=typeof b.Promise&&(b.Promise=a(2))},{2:2}],4:[function(a,b,f){function h(c,a){c=c||[];a=a||{};try{return new Blob(c,a)}catch(z){if("TypeError"!==z.name)throw z;for(var e=new ("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:
"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),b=0;b<c.length;b+=1)e.append(c[b]);return e.getBlob(a.type)}}function g(c,a){a&&c.then(function(c){a(null,c)},function(c){a(c)})}function m(c,a,k){"function"==typeof a&&c.then(a);"function"==typeof k&&c.catch(k)}function d(c){return"string"!=typeof c&&(console.warn(c+" used as a key, but it is not a string."),c=String(c)),c}function q(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-
1]}function t(c){return(new p(function(a){var e=c.transaction(S,ka),b=h([""]);e.objectStore(S).put(b,"key");e.onabort=function(c){c.preventDefault();c.stopPropagation();a(!1)};e.oncomplete=function(){var c=navigator.userAgent.match(/Chrome\/(\d+)/),e=navigator.userAgent.match(/Edge\//);a(e||!c||43<=parseInt(c[1],10))}})).catch(function(){return!1})}function n(c){return"boolean"==typeof U?p.resolve(U):t(c).then(function(c){return U=c})}function r(c){c=D[c.name];var a={};a.promise=new p(function(c,
e){a.resolve=c;a.reject=e});c.deferredOperations.push(a);c.dbReady?c.dbReady=c.dbReady.then(function(){return a.promise}):c.dbReady=a.promise}function x(c){if(c=D[c.name].deferredOperations.pop())return c.resolve(),c.promise}function u(c,a){if(c=D[c.name].deferredOperations.pop())return c.reject(a),c.promise}function v(c,a){return new p(function(e,b){if(D[c.name]=D[c.name]||H(),c.db){if(!a)return e(c.db);r(c);c.db.close()}var k=[c.name];a&&k.push(c.version);var l=ba.open.apply(ba,k);a&&(l.onupgradeneeded=
function(a){var e=l.result;try{e.createObjectStore(c.storeName),1>=a.oldVersion&&e.createObjectStore(S)}catch(I){if("ConstraintError"!==I.name)throw I;console.warn('The database "'+c.name+'" has been upgraded from version '+a.oldVersion+" to version "+a.newVersion+', but the storage "'+c.storeName+'" already exists.')}});l.onerror=function(a){a.preventDefault();b(l.error)};l.onsuccess=function(){e(l.result);x(c)}})}function y(a,e){if(!a.db)return!0;var c=!a.db.objectStoreNames.contains(a.storeName),
b=a.version>a.db.version;return(a.version<a.db.version&&(a.version!==e&&console.warn('The database "'+a.name+"\" can't be downgraded from version "+a.db.version+" to version "+a.version+"."),a.version=a.db.version),b||c)?(c&&(e=a.db.version+1,e>a.version&&(a.version=e)),!0):!1}function A(a){return new p(function(c,k){var e=new FileReader;e.onerror=k;e.onloadend=function(e){e=btoa(e.target.result||"");c({__local_forage_encoded_blob:!0,data:e,type:a.type})};e.readAsBinaryString(a)})}function C(a){for(var c=
atob(a.data),k=c.length,b=new ArrayBuffer(k),d=new Uint8Array(b),l=0;l<k;l++)d[l]=c.charCodeAt(l);return h([b],{type:a.type})}function F(a){var c=this,k=c._initReady().then(function(){var a=D[c._dbInfo.name];if(a&&a.dbReady)return a.dbReady});return m(k,a,a),k}function J(a){r(a);for(var c=D[a.name],k=c.forages,b=0;b<k.length;b++){var d=k[b];d._dbInfo.db&&(d._dbInfo.db.close(),d._dbInfo.db=null)}return a.db=null,v(a,!1).then(function(c){return a.db=c,y(a)?v(a,!0):c}).then(function(e){a.db=c.db=e;for(var b=
0;b<k.length;b++)k[b]._dbInfo.db=e}).catch(function(c){throw u(a,c),c;})}function E(a,e,k,b){void 0===b&&(b=1);try{var c=a.db.transaction(a.storeName,e);k(null,c)}catch(l){if(0<b&&(!a.db||"InvalidStateError"===l.name||"NotFoundError"===l.name))return p.resolve().then(function(){if(!a.db||"NotFoundError"===l.name&&!a.db.objectStoreNames.contains(a.storeName)&&a.version<=a.db.version)return a.db&&(a.version=a.db.version+1),v(a,!0)}).then(function(){return J(a).then(function(){E(a,e,k,b-1)})}).catch(k);
k(l)}}function H(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function K(a){var c=.75*a.length;var k=a.length,b=0;"="===a[a.length-1]&&(c--,"="===a[a.length-2]&&c--);var d=new ArrayBuffer(c),l=new Uint8Array(d);for(c=0;c<k;c+=4){var f=O.indexOf(a[c]);var g=O.indexOf(a[c+1]);var I=O.indexOf(a[c+2]);var h=O.indexOf(a[c+3]);l[b++]=f<<2|g>>4;l[b++]=(15&g)<<4|I>>2;l[b++]=(3&I)<<6|63&h}return d}function G(a){var c=new Uint8Array(a),k="";for(a=0;a<c.length;a+=3)k+=O[c[a]>>2],k+=O[(3&c[a])<<
4|c[a+1]>>4],k+=O[(15&c[a+1])<<2|c[a+2]>>6],k+=O[63&c[a+2]];return 2==c.length%3?k=k.substring(0,k.length-1)+"=":1==c.length%3&&(k=k.substring(0,k.length-2)+"=="),k}function L(a,e,k,b){a.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],k,b)}function N(a,e,k,b,d,l){a.executeSql(k,b,d,function(a,c){c.code===c.SYNTAX_ERR?a.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],function(a,ja){ja.rows.length?l(a,c):
L(a,e,function(){a.executeSql(k,b,d,l)},l)},l):l(a,c)},l)}function P(a,b,k,ja){var c=this;a=d(a);var e=new p(function(e,d){c.ready().then(function(){void 0===b&&(b=null);var l=b,z=c._dbInfo;z.serializer.serialize(b,function(b,g){g?d(g):z.db.transaction(function(c){N(c,z,"INSERT OR REPLACE INTO "+z.storeName+" (key, value) VALUES (?, ?)",[a,b],function(){e(l)},function(a,c){d(c)})},function(b){if(b.code===b.QUOTA_ERR){if(0<ja)return void e(P.apply(c,[a,l,k,ja-1]));d(b)}})})}).catch(d)});return g(e,
k),e}function T(a){return new p(function(c,b){a.transaction(function(e){e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(b,e){b=[];for(var k=0;k<e.rows.length;k++)b.push(e.rows.item(k).name);c({db:a,storeNames:b})},function(a,c){b(c)})},function(a){b(a)})})}function Q(a,b){var c=a.name+"/";return a.storeName!==b.storeName&&(c+=a.storeName+"/"),c}function V(a,b){a[b]=function(){var c=arguments;return a.ready().then(function(){return a[b].apply(a,
c)})}}function M(){for(var a=1;a<arguments.length;a++){var b=arguments[a];if(b)for(var k in b)b.hasOwnProperty(k)&&(aa(b[k])?arguments[0][k]=b[k].slice():arguments[0][k]=b[k])}return arguments[0]}var fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ba=function(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;
if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}();"undefined"==typeof Promise&&a(3);var p=Promise,S="local-forage-detect-blob-support",U=void 0,D={},ha=Object.prototype.toString,ka="readwrite";a={_driver:"asyncStorage",_initStorage:function(a){function c(){return p.resolve()}var b=this,d={db:null};if(a)for(var z in a)d[z]=a[z];var l=D[d.name];l||(l=H(),D[d.name]=l);l.forages.push(b);
b._initReady||(b._initReady=b.ready,b.ready=F);a=[];for(z=0;z<l.forages.length;z++){var g=l.forages[z];g!==b&&a.push(g._initReady().catch(c))}var f=l.forages.slice(0);return p.all(a).then(function(){return d.db=l.db,v(d,!1)}).then(function(a){return d.db=a,y(d,b._defaultConfig.version)?v(d,!0):a}).then(function(a){d.db=l.db=a;b._dbInfo=d;for(a=0;a<f.length;a++){var c=f[a];c!==b&&(c._dbInfo.db=d.db,c._dbInfo.version=d.version)}})},_support:function(){try{if(!ba)return!1;var a="undefined"!=typeof openDatabase&&
/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),b="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!a||b)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(k){return!1}}(),iterate:function(a,b){var c=this,e=new p(function(b,e){c.ready().then(function(){E(c._dbInfo,"readonly",function(k,d){if(k)return e(k);try{var l=d.objectStore(c._dbInfo.storeName).openCursor(),g=1;
l.onsuccess=function(){var c=l.result;if(c){var e=c.value;e&&e.__local_forage_encoded_blob&&(e=C(e));e=a(e,c.key,g++);void 0!==e?b(e):c.continue()}else b()};l.onerror=function(){e(l.error)}}catch(oa){e(oa)}})}).catch(e)});return g(e,b),e},getItem:function(a,b){var c=this;a=d(a);var e=new p(function(b,e){c.ready().then(function(){E(c._dbInfo,"readonly",function(k,d){if(k)return e(k);try{var l=d.objectStore(c._dbInfo.storeName).get(a);l.onsuccess=function(){var a=l.result;void 0===a&&(a=null);a&&a.__local_forage_encoded_blob&&
(a=C(a));b(a)};l.onerror=function(){e(l.error)}}catch(ca){e(ca)}})}).catch(e)});return g(e,b),e},setItem:function(a,b,k){var c=this;a=d(a);var e=new p(function(e,k){var d;c.ready().then(function(){return d=c._dbInfo,"[object Blob]"===ha.call(b)?n(d.db).then(function(a){return a?b:A(b)}):b}).then(function(b){E(c._dbInfo,ka,function(d,l){if(d)return k(d);try{var g=l.objectStore(c._dbInfo.storeName);null===b&&(b=void 0);var f=g.put(b,a);l.oncomplete=function(){void 0===b&&(b=null);e(b)};l.onabort=l.onerror=
function(){k(f.error?f.error:f.transaction.error)}}catch(pa){k(pa)}})}).catch(k)});return g(e,k),e},removeItem:function(a,b){var c=this;a=d(a);var e=new p(function(b,e){c.ready().then(function(){E(c._dbInfo,ka,function(k,d){if(k)return e(k);try{var l=d.objectStore(c._dbInfo.storeName).delete(a);d.oncomplete=function(){b()};d.onerror=function(){e(l.error)};d.onabort=function(){e(l.error?l.error:l.transaction.error)}}catch(ca){e(ca)}})}).catch(e)});return g(e,b),e},clear:function(a){var c=this,b=new p(function(a,
b){c.ready().then(function(){E(c._dbInfo,ka,function(e,k){if(e)return b(e);try{var d=k.objectStore(c._dbInfo.storeName).clear();k.oncomplete=function(){a()};k.onabort=k.onerror=function(){b(d.error?d.error:d.transaction.error)}}catch(I){b(I)}})}).catch(b)});return g(b,a),b},length:function(a){var c=this,b=new p(function(a,b){c.ready().then(function(){E(c._dbInfo,"readonly",function(e,k){if(e)return b(e);try{var d=k.objectStore(c._dbInfo.storeName).count();d.onsuccess=function(){a(d.result)};d.onerror=
function(){b(d.error)}}catch(I){b(I)}})}).catch(b)});return g(b,a),b},key:function(a,b){var c=this,e=new p(function(b,e){if(0>a)return void b(null);c.ready().then(function(){E(c._dbInfo,"readonly",function(k,d){if(k)return e(k);try{var l=!1,g=d.objectStore(c._dbInfo.storeName).openCursor();g.onsuccess=function(){var c=g.result;if(!c)return void b(null);0===a?b(c.key):l?b(c.key):(l=!0,c.advance(a))};g.onerror=function(){e(g.error)}}catch(oa){e(oa)}})}).catch(e)});return g(e,b),e},keys:function(a){var c=
this,b=new p(function(a,b){c.ready().then(function(){E(c._dbInfo,"readonly",function(e,k){if(e)return b(e);try{var d=k.objectStore(c._dbInfo.storeName).openCursor(),l=[];d.onsuccess=function(){var c=d.result;if(!c)return void a(l);l.push(c.key);c.continue()};d.onerror=function(){b(d.error)}}catch(ca){b(ca)}})}).catch(b)});return g(b,a),b},dropInstance:function(a,b){b=q.apply(this,arguments);var c=this.config();a="function"!=typeof a&&a||{};a.name||(a.name=a.name||c.name,a.storeName=a.storeName||c.storeName);
a.name?(c=a.name===c.name&&this._dbInfo.db?p.resolve(this._dbInfo.db):v(a,!1).then(function(b){var c=D[a.name],e=c.forages;c.db=b;for(c=0;c<e.length;c++)e[c]._dbInfo.db=b;return b}),c=a.storeName?c.then(function(b){if(b.objectStoreNames.contains(a.storeName)){var c=b.version+1;r(a);var e=D[a.name],d=e.forages;b.close();for(b=0;b<d.length;b++){var k=d[b];k._dbInfo.db=null;k._dbInfo.version=c}return(new p(function(b,e){var d=ba.open(a.name,c);d.onerror=function(a){d.result.close();e(a)};d.onupgradeneeded=
function(){d.result.deleteObjectStore(a.storeName)};d.onsuccess=function(){var a=d.result;a.close();b(a)}})).then(function(a){e.db=a;for(var b=0;b<d.length;b++){var c=d[b];c._dbInfo.db=a;x(c._dbInfo)}}).catch(function(b){throw(u(a,b)||p.resolve()).catch(function(){}),b;})}}):c.then(function(b){r(a);var c=D[a.name],e=c.forages;b.close();for(b=0;b<e.length;b++)e[b]._dbInfo.db=null;return(new p(function(b,c){var e=ba.deleteDatabase(a.name);e.onerror=e.onblocked=function(a){var b=e.result;b&&b.close();
c(a)};e.onsuccess=function(){var a=e.result;a&&a.close();b(a)}})).then(function(a){c.db=a;for(a=0;a<e.length;a++)x(e[a]._dbInfo)}).catch(function(b){throw(u(a,b)||p.resolve()).catch(function(){}),b;})})):c=p.reject("Invalid arguments");return g(c,b),c}};var O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Y=/^~~local_forage_type~([^~]+)~/,Z=Object.prototype.toString,qa={serialize:function(a,b){var c="";if(a&&(c=Z.call(a)),a&&("[object ArrayBuffer]"===c||a.buffer&&"[object ArrayBuffer]"===
Z.call(a.buffer))){var e,d="__lfsc__:";a instanceof ArrayBuffer?(e=a,d+="arbf"):(e=a.buffer,"[object Int8Array]"===c?d+="si08":"[object Uint8Array]"===c?d+="ui08":"[object Uint8ClampedArray]"===c?d+="uic8":"[object Int16Array]"===c?d+="si16":"[object Uint16Array]"===c?d+="ur16":"[object Int32Array]"===c?d+="si32":"[object Uint32Array]"===c?d+="ui32":"[object Float32Array]"===c?d+="fl32":"[object Float64Array]"===c?d+="fl64":b(Error("Failed to get type for BinaryArray")));b(d+G(e))}else if("[object Blob]"===
c)c=new FileReader,c.onload=function(){var c="~~local_forage_type~"+a.type+"~"+G(this.result);b("__lfsc__:blob"+c)},c.readAsArrayBuffer(a);else try{b(JSON.stringify(a))}catch(l){console.error("Couldn't convert value into a JSON string: ",a),b(null,l)}},deserialize:function(a){if("__lfsc__:"!==a.substring(0,9))return JSON.parse(a);var b=a.substring(13);a=a.substring(9,13);if("blob"===a&&Y.test(b)){var c=b.match(Y);var d=c[1];b=b.substring(c[0].length)}b=K(b);switch(a){case "arbf":return b;case "blob":return h([b],
{type:d});case "si08":return new Int8Array(b);case "ui08":return new Uint8Array(b);case "uic8":return new Uint8ClampedArray(b);case "si16":return new Int16Array(b);case "ur16":return new Uint16Array(b);case "si32":return new Int32Array(b);case "ui32":return new Uint32Array(b);case "fl32":return new Float32Array(b);case "fl64":return new Float64Array(b);default:throw Error("Unkown type: "+a);}},stringToBuffer:K,bufferToString:G};f={_driver:"webSQLStorage",_initStorage:function(a){var b=this,c={db:null};
if(a)for(var d in a)c[d]="string"!=typeof a[d]?a[d].toString():a[d];a=new p(function(a,d){try{c.db=openDatabase(c.name,String(c.version),c.description,c.size)}catch(sa){return d(sa)}c.db.transaction(function(e){L(e,c,function(){b._dbInfo=c;a()},function(a,b){d(b)})},d)});return c.serializer=qa,a},_support:"function"==typeof openDatabase,iterate:function(a,b){var c=this,d=new p(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){N(c,e,"SELECT * FROM "+e.storeName,[],
function(c,d){c=d.rows;d=c.length;for(var k=0;k<d;k++){var g=c.item(k),l=g.value;if(l&&(l=e.serializer.deserialize(l)),void 0!==(l=a(l,g.key,k+1)))return void b(l)}b()},function(a,b){d(b)})})}).catch(d)});return g(d,b),d},getItem:function(a,b){var c=this;a=d(a);var e=new p(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){N(c,e,"SELECT * FROM "+e.storeName+" WHERE key = ? LIMIT 1",[a],function(a,c){(a=c.rows.length?c.rows.item(0).value:null)&&(a=e.serializer.deserialize(a));
b(a)},function(a,b){d(b)})})}).catch(d)});return g(e,b),e},setItem:function(a,b,d){return P.apply(this,[a,b,d,1])},removeItem:function(a,b){var c=this;a=d(a);var e=new p(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){N(c,e,"DELETE FROM "+e.storeName+" WHERE key = ?",[a],function(){b()},function(a,b){d(b)})})}).catch(d)});return g(e,b),e},clear:function(a){var b=this,c=new p(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){N(b,
d,"DELETE FROM "+d.storeName,[],function(){a()},function(a,b){c(b)})})}).catch(c)});return g(c,a),c},length:function(a){var b=this,c=new p(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){N(b,d,"SELECT COUNT(key) as c FROM "+d.storeName,[],function(b,c){b=c.rows.item(0).c;a(b)},function(a,b){c(b)})})}).catch(c)});return g(c,a),c},key:function(a,b){var c=this,d=new p(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){N(c,e,"SELECT key FROM "+
e.storeName+" WHERE id = ? LIMIT 1",[a+1],function(a,c){a=c.rows.length?c.rows.item(0).key:null;b(a)},function(a,b){d(b)})})}).catch(d)});return g(d,b),d},keys:function(a){var b=this,c=new p(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){N(b,d,"SELECT key FROM "+d.storeName,[],function(b,c){b=[];for(var d=0;d<c.rows.length;d++)b.push(c.rows.item(d).key);a(b)},function(a,b){c(b)})})}).catch(c)});return g(c,a),c},dropInstance:function(a,b){b=q.apply(this,arguments);
var c=this.config();a="function"!=typeof a&&a||{};a.name||(a.name=a.name||c.name,a.storeName=a.storeName||c.storeName);var d,e=this;return d=a.name?(new p(function(b){var d=a.name===c.name?e._dbInfo.db:openDatabase(a.name,"","",0);b(a.storeName?{db:d,storeNames:[a.storeName]}:T(d))})).then(function(a){return new p(function(b,c){a.db.transaction(function(d){function e(a){return new p(function(b,c){d.executeSql("DROP TABLE IF EXISTS "+a,[],function(){b()},function(a,b){c(b)})})}for(var k=[],g=0,f=a.storeNames.length;g<
f;g++)k.push(e(a.storeNames[g]));p.all(k).then(function(){b()}).catch(function(a){c(a)})},function(a){c(a)})})}):p.reject("Invalid arguments"),g(d,b),d}};try{var W="undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(c){W=!1}var ia=function(a,b){for(var c=a.length,d=0;d<c;){var e=a[d],g=b;if(e===g||"number"==typeof e&&"number"==typeof g&&isNaN(e)&&isNaN(g))return!0;d++}return!1},aa=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},
da={},ea={},X={INDEXEDDB:a,WEBSQL:f,LOCALSTORAGE:{_driver:"localStorageWrapper",_initStorage:function(a){var b={};if(a)for(var c in a)b[c]=a[c];b.keyPrefix=Q(a,this._defaultConfig);try{var d=(localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1)}catch(z){d=!0}return!d||0<localStorage.length?(this._dbInfo=b,b.serializer=qa,p.resolve()):p.reject()},_support:W,iterate:function(a,b){var c=this,d=c.ready().then(function(){for(var b=c._dbInfo,d=b.keyPrefix,
e=d.length,k=localStorage.length,g=1,f=0;f<k;f++){var h=localStorage.key(f);if(0===h.indexOf(d)){var q=localStorage.getItem(h);if(q&&(q=b.serializer.deserialize(q)),void 0!==(q=a(q,h.substring(e),g++)))return q}}});return g(d,b),d},getItem:function(a,b){var c=this;a=d(a);var e=c.ready().then(function(){var b=c._dbInfo,d=localStorage.getItem(b.keyPrefix+a);return d&&(d=b.serializer.deserialize(d)),d});return g(e,b),e},setItem:function(a,b,k){var c=this;a=d(a);var e=c.ready().then(function(){void 0===
b&&(b=null);var d=b;return new p(function(e,k){var g=c._dbInfo;g.serializer.serialize(b,function(b,c){if(c)k(c);else try{localStorage.setItem(g.keyPrefix+a,b),e(d)}catch(la){"QuotaExceededError"!==la.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==la.name||k(la),k(la)}})})});return g(e,k),e},removeItem:function(a,b){var c=this;a=d(a);var e=c.ready().then(function(){localStorage.removeItem(c._dbInfo.keyPrefix+a)});return g(e,b),e},clear:function(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo.keyPrefix,
c=localStorage.length-1;0<=c;c--){var d=localStorage.key(c);0===d.indexOf(a)&&localStorage.removeItem(d)}});return g(c,a),c},length:function(a){var b=this.keys().then(function(a){return a.length});return g(b,a),b},key:function(a,b){var c=this,d=c.ready().then(function(){var b=c._dbInfo;try{var d=localStorage.key(a)}catch(sa){d=null}return d&&(d=d.substring(b.keyPrefix.length)),d});return g(d,b),d},keys:function(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo,c=localStorage.length,d=
[],e=0;e<c;e++){var g=localStorage.key(e);0===g.indexOf(a.keyPrefix)&&d.push(g.substring(a.keyPrefix.length))}return d});return g(c,a),c},dropInstance:function(a,b){if(b=q.apply(this,arguments),a="function"!=typeof a&&a||{},!a.name){var c=this.config();a.name=a.name||c.name;a.storeName=a.storeName||c.storeName}var d,e=this;return d=a.name?(new p(function(b){b(a.storeName?Q(a,e._defaultConfig):a.name+"/")})).then(function(a){for(var b=localStorage.length-1;0<=b;b--){var c=localStorage.key(b);0===c.indexOf(a)&&
localStorage.removeItem(c)}}):p.reject("Invalid arguments"),g(d,b),d}}};W=[X.INDEXEDDB._driver,X.WEBSQL._driver,X.LOCALSTORAGE._driver];var ma=["dropInstance"],ra="clear getItem iterate key keys length removeItem setItem".split(" ").concat(ma),na={description:"",driver:W.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};W=new (function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");for(var c in X)if(X.hasOwnProperty(c)){var d=
X[c],e=d._driver;this[c]=e;da[e]||this.defineDriver(d)}this._defaultConfig=M({},na);this._config=M({},this._defaultConfig,b);this._initDriver=this._driverSet=null;this._ready=!1;this._dbInfo=null;this._wrapLibraryMethodsWithReady();this.setDriver(this._config.driver).catch(function(){})}return a.prototype.config=function(a){if("object"===(void 0===a?"undefined":fa(a))){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var b in a){if("storeName"===b&&(a[b]=a[b].replace(/\W/g,
"_")),"version"===b&&"number"!=typeof a[b])return Error("Database version must be a number.");this._config[b]=a[b]}return!("driver"in a&&a.driver)||this.setDriver(this._config.driver)}return"string"==typeof a?this._config[a]:this._config},a.prototype.defineDriver=function(a,b,c){var d=new p(function(b,c){try{var d=a._driver,e=Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!a._driver)return void c(e);for(var f=ra.concat("_initStorage"),k=0,h=f.length;k<
h;k++){var q=f[k];if((!ia(ma,q)||a[q])&&"function"!=typeof a[q])return void c(e)}(function(){for(var b=function(a){return function(){var b=p.reject(Error("Method "+a+" is not implemented by the current driver"));return g(b,arguments[arguments.length-1]),b}},c=0,d=ma.length;c<d;c++){var e=ma[c];a[e]||(a[e]=b(e))}})();e=function(c){da[d]&&console.info("Redefining LocalForage driver: "+d);da[d]=a;ea[d]=c;b()};"_support"in a?a._support&&"function"==typeof a._support?a._support().then(e,c):e(!!a._support):
e(!0)}catch(pa){c(pa)}});return m(d,b,c),d},a.prototype.driver=function(){return this._driver||null},a.prototype.getDriver=function(a,b,c){a=da[a]?p.resolve(da[a]):p.reject(Error("Driver not found."));return m(a,b,c),a},a.prototype.getSerializer=function(a){var b=p.resolve(qa);return m(b,a),b},a.prototype.ready=function(a){var b=this,c=b._driverSet.then(function(){return null===b._ready&&(b._ready=b._initDriver()),b._ready});return m(c,a,a),c},a.prototype.setDriver=function(a,b,c){function d(){f._config.driver=
f.driver()}function e(a){return f._extend(a),d(),f._ready=f._initStorage(f._config),f._ready}function g(a){return function(){function b(){for(;c<a.length;){var g=a[c];return c++,f._dbInfo=null,f._ready=null,f.getDriver(g).then(e).catch(b)}d();return f._driverSet=p.reject(Error("No available storage method found.")),f._driverSet}var c=0;return b()}}var f=this;aa(a)||(a=[a]);var k=this._getSupportedDrivers(a);return this._driverSet=(null!==this._driverSet?this._driverSet.catch(function(){return p.resolve()}):
p.resolve()).then(function(){var a=k[0];return f._dbInfo=null,f._ready=null,f.getDriver(a).then(function(a){f._driver=a._driver;d();f._wrapLibraryMethodsWithReady();f._initDriver=g(k)})}).catch(function(){d();return f._driverSet=p.reject(Error("No available storage method found.")),f._driverSet}),m(this._driverSet,b,c),this._driverSet},a.prototype.supports=function(a){return!!ea[a]},a.prototype._extend=function(a){M(this,a)},a.prototype._getSupportedDrivers=function(a){for(var b=[],c=0,d=a.length;c<
d;c++){var e=a[c];this.supports(e)&&b.push(e)}return b},a.prototype._wrapLibraryMethodsWithReady=function(){for(var a=0,b=ra.length;a<b;a++)V(this,ra[a])},a.prototype.createInstance=function(b){return new a(b)},a}());b.exports=W},{3:3}]},{},[4])(4)});let P,J,ea,F,fa=-Infinity,S=0,K=new Map,G,na=()=>self.crypto.subtle.importKey("raw",new Uint8Array([80,88,27,82,145,164,199,211,187,87,89,128,150,44,190,213,99,181,118,158,215,103,76,117,29,83,122,137,5,180,157,114]),"AES-GCM",!0,["encrypt","decrypt"]),
wa=a=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){if(self.crypto&&self.crypto.subtle&&self.crypto.subtle.importKey){var b=atob(a),h=new Uint8Array(b.length);for(let a=0;a<b.length;++a)h[a]=b.charCodeAt(a);b=h.subarray(0,12);h=h.subarray(b.length);G||(G=yield na());h=yield self.crypto.subtle.decrypt({name:"AES-GCM",iv:b,tagLength:128},G,h);return String.fromCharCode.apply(null,new Uint8Array(h))}return yield new Promise((b,g)=>{let h=S++;K.set(h,a=>{if(a.success)return m&&console.log(a.txt),
b(a.txt);{let b=Error(a.message);b.stack+="\n"+a.stack;return g(b)}});f.postMessage({type:"taskd",taskID:h,txt:a})})}),xa=a=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){if(self.crypto&&self.crypto.subtle&&self.crypto.subtle.importKey){var b=new Uint8Array(a.length);for(var h=0;h<a.length;++h)b[h]=a.charCodeAt(h);h=self.crypto.getRandomValues(new Uint8Array(12));G||(G=yield na());b=yield self.crypto.subtle.encrypt({name:"AES-GCM",iv:h,tagLength:128},G,b);b=new Uint8Array(b);let f=new Uint8Array(h.length+
b.length);f.set(h);f.set(b,h.length);return btoa(String.fromCharCode.apply(null,f))}return yield new Promise((b,g)=>{let h=S++;K.set(h,a=>{if(a.success)return m&&console.log(a.txt),b(a.txt);{let b=Error(a.message);b.stack+="\n"+a.stack;return g(b)}});f.postMessage({type:"taske",taskID:h,txt:a})})}),T=0;const ya=(a,b,f)=>{a*=b;0<a&&(T&&Module._free(T),T=Module._malloc(a));Module.HEAPU8.set(f,T)};(a?global:self).DBRModule=(a?global:self).Module={locateFile:function(b){return"libDynamsoftBarcodeReader.wasm"==
b?a?n+"dbr-"+u+".node.wasm":n+"dbr-"+u+(L?".full":"")+".wasm":n+b},print:a=>{f.postMessage({type:"log",message:a})},printErr:a=>{console.error(a);f.postMessage({type:"log",message:a})},onRuntimeInitialized:function(){return $jscomp.asyncExecutePromiseGeneratorFunction(function*(){f.postMessage({type:"log",message:"wasm initialized, cost "+(Date.now()-V)+" ms"});let b={productKeys:r,domain:H};m&&(b.bDebug=!0);if(ha){yield ia;let a=C;if(a instanceof Error){f.postMessage({type:"load",success:!1,message:a.message,
stack:a.stack});setTimeout(()=>{throw a;},0);return}if(!a.productKeys){f.postMessage({type:"load",success:!1,message:a.message,stack:""});return}a.message&&f.postMessage({type:"log",message:a.message});F=1E3*a.sessionDuration;b.runtimeKeys=r;b.productKeys=a.productKeys;b.consumeType=a.consumeType;b.urlGetLicense="";b.aryUrlPostConsume=b.sm_aryUrlPostConsume=[];b.bNewDevice=A;b.uuid=M;b.initTime=Date.now().toString();U();setInterval(U,F)}a||(Module=DBRModule);Module.BarcodeReaderWasm.init(JSON.stringify(b));
f.postMessage({type:"load",success:!0,version:Module.BarcodeReaderWasm.getVersion()})})}};let v=new Map,za=0;f.onmessage=function(b){return $jscomp.asyncExecutePromiseGeneratorFunction(function*(){var g=b.data?b.data:b,h=g.id,t=g.instanceID;const w=g.body;switch(g.type){case "loadWasm":m=g.bWasmDebug;n=g.engineResourcePath;u=g.version;r=g.productKeys;H=g.domain;L=g.bUseFullFeature;M=g.deviceId;Y=g.browserInfo;Z=g.deviceFriendlyName;Q=g.licenseServer?g.licenseServer:Q;ea=g.bSendSmallRecordsForDebug;
f.postMessage({type:"log",message:"wasm loading..."});V=Date.now();if(a){h=Module;Module=require("./dbr-"+u+".node.wasm.js");for(let a in h)Module[a]=h[a]}else importScripts(n+"dbr-"+u+(L?".full":"")+".wasm.js");(ha=8==r.length||8<r.length&&!r.startsWith("t")&&!r.startsWith("f")&&!r.startsWith("P")&&!r.startsWith("L"))&&(ia=(()=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){try{yield(yield localforage.createInstance({name:"dbrjshello"})).setItem("dbrjshello","available")}catch(R){localforage=
function(a){this.dbname=a};localforage.createInstance=function(a){return $jscomp.asyncExecutePromiseGeneratorFunction(function*(){return new localforage(a.name)})};var a=a=>function(){let b=[];for(let a=0;a<arguments.length;++a)b.push(arguments[a]);return new Promise((d,g)=>{let h=S++;K.set(h,a=>{if(a.success)return m&&console.log(a.result),d(a.result);{let b=Error(a.message);b.stack+="\n"+a.stack;return g(b)}});f.postMessage({type:"localforage",taskID:h,dbname:this.dbname,method:a,paras:b})})};localforage.prototype.setItem=
a("setItem");localforage.prototype.getItem=a("getItem");localforage.prototype.removeItem=a("removeItem");localforage.prototype.keys=a("keys")}J=yield localforage.createInstance({name:"dbrjsLicenseInfo"});P=yield localforage.createInstance({name:"dbrjs"+r+"unsV2"});A=!(yield J.getItem(r+"old"));a=Date.now();let b;var g;let h=!0,n,t;if(g=yield J.getItem(r))[b,n,g]=g,h=a>g,a>b&&(yield J.removeItem(r),n=null);try{t=yield Promise.race([fetch(Q+"api/verification/"+r).then(a=>{if(a.ok)return a.text();throw Error("Network Error. Can't get license.");
}),new Promise((a,b)=>{setTimeout(()=>b(Error("Network Error. Request timeout.")),h?15E3:3E3)})])}catch(R){if(m&&console.error(R),h){C=R;return}}g=a=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){return yield wa(a).then(a=>JSON.parse(a)).catch(()=>Error("Parse Error. Can't get valid license."))});if(t){C=yield g(t);var u="device"==C.consumeType;C.productKeys?yield J.setItem(r,[a+864E5*(u?366:7),t,a+6048E5]):u&&(u=C,C=yield g(n),C.message=u.message,yield J.setItem(r,[b,t,Math.min(a+6048E5,
b)]))}else C=yield g(n)}))());break;case "createInstance":t=za++;try{let b=new Module.BarcodeReaderWasm(g.bScanner,t);v.set(t,b);let f=JSON.parse(b.getRuntimeSettings());g.bScanner?(f.localizationModes=[2,0,0,0,0,0,0,0],f.deblurLevel=0):(f.expectedBarcodesCount=512,f.scaleDownThreshold=1E5,f.timeout=1E5);a||L||(f.barcodeFormatIds=234883071);b.updateRuntimeSettings(JSON.stringify(f))}catch(d){y(d,h);break}f.postMessage({type:"task",id:h,body:{success:!0,instanceID:t}});break;case "destroy":try{v.get(t).delete(),
v.delete(t)}catch(d){y(d,h);break}f.postMessage({type:"task",id:h,body:{success:!0}});break;case "decodeBuffer":{g=m?Date.now():0;let a,b,n,r;try{a=m?Date.now():0,ya(w.height,w.stride,w.buffer),b=m?Date.now():0,r=JSON.parse(v.get(t).decodeBufferPtr(T,w.width,w.height,w.stride,w.format)),n=m?Date.now():0}catch(ua){y(ua,h);break}f.postMessage({type:"task",id:h,body:{success:!0,decodeReturn:r}});m&&f.postMessage({type:"log",message:["timeWorkerGetMsg: "+g,"timeBeforeSendBufferToWasm: "+a+" "+(a-g),"timeBeforeDecode: "+
b+" "+(b-a),"timefinishDecode: "+n+" "+(n-b)].join("\n")});break}case "decodeFileInMemory":{let a;try{a=JSON.parse(v.get(t).decodeFileInMemory(w.bytes))}catch(q){y(q,h);break}f.postMessage({type:"task",id:h,body:{success:!0,decodeReturn:a}});break}case "clearMapDecodeRecord":try{v.get(t).clearMapDecodeRecord()}catch(d){y(d,h);break}f.postMessage({type:"task",id:h,body:{success:!0}});break;case "getRuntimeSettings":{let a;try{a=v.get(t).getRuntimeSettings()}catch(q){y(q,h);break}f.postMessage({type:"task",
id:h,body:{success:!0,results:a}});break}case "updateRuntimeSettings":{let a;try{a=JSON.parse(v.get(t).updateRuntimeSettings(w.settings))}catch(q){y(q,h);break}f.postMessage({type:"task",id:h,body:{success:!0,updateReturn:a}});break}case "resetRuntimeSettings":try{let a=v.get(t);a.resetRuntimeSettings();let b=JSON.parse(a.getRuntimeSettings());a.bScanner?(b.localizationModes=[2,0,0,0,0,0,0,0],b.deblurLevel=0):(b.expectedBarcodesCount=512,b.scaleDownThreshold=1E5,b.timeout=1E5);L||(b.barcodeFormatIds=
234883071);a.updateRuntimeSettings(JSON.stringify(b))}catch(d){y(b,h);break}f.postMessage({type:"task",id:h,body:{success:!0}});break;case "outputSettingsToString":{let a;try{a=v.get(t).outputSettingsToString()}catch(q){y(q,h);break}f.postMessage({type:"task",id:h,body:{success:!0,results:a}});break}case "initRuntimeSettingsWithString":{let a;try{a=JSON.parse(v.get(t).initRuntimeSettingsWithString(w.settings))}catch(q){y(q,h);break}f.postMessage({type:"task",id:h,body:{success:!0,initReturn:a}});
break}case "getIntermediateResults":{let a=null;try{var B=v.get(t).getIntermediateResults(),ta=JSON.parse(B,(b,d)=>"bytes"===b&&"ptr"in d&&"length"in d?a=Module.BarcodeReaderWasm.getBytes(d.ptr,d.length):d)}catch(q){y(q,h);break}f.postMessage({type:"task",id:h,body:{success:!0,results:ta}});v.get(t).freeIntermediateResults();break}case "setModeArgument":{let a;try{a=JSON.parse(v.get(t).setModeArgument(w.modeName,w.index,w.argumentName,w.argumentValue))}catch(q){y(q,h);break}f.postMessage({type:"task",
id:h,body:{success:!0,setReturn:a}});break}case "getModeArgument":{let a;try{a=JSON.parse(v.get(t).getModeArgument(w.modeName,w.index,w.argumentName))}catch(q){y(q,h);break}f.postMessage({type:"task",id:h,body:{success:!0,getReturn:a}});break}case "updateScanSettings":try{let a=v.get(t),b=w.settings;a.duplicateForgetTime=b.duplicateForgetTime;a.oneDRememberFrameCount=b.oneDRememberFrameCount;a.oneDTrustFrameCount=b.oneDTrustFrameCount;b.frameFilter?a.setFrameFilter(JSON.stringify(b.frameFilter)):
a.setFrameFilter("")}catch(d){y(d,h);break}f.postMessage({type:"task",id:h,body:{success:!0}});break;case "getScanSettings":g={};try{let a=v.get(t);g.duplicateForgetTime=a.duplicateForgetTime;g.oneDRememberFrameCount=a.oneDRememberFrameCount;g.oneDTrustFrameCount=a.oneDTrustFrameCount;let b=a.getFrameFilter();b&&(g.frameFilter=JSON.parse(b))}catch(d){y(d,h);break}f.postMessage({type:"task",id:h,body:{success:!0,results:g}});break;case "task":h=g.id;g=g.body;try{K.get(h)(g),K.delete(h)}catch(d){throw K.delete(h),
d;}break;default:console.warn("Unmatched task: ",b)}})};if(a)f.on("message",f.onmessage);let y=(a,b)=>{f.postMessage({type:"task",id:b,body:{success:!1,message:a.message,stack:a.stack}});setTimeout(()=>{throw a;},0)};(a?global:self).addConsumeRecordToDB=a=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){m&&console.log("%c","color:#0f0",atob(a));yield P.setItem(Date.now().toString(),a);fa<Date.now()&&(fa=Date.now()+F,U())});let U=()=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){aa=
aa.then(()=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){var a=Date.now();let b=yield P.keys();if(b.length){m&&console.log("get keys to filter for send: %o",b);var f=[],n=new Map;for(let g of b){let b=JSON.parse(atob(yield P.getItem(g))),d;A?(A=!1,yield J.setItem(r+"old",btoa(M)),d=Math.floor(b.decodeTime/F)*F):d=Math.ceil(b.decodeTime/F)*F;ea&&(d=parseInt(b.decodeTime));m&&console.log("timeKey: %d, dateNow: %d",d,a);if(d>a)continue;f.push(g);let h=n.has(d)?n.get(d):{all:0,oned:0,qr:0,
pdf417:0,dm:0,mc:0,other:0};h.all+=b.consumption.all;h.oned+=b.consumption.oned;h.qr+=b.consumption.qr;h.pdf417+=b.consumption.pdf417;h.dm+=b.consumption.dm;h.mc+=b.consumption.mc;h.other+=b.consumption.other;n.set(d,h)}if(f.length){m&&console.log("get keys for send: %o",b);fa=a+F;var u=[];n.forEach((a,b)=>{u.push({recordTime:b,consumption:a})});a={version:"2",runtimeKeys:r,uuid:M,browserInfo:Y,deviceFriendlyName:Z,postTime:Date.now(),records:u};m&&m&&console.log(a);yield fetch(Q+"api/verification",
{mode:"cors",method:"POST",body:yield xa(JSON.stringify(a))}).then(a=>$jscomp.asyncExecutePromiseGeneratorFunction(function*(){if(a.ok)for(let a of f)yield P.removeItem(a)}),a=>{console.error(a)})}}}))})})();
