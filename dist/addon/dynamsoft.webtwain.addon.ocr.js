/* 20200107
* Dynamsoft JavaScript Library
*
* Product: Dynamsoft Web Twain
* Web Site: http://www.dynamsoft.com
*
* Copyright 2020, Dynamsoft Corporation 
* Author: Dynamsoft R&D Department
*
* Version: 15.3
* 
* Module: addon/ocr
* final js: build\addon\dynamsoft.webtwain.addon.OCR.js
*/
Dynamsoft.OCRVerInName="10.0.0.0618";Dynamsoft.OCRLanguageData_eng="4113088";Dynamsoft.OCRLanguageData_ara="1432056";Dynamsoft.OCRLanguageData_chi_sim="2469156";Dynamsoft.OCRLanguageData_chi_tra="2366642";Dynamsoft.OCRLanguageData_hin="1122751";Dynamsoft.OCRLanguageData_urd="1398718";Dynamsoft.OCRLanguageData_spa="2294433";Dynamsoft.OCRLanguageData_fra="1130365";Dynamsoft.OCRLanguageData_msa="1747801";Dynamsoft.OCRLanguageData_ind="1122661";Dynamsoft.OCRLanguageData_rus="3861738";Dynamsoft.OCRLanguageData_ben="855841";Dynamsoft.OCRLanguageData_por="1982756";Dynamsoft.OCRLanguageData_pan="497721";Dynamsoft.OCRLanguageData_deu="1525436";Dynamsoft.OCRLanguageData_jpn="2471260";Dynamsoft.OCRLanguageData_fas="431500";Dynamsoft.OCRLanguageData_swa="2167651";Dynamsoft.OCRLanguageData_jav="2982741";Dynamsoft.OCRLanguageData_tel="2769654";Dynamsoft.OCRLanguageData_tur="4550554";Dynamsoft.OCRLanguageData_kor="1677415";Dynamsoft.OCRLanguageData_mar="2118233";Dynamsoft.OCRLanguageData_tam="3237963";Dynamsoft.OCRLanguageData_vie="531275";Dynamsoft.OCRLanguageData_ita="2701314";Dynamsoft.OCRLanguageData_tha="1072600";(function(a){function b(){var c=this;c._text="";c._fontName="";c._fontSize="";c._left=0;c._top=0;c._right=0;c._bottom=0}b.prototype.GetText=function(){var c=this;return c._text};b.prototype.GetFontName=function(){var c=this;return c._fontName};b.prototype.GetFontSize=function(){var c=this;return c._fontSize};b.prototype.GetWordRect=function(){var c=this;return c._left+","+c._top+","+c._right+","+c._bottom};a.NewWordBasicResult=function(){return new b()}})(Dynamsoft.Lib);(function(a){function b(){var c=this;c._count=0;c._left=0;c._top=0;c._right=0;c._bottom=0;c._wordlist=[]}b.prototype.GetWordCount=function(){var c=this;return c._count};b.prototype.GetLineRect=function(){var c=this;return c._left+","+c._top+","+c._right+","+c._bottom};b.prototype.GetWordContent=function(d){var f=this,c=f._wordlist.length;if(f._errorCode<0){return""}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetWordContent");return""}var e=Dynamsoft.Lib.NewWordBasicResult();e._text=f._wordlist[d].text;e._fontName=f._wordlist[d].fontname;e._fontSize=f._wordlist[d].fontsize;e._left=f._wordlist[d].rect[0];e._top=f._wordlist[d].rect[1];e._right=f._wordlist[d].rect[2];e._bottom=f._wordlist[d].rect[3];return e};a.NewLineBasicResult=function(){return new b()}})(Dynamsoft.Lib);(function(b){function a(){var c=this;c._count=0;c._linelist=[]}a.prototype.GetLineCount=function(){var c=this;return c._count};a.prototype.GetLineContent=function(e){var f=this,d=f._linelist.length;if(f._errorCode<0){return""}if(e==null||e>=d||e<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetLineContent");return""}var c=Dynamsoft.Lib.NewLineBasicResult();c._count=f._linelist[e].words.length;c._left=f._linelist[e].rect[0];c._top=f._linelist[e].rect[1];c._right=f._linelist[e].rect[2];c._bottom=f._linelist[e].rect[3];c._wordlist=f._linelist[e].words;return c};b.NewPageBasicResult=function(){return new a()}})(Dynamsoft.Lib);(function(b){function a(){var c=this;c._count=0;c._pagelist=[]}a.prototype.GetPageCount=function(){var c=this;return c._count};a.prototype.GetPageContent=function(d){var f=this,c=f._pagelist.length;if(f._errorCode<0){return""}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetPageContent");return""}var e=Dynamsoft.Lib.NewPageBasicResult();e._count=f._pagelist[d].lines.length;e._linelist=f._pagelist[d].lines;return e};b.NewPageSetBasicResult=function(){return new a()}})(Dynamsoft.Lib);(function(b){function a(d){var c=this;c._errorCode=0;c._errorString="";c._resultlist=[];c._stwain=d}a.prototype.GetErrorCode=function(){var c=this;return c._errorCode};a.prototype.GetErrorString=function(){var c=this;return c._errorString};a.prototype.GetFormat=function(){var c=this;return c._resultlist[0].format};a.prototype.GetInput=function(){var e=this,d=e._resultlist[0].input;if(d){var c=Number(d);if(!isNaN(c)){return e._stwain.objImageIndexManager.convertServerIdToClientIndex(c)}}return d};a.prototype.GetPageSetCount=function(){var c=this;return c._resultlist[0].pagesets.length};a.prototype.GetPageSetContent=function(e){var f=this,c=f._resultlist[0].pagesets.length;if(f._errorCode<0){return""}if(e==null||e>=c||e<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetPageSetContent");return""}var d=Dynamsoft.Lib.NewPageSetBasicResult();d._count=f._resultlist[0].pagesets[e].pages.length;d._pagelist=f._resultlist[0].pagesets[e].pages;return d};a.prototype.Get=function(){var c=this;return c._stwain._innerFun("GetOCRRestult")};a.prototype.Save=function(c){var e=this,d=b.html5.Funs.replaceLocalFilename(c);return e._stwain._innerFun("SaveOCRRestult",b.html5.Funs.makeParams(d))};b.NewOCRBasicResult=function(c){return new a(c)}})(Dynamsoft.Lib);var EnumDWT_OCRLanguage={OCRL_ENG:"eng",OCRL_ARA:"ara",OCRL_CHI_SIM:"chi_sim",OCRL_CHI_TRA:"chi_tra",OCRL_HIN:"hin",OCRL_URD:"urd",OCRL_SPA:"spa",OCRL_FRA:"fra",OCRL_MSA:"msa",OCRL_IND:"ind",OCRL_RUS:"rus",OCRL_BEN:"ben",OCRL_POR:"por",OCRL_PAN:"pan",OCRL_DEU:"deu",OCRL_JPN:"jpn",OCRL_FAS:"fas",OCRL_SWA:"swa",OCRL_JAV:"jav",OCRL_TEL:"tel",OCRL_TUR:"tur",OCRL_KOR:"kor",OCRL_MAR:"mar",OCRL_TAM:"tam",OCRL_VIE:"vie",OCRL_ITA:"ita",OCRL_THA:"tha"};var EnumDWT_OCRPageSetMode={OCRPSM_OSD_ONLY:0,PSM_AUTO_OSD:1,PSM_AUTO_ONLY:2,PSM_AUTO:3,PSM_SINGLE_COLUMN:4,PSM_SINGLE_BLOCK_VERT_TEXT:5,PSM_SINGLE_BLOCK:6,PSM_SINGLE_LINE:7,PSM_SINGLE_WORD:8,PSM_CIRCLE_WORD:9,PSM_SINGLE_CHAR:10};var EnumDWT_OCROutputFormat={OCROF_TEXT:0,OCROF_PDFPLAINTEXT:1,OCROF_PDFIMAGEOVERTEXT:2,OCROF_PDFPLAINTEXT_PDFX:3,OCROF_PDFIMAGEOVERTEXT_PDFX:4};(function(b){function a(){var c=this;c.UnicodeFontName="";c.UseDetectedFont=true;c.MinFontSizeforMoreAccurateResult=0;c.OCRLanguage=EnumDWT_OCRLanguage.OCRL_ENG;c.PageSetMode=EnumDWT_OCRPageSetMode.PSM_AUTO;c.OutputFormat=EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT}a.prototype.GetUnicodeFontName=function(){var c=this;return c.UnicodeFontName};a.prototype.SetUnicodeFontName=function(c){var d=this;d.UnicodeFontName=c;return true};a.prototype.GetUseDetectedFont=function(){var c=this;return c.UseDetectedFont};a.prototype.SetUseDetectedFont=function(c){var d=this;d.UseDetectedFont=c;return true};a.prototype.GetMinFontSizeforMoreAccurateResult=function(){var c=this;return c.MinFontSizeforMoreAccurateResult};a.prototype.SetMinFontSizeforMoreAccurateResult=function(c){var d=this;d.MinFontSizeforMoreAccurateResult=c;return true};a.prototype.GetOCRLanguage=function(){var c=this;return c.OCRLanguage};a.prototype.SetOCRLanguage=function(c){var d=this;d.OCRLanguage=c;return true};a.prototype.GetPageSetMode=function(){var c=this;return c.PageSetMode};a.prototype.SetPageSetMode=function(c){var d=this;d.PageSetMode=c;return true};a.prototype.GetOutputFormat=function(){var c=this;return c.OutputFormat};a.prototype.SetOutputFormat=function(c){var d=this;d.OutputFormat=c;return true};b.NewOptions=function(){return new a()}})(Dynamsoft.Lib);var EnumDWT_OCRDownloadType={OCRDT_Dll:0,OCRDT_LANGUAGE:1};(function(b){if(!b.product.bChromeEdition){return}var a;function d(f){var g=b.html5.Funs;if(b.env.bMac){a="DynamicOCR_"+Dynamsoft.OCRVerInName+".dylib"}else{if(b.env.bLinux){a="DynamicOCR_"+Dynamsoft.OCRVerInName+".so"}else{if(dynamsoft.dcp.b64bit){a="DynamicOCRx64_"+Dynamsoft.OCRVerInName+".dll"}else{a="DynamicOCR_"+Dynamsoft.OCRVerInName+".dll"}}}f._innerSend("GetAddOnVersion",g.makeParams("ocr",a),true,false,false);f.__innerOCRBasicReadFunction=function(l,r,n,s,k,t,u,h,i,q,j){var o=this;if(!b.isFunction(q)){return o.__innerOCRSyncReadFunction(l,i)}else{return o.__innerOCRBasicAsyncReadFunction(l,r,n,s,k,t,u,h,i,q,j)}};f.__innerGetOCRBasicResultAsyncFunction=function(i){var h=Dynamsoft.Lib.NewOCRBasicResult(this);if(i){h._errorCode=i.exception;h._errorString=i.description;h._resultlist=i.result}return h};f.__innerOCRBasicAsyncReadFunction=function(l,s,n,t,k,u,w,h,i,r,j){var q=this;var o=function(m){if(m.exception==0){if(b.isFunction(r)){if(s!=-1){if(t==1){r(s,k,u,w,h,q.__innerGetOCRBasicResultAsyncFunction(m))}else{r(s,q.__innerGetOCRBasicResultAsyncFunction(m))}}else{if(n!=""){r(n,q.__innerGetOCRBasicResultAsyncFunction(m))}else{r(q.__innerGetOCRBasicResultAsyncFunction(m))}}}}else{if(b.isFunction(j)){j(m.exception,m.description)}}g.hideMask(l)},v=function(m){g.hideMask(l)};g.showMask(l);q._innerSend(l,i,true,o,v);return true};f.__innerOCRSyncReadFunction=function(i,k){var l=this,j,h;j=l._innerFunRaw(i,k,false,false);h=b.NewOCRBasicResult();h._errorCode=l._errorCode;h._errorString=l._errorString;if(j&&b.isArray(j)){h._resultlist=j;h._Count=j.length}return h};f.__IsOCRBasicModuleInstalled=function(){var j=f;var h=j._innerFun("GetAddOnVersion",g.makeParams("ocr",a));var i=h.split("|");if(i[0]!=""){return true}else{return false}};f.__innerBasicDownload=function(o,r,j,t,k){var n=f,q;b.cancelFrome=2;o=o.toString();var m=function(){if(b.isFunction(t)){t()}return true},u=function(){if(b.isFunction(k)){k(n.ErrorCode,n.ErrorString)}return false};if(!b.License.checkProductKey(n,{Core:true})){return u()}if(!b.License.checkProductKey(n,{OCR:true},true)){return u()}if(r!=EnumDWT_OCRDownloadType.OCRDT_Dll){n._innerFun("SetOCRLanguage",g.makeParams(j))}var h=n._innerFun("GetAddOnVersion",g.makeParams("ocr",a));var i=h.split("|");if(r==EnumDWT_OCRDownloadType.OCRDT_Dll){if(i[0]!=""){m();return true}}else{if((j==EnumDWT_OCRLanguage.OCRL_ENG&&i[1]==Dynamsoft.OCRLanguageData_eng)||(j==EnumDWT_OCRLanguage.OCRL_ARA&&i[1]==Dynamsoft.OCRLanguageData_ara)||(j==EnumDWT_OCRLanguage.OCRL_CHI_TRA&&i[1]==Dynamsoft.OCRLanguageData_chi_tra)||(j==EnumDWT_OCRLanguage.OCRL_CHI_SIM&&i[1]==Dynamsoft.OCRLanguageData_chi_sim)||(j==EnumDWT_OCRLanguage.OCRL_HIN&&i[1]==Dynamsoft.OCRLanguageData_hin)||(j==EnumDWT_OCRLanguage.OCRL_URD&&i[1]==Dynamsoft.OCRLanguageData_urd)||(j==EnumDWT_OCRLanguage.OCRL_SPA&&i[1]==Dynamsoft.OCRLanguageData_spa)||(j==EnumDWT_OCRLanguage.OCRL_FRA&&i[1]==Dynamsoft.OCRLanguageData_fra)||(j==EnumDWT_OCRLanguage.OCRL_MSA&&i[1]==Dynamsoft.OCRLanguageData_msa)||(j==EnumDWT_OCRLanguage.OCRL_IND&&i[1]==Dynamsoft.OCRLanguageData_ind)||(j==EnumDWT_OCRLanguage.OCRL_RUS&&i[1]==Dynamsoft.OCRLanguageData_rus)||(j==EnumDWT_OCRLanguage.OCRL_BEN&&i[1]==Dynamsoft.OCRLanguageData_ben)||(j==EnumDWT_OCRLanguage.OCRL_POR&&i[1]==Dynamsoft.OCRLanguageData_por)||(j==EnumDWT_OCRLanguage.OCRL_PAN&&i[1]==Dynamsoft.OCRLanguageData_pan)||(j==EnumDWT_OCRLanguage.OCRL_DEU&&i[1]==Dynamsoft.OCRLanguageData_deu)||(j==EnumDWT_OCRLanguage.OCRL_JPN&&i[1]==Dynamsoft.OCRLanguageData_jpn)||(j==EnumDWT_OCRLanguage.OCRL_FAS&&i[1]==Dynamsoft.OCRLanguageData_fas)||(j==EnumDWT_OCRLanguage.OCRL_SWA&&i[1]==Dynamsoft.OCRLanguageData_swa)||(j==EnumDWT_OCRLanguage.OCRL_JAV&&i[1]==Dynamsoft.OCRLanguageData_jav)||(j==EnumDWT_OCRLanguage.OCRL_TEL&&i[1]==Dynamsoft.OCRLanguageData_tel)||(j==EnumDWT_OCRLanguage.OCRL_TUR&&i[1]==Dynamsoft.OCRLanguageData_tur)||(j==EnumDWT_OCRLanguage.OCRL_KOR&&i[1]==Dynamsoft.OCRLanguageData_kor)||(j==EnumDWT_OCRLanguage.OCRL_MAR&&i[1]==Dynamsoft.OCRLanguageData_mar)||(j==EnumDWT_OCRLanguage.OCRL_TAM&&i[1]==Dynamsoft.OCRLanguageData_tam)||(j==EnumDWT_OCRLanguage.OCRL_VIE&&i[1]==Dynamsoft.OCRLanguageData_vie)||(j==EnumDWT_OCRLanguage.OCRL_ITA&&i[1]==Dynamsoft.OCRLanguageData_ita)||(j==EnumDWT_OCRLanguage.OCRL_THA&&i[1]==Dynamsoft.OCRLanguageData_tha)){m();return true}}if(!o||o==""){b.Errors.OCR_InvalidRemoteFilename(n);u();return false}if(g.isServerInvalid(n)){u();return false}q="get";b.showProgress(n,"Download",true);var s=function(v){var w=(v.total===0)?100:Math.round(v.loaded*100/v.total),x=[v.loaded," / ",v.total].join("");n._OnPercentDone([0,w,"","http"])},l=true;if(r==EnumDWT_OCRDownloadType.OCRDT_Dll){n._OnPercentDone([0,-1,"Downloading OCR Module...","http"])}else{n._OnPercentDone([0,-1,"Downloading OCR Language Data...","http"])}if(!b.isFunction(t)){l=false}g.loadHttpBlob(n,q,o,l,function(p){n._OnPercentDone([0,-1,"Loading..."]);var v=100;if(r==EnumDWT_OCRDownloadType.OCRDT_LANGUAGE){v=101}n.__LoadImageFromBytes(p,v,"",l,m,u)},function(){b.closeProgress("Download");u()},s)}}var e=function(i){var j=[],g,f,h;if(i.objImageIndexManager.count()<=0){return j}f=i.objImageIndexManager.getCurrentImageIndex();g=i.objImageIndexManager.convertClientIndexToServerId(f);h=i.objImageIndexManager.getSelectedClientIndexArray();if(b.isArray(h)){b.each(h,function(k){var l=i.objImageIndexManager.convertClientIndexToServerId(k);j.push(l)})}return j},c=function(h){var i=b.html5.Funs,f;var g=b.NewOptions();d(h);f={OCR:{SetUnicodeFontName:function(j){return g.SetUnicodeFontName(j)},GetUnicodeFontName:function(){return g.GetUnicodeFontName()},SetIfUseDetectedFont:function(j){return g.SetUseDetectedFont(j)},GetIfUseDetectedFont:function(){return g.GetUseDetectedFont()},SetMinFontSizeforMoreAccurateResult:function(j){return g.SetMinFontSizeforMoreAccurateResult(j)},GetMinFontSizeforMoreAccurateResult:function(){return g.GetMinFontSizeforMoreAccurateResult()},SetLanguage:function(j){return g.SetOCRLanguage(j)},IsModuleInstalled:function(){return h.__IsOCRBasicModuleInstalled()},SetPageSetMode:function(k){var j=k*1;if(j==EnumDWT_OCRPageSetMode.OCRPSM_OSD_ONLY||j==EnumDWT_OCRPageSetMode.PSM_AUTO_OSD||j==EnumDWT_OCRPageSetMode.PSM_AUTO_ONLY||j==EnumDWT_OCRPageSetMode.PSM_AUTO||j==EnumDWT_OCRPageSetMode.PSM_SINGLE_COLUMN||j==EnumDWT_OCRPageSetMode.PSM_SINGLE_BLOCK_VERT_TEXT||j==EnumDWT_OCRPageSetMode.PSM_SINGLE_BLOCK||j==EnumDWT_OCRPageSetMode.PSM_SINGLE_LINE||j==EnumDWT_OCRPageSetMode.PSM_SINGLE_WORD||j==EnumDWT_OCRPageSetMode.PSM_CIRCLE_WORD||j==EnumDWT_OCRPageSetMode.PSM_SINGLE_CHAR){return g.SetPageSetMode(j)}Dynamsoft.Lib.Errors.OCR_InvalidPageSetMode(h);return false},SetOutputFormat:function(k){var j=k*1;if(j==EnumDWT_OCROutputFormat.OCROF_TEXT||j==EnumDWT_OCROutputFormat.OCROF_PDFPLAINTEXT||j==EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT||j==EnumDWT_OCROutputFormat.OCROF_PDFPLAINTEXT_PDFX||j==EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT_PDFX){return g.SetOutputFormat(j)}Dynamsoft.Lib.Errors.OCR_InvalidOutputFormat(h);return false},Recognize:function(m,j,l){if(!b.License.checkProductKey(h,{OCR:true},true)){if(b.isFunction(l)){l(h._errorCode,h._errorString)}return false}var k=h.objImageIndexManager.convertClientIndexToServerId(m);return h.__innerOCRBasicReadFunction("OCRRecognize",k,"",0,0,0,0,0,i.makeParams(0,k,"",0,0,0,0,g.GetUnicodeFontName(),g.GetUseDetectedFont(),g.GetMinFontSizeforMoreAccurateResult(),g.GetOCRLanguage(),g.GetPageSetMode(),g.GetOutputFormat(),""),j,l)},RecognizeRect:function(r,k,o,q,j,p,l){if((!k&&k!=0)||(!o&&o!=0)||(!q&&q!=0)||(!j&&j!=0)){var n=this;var s=Dynamsoft.Lib.NewOCRBasicResult(h);Dynamsoft.Lib.Errors.OCR_InvalidLeftOrTopOrRightOrBottom(s,"RecognizeRect");l(s.GetErrorCode(),s.GetErrorString());return}if(!b.License.checkProductKey(h,{OCR:true},true)){if(b.isFunction(l)){l(h._errorCode,h._errorString)}return false}var m=h.objImageIndexManager.convertClientIndexToServerId(r);return h.__innerOCRBasicReadFunction("OCRRecognize",m,"",1,k,o,q,j,i.makeParams(0,m,"",k,o,q,j,g.GetUnicodeFontName(),g.GetUseDetectedFont(),g.GetMinFontSizeforMoreAccurateResult(),g.GetOCRLanguage(),g.GetPageSetMode(),g.GetOutputFormat(),""),p,l)},RecognizeFile:function(k,j,l){var m=i.replaceLocalFilename(k);if(!b.License.checkProductKey(h,{OCR:true},true)){if(b.isFunction(l)){l(h._errorCode,h._errorString)}return false}return h.__innerOCRBasicReadFunction("OCRRecognize",-1,m,0,0,0,0,0,i.makeParams(1,-1,m,0,0,0,0,g.GetUnicodeFontName(),g.GetUseDetectedFont(),g.GetMinFontSizeforMoreAccurateResult(),g.GetOCRLanguage(),g.GetPageSetMode(),g.GetOutputFormat(),""),j,l)},RecognizeSelectedImages:function(j,m){var k;if(!b.License.checkProductKey(h,{OCR:true},true)){if(b.isFunction(m)){m(h._errorCode,h._errorString)}return false}var l=e(h);k=h.__innerOCRBasicReadFunction("OCRRecognize",-1,"",0,0,0,0,0,i.makeParams(2,-1,"",0,0,0,0,g.GetUnicodeFontName(),g.GetUseDetectedFont(),g.GetMinFontSizeforMoreAccurateResult(),g.GetOCRLanguage(),g.GetPageSetMode(),g.GetOutputFormat(),l.join(",")),j,m);return k},Download:function(l,j,k){return h.__innerBasicDownload(l,EnumDWT_OCRDownloadType.OCRDT_Dll,g.GetOCRLanguage(),j,k)},DownloadLangData:function(l,j,k){return h.__innerBasicDownload(l,EnumDWT_OCRDownloadType.OCRDT_LANGUAGE,g.GetOCRLanguage(),j,k)}}};h.__addon=h.__addon||{};b.mix(h.__addon,f)};if(b.DynamicLoadAddonFuns){b.DynamicLoadAddonFuns.push(c)}})(Dynamsoft.Lib);
