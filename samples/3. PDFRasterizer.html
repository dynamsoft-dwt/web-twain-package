<!DOCTYPE html>
<html>

<head>
    <title>Use Auto Feeder to scan</title>
    <script type="text/javascript" src="../dist/dynamsoft.webtwain.min.js"></script>
</head>

<body>
    <input type="button" value="Scan" onclick="AcquireImage();" />
    <input type="button" value="Load Images or PDFs" onclick="LoadImages();" />
    <br />
    <br />
    <div id="dwtcontrolContainer"></div>
    <script type="text/javascript">
        //Dynamsoft.WebTwainEnv.Containers = [{ ContainerId: 'dwtcontrolContainer',  Width:'583px', Height:'513px'}];
        //Dynamsoft.WebTwainEnv.ProductKey = 'Your-Product-Key-Goes-Here';
        //Dynamsoft.WebTwainEnv.Trial = true;
        //Dynamsoft.WebTwainEnv.ResourcesPath = 'https://tst.dynamsoft.com/libs/dwt/15.1';

        window.onload = function () {
            Dynamsoft.WebTwainEnv.Load();
        };

        var DWObject;

        Dynamsoft.WebTwainEnv.RegisterEvent('OnWebTwainReady', function () {
            DWObject = Dynamsoft.WebTwainEnv.GetWebTwain('dwtcontrolContainer');
        });

        function AcquireImage() {
            if (DWObject) {
                DWObject.SelectSource(function () {
                    var OnAcquireImageSuccess, OnAcquireImageFailure;
                    OnAcquireImageSuccess = OnAcquireImageFailure = function () {
                        DWObject.CloseSource();
                    };
                    DWObject.OpenSource();
                    DWObject.IfDisableSourceAfterAcquire = true;
                    DWObject.AcquireImage(OnAcquireImageSuccess, OnAcquireImageFailure);
                }, function () {
                    console.log('SelectSource failed!');
                });
            }
        }

        function LoadImages() {
            if (DWObject) {
                if (DWObject.Addon && DWObject.Addon.PDF) {
                    DWObject.Addon.PDF.SetResolution(300);
                    DWObject.Addon.PDF.SetConvertMode(EnumDWT_ConvertMode.CM_RENDERALL);
                }
                DWObject.LoadImageEx('', 5,
                    function () {},
                    function (errorCode, errorString) {
                        alert('Load Image:' + errorString);
                    }
                );
            }
        }
    </script>
</body>

</html>